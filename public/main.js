class q8{r;c;el;mine=!1;revealed=!1;flagged=!1;constructor(h,Z,H){this.r=h,this.c=Z,this.el=H}}var E4={easy:{r:9,c:9,m:10},medium:{r:16,c:16,m:40},hard:{r:16,c:30,m:99}},y8=3;var q4=()=>{return};var F4=function(h){let Z=[],H=0;for(let Q=0;Q<h.length;Q++){let G=h.charCodeAt(Q);if(G<128)Z[H++]=G;else if(G<2048)Z[H++]=G>>6|192,Z[H++]=G&63|128;else if((G&64512)===55296&&Q+1<h.length&&(h.charCodeAt(Q+1)&64512)===56320)G=65536+((G&1023)<<10)+(h.charCodeAt(++Q)&1023),Z[H++]=G>>18|240,Z[H++]=G>>12&63|128,Z[H++]=G>>6&63|128,Z[H++]=G&63|128;else Z[H++]=G>>12|224,Z[H++]=G>>6&63|128,Z[H++]=G&63|128}return Z},wK=function(h){let Z=[],H=0,Q=0;while(H<h.length){let G=h[H++];if(G<128)Z[Q++]=String.fromCharCode(G);else if(G>191&&G<224){let $=h[H++];Z[Q++]=String.fromCharCode((G&31)<<6|$&63)}else if(G>239&&G<365){let $=h[H++],M=h[H++],X=h[H++],B=((G&7)<<18|($&63)<<12|(M&63)<<6|X&63)-65536;Z[Q++]=String.fromCharCode(55296+(B>>10)),Z[Q++]=String.fromCharCode(56320+(B&1023))}else{let $=h[H++],M=h[H++];Z[Q++]=String.fromCharCode((G&15)<<12|($&63)<<6|M&63)}}return Z.join("")},R4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob==="function",encodeByteArray(h,Z){if(!Array.isArray(h))throw Error("encodeByteArray takes an array as a parameter");this.init_();let H=Z?this.byteToCharMapWebSafe_:this.byteToCharMap_,Q=[];for(let G=0;G<h.length;G+=3){let $=h[G],M=G+1<h.length,X=M?h[G+1]:0,B=G+2<h.length,V=B?h[G+2]:0,D=$>>2,F=($&3)<<4|X>>4,y=(X&15)<<2|V>>6,S=V&63;if(!B){if(S=64,!M)y=64}Q.push(H[D],H[F],H[y],H[S])}return Q.join("")},encodeString(h,Z){if(this.HAS_NATIVE_SUPPORT&&!Z)return btoa(h);return this.encodeByteArray(F4(h),Z)},decodeString(h,Z){if(this.HAS_NATIVE_SUPPORT&&!Z)return atob(h);return wK(this.decodeStringToByteArray(h,Z))},decodeStringToByteArray(h,Z){this.init_();let H=Z?this.charToByteMapWebSafe_:this.charToByteMap_,Q=[];for(let G=0;G<h.length;){let $=H[h.charAt(G++)],X=G<h.length?H[h.charAt(G)]:0;++G;let V=G<h.length?H[h.charAt(G)]:64;++G;let F=G<h.length?H[h.charAt(G)]:64;if(++G,$==null||X==null||V==null||F==null)throw new L4;let y=$<<2|X>>4;if(Q.push(y),V!==64){let S=X<<4&240|V>>2;if(Q.push(S),F!==64){let j=V<<6&192|F;Q.push(j)}}}return Q},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let h=0;h<this.ENCODED_VALS.length;h++)if(this.byteToCharMap_[h]=this.ENCODED_VALS.charAt(h),this.charToByteMap_[this.byteToCharMap_[h]]=h,this.byteToCharMapWebSafe_[h]=this.ENCODED_VALS_WEBSAFE.charAt(h),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[h]]=h,h>=this.ENCODED_VALS_BASE.length)this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(h)]=h,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(h)]=h}}};class L4 extends Error{constructor(){super(...arguments);this.name="DecodeBase64StringError"}}var EK=function(h){let Z=F4(h);return R4.encodeByteArray(Z,!0)},P1=function(h){return EK(h).replace(/\./g,"")},N4=function(h){try{return R4.decodeString(h,!0)}catch(Z){console.error("base64Decode failed: ",Z)}return null};function S4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw Error("Unable to locate global object.")}var qK=()=>S4().__FIREBASE_DEFAULTS__,yK=()=>{if(typeof process>"u"||typeof process.env>"u")return;let h=process.env.__FIREBASE_DEFAULTS__;if(h)return JSON.parse(h)},TK=()=>{if(typeof document>"u")return;let h;try{h=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(H){return}let Z=h&&N4(h[1]);return Z&&JSON.parse(Z)},T8=()=>{try{return q4()||qK()||yK()||TK()}catch(h){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${h}`);return}},FK=(h)=>T8()?.emulatorHosts?.[h],C4=(h)=>{let Z=FK(h);if(!Z)return;let H=Z.lastIndexOf(":");if(H<=0||H+1===Z.length)throw Error(`Invalid host ${Z} with no separate hostname and port!`);let Q=parseInt(Z.substring(H+1),10);if(Z[0]==="[")return[Z.substring(1,H-1),Q];else return[Z.substring(0,H),Q]},F8=()=>T8()?.config;class R8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((h,Z)=>{this.resolve=h,this.reject=Z})}wrapCallback(h){return(Z,H)=>{if(Z)this.reject(Z);else this.resolve(H);if(typeof h==="function")if(this.promise.catch(()=>{}),h.length===1)h(Z);else h(Z,H)}}}function z6(h){try{return(h.startsWith("http://")||h.startsWith("https://")?new URL(h).hostname:h).endsWith(".cloudworkstations.dev")}catch{return!1}}async function O4(h){return(await fetch(h,{credentials:"include"})).ok}function _4(h,Z){if(h.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let H={alg:"none",type:"JWT"},Q=Z||"demo-project",G=h.iat||0,$=h.sub||h.user_id;if(!$)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let M={iss:`https://securetoken.google.com/${Q}`,aud:Q,iat:G,exp:G+3600,auth_time:G,sub:$,user_id:$,firebase:{sign_in_provider:"custom",identities:{}},...h},X="";return[P1(JSON.stringify(H)),P1(JSON.stringify(M)),X].join(".")}var D1={};function RK(){let h={prod:[],emulator:[]};for(let Z of Object.keys(D1))if(D1[Z])h.emulator.push(Z);else h.prod.push(Z);return h}function LK(h){let Z=document.getElementById(h),H=!1;if(!Z)Z=document.createElement("div"),Z.setAttribute("id",h),H=!0;return{created:H,element:Z}}var y4=!1;function A4(h,Z){if(typeof window>"u"||typeof document>"u"||!z6(window.location.host)||D1[h]===Z||D1[h]||y4)return;D1[h]=Z;function H(y){return`__firebase__banner__${y}`}let Q="__firebase__banner",$=RK().prod.length>0;function M(){let y=document.getElementById(Q);if(y)y.remove()}function X(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function B(y,S){y.setAttribute("width","24"),y.setAttribute("id",S),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function V(){let y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{y4=!0,M()},y}function D(y,S){y.setAttribute("id",S),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function F(){let y=LK(Q),S=H("text"),j=document.getElementById(S)||document.createElement("span"),_=H("learnmore"),x=document.getElementById(_)||document.createElement("a"),p=H("preprendIcon"),t=document.getElementById(p)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){let o=y.element;X(o),D(x,_);let D0=V();B(t,p),o.append(t,j,x,D0),document.body.appendChild(o)}if($)j.innerText="Preview backend disconnected.",t.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`;else t.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,j.innerText="Preview backend running in this workspace.";j.setAttribute("id",S)}if(document.readyState==="loading")window.addEventListener("DOMContentLoaded",F);else F()}function j4(){if(typeof navigator<"u"&&typeof navigator.userAgent==="string")return navigator.userAgent;else return""}function NK(){let h=T8()?.forceEnvironment;if(h==="node")return!0;else if(h==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch(Z){return!1}}function x4(){return!NK()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L8(){try{return typeof indexedDB==="object"}catch(h){return!1}}function m4(){return new Promise((h,Z)=>{try{let H=!0,Q="validate-browser-context-for-indexeddb-analytics-module",G=self.indexedDB.open(Q);G.onsuccess=()=>{if(G.result.close(),!H)self.indexedDB.deleteDatabase(Q);h(!0)},G.onupgradeneeded=()=>{H=!1},G.onerror=()=>{Z(G.error?.message||"")}}catch(H){Z(H)}})}var SK="FirebaseError";class s0 extends Error{constructor(h,Z,H){super(Z);if(this.code=h,this.customData=H,this.name=SK,Object.setPrototypeOf(this,s0.prototype),Error.captureStackTrace)Error.captureStackTrace(this,I6.prototype.create)}}class I6{constructor(h,Z,H){this.service=h,this.serviceName=Z,this.errors=H}create(h,...Z){let H=Z[0]||{},Q=`${this.service}/${h}`,G=this.errors[h],$=G?CK(G,H):"Error",M=`${this.serviceName}: ${$} (${Q}).`;return new s0(Q,M,H)}}function CK(h,Z){return h.replace(OK,(H,Q)=>{let G=Z[Q];return G!=null?String(G):`<${Q}?>`})}var OK=/\{\$([^}]+)}/g;function Ch(h,Z){if(h===Z)return!0;let H=Object.keys(h),Q=Object.keys(Z);for(let G of H){if(!Q.includes(G))return!1;let $=h[G],M=Z[G];if(T4($)&&T4(M)){if(!Ch($,M))return!1}else if($!==M)return!1}for(let G of Q)if(!H.includes(G))return!1;return!0}function T4(h){return h!==null&&typeof h==="object"}function O0(h){if(h&&h._delegate)return h._delegate;else return h}class Qh{constructor(h,Z,H){this.name=h,this.instanceFactory=Z,this.type=H,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(h){return this.instantiationMode=h,this}setMultipleInstances(h){return this.multipleInstances=h,this}setServiceProps(h){return this.serviceProps=h,this}setInstanceCreatedCallback(h){return this.onInstanceCreated=h,this}}var Eh="[DEFAULT]";class k4{constructor(h,Z){this.name=h,this.container=Z,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(h){let Z=this.normalizeInstanceIdentifier(h);if(!this.instancesDeferred.has(Z)){let H=new R8;if(this.instancesDeferred.set(Z,H),this.isInitialized(Z)||this.shouldAutoInitialize())try{let Q=this.getOrInitializeService({instanceIdentifier:Z});if(Q)H.resolve(Q)}catch(Q){}}return this.instancesDeferred.get(Z).promise}getImmediate(h){let Z=this.normalizeInstanceIdentifier(h?.identifier),H=h?.optional??!1;if(this.isInitialized(Z)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:Z})}catch(Q){if(H)return null;else throw Q}else if(H)return null;else throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(h){if(h.name!==this.name)throw Error(`Mismatching Component ${h.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=h,!this.shouldAutoInitialize())return;if(AK(h))try{this.getOrInitializeService({instanceIdentifier:Eh})}catch(Z){}for(let[Z,H]of this.instancesDeferred.entries()){let Q=this.normalizeInstanceIdentifier(Z);try{let G=this.getOrInitializeService({instanceIdentifier:Q});H.resolve(G)}catch(G){}}}clearInstance(h=Eh){this.instancesDeferred.delete(h),this.instancesOptions.delete(h),this.instances.delete(h)}async delete(){let h=Array.from(this.instances.values());await Promise.all([...h.filter((Z)=>("INTERNAL"in Z)).map((Z)=>Z.INTERNAL.delete()),...h.filter((Z)=>("_delete"in Z)).map((Z)=>Z._delete())])}isComponentSet(){return this.component!=null}isInitialized(h=Eh){return this.instances.has(h)}getOptions(h=Eh){return this.instancesOptions.get(h)||{}}initialize(h={}){let{options:Z={}}=h,H=this.normalizeInstanceIdentifier(h.instanceIdentifier);if(this.isInitialized(H))throw Error(`${this.name}(${H}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let Q=this.getOrInitializeService({instanceIdentifier:H,options:Z});for(let[G,$]of this.instancesDeferred.entries()){let M=this.normalizeInstanceIdentifier(G);if(H===M)$.resolve(Q)}return Q}onInit(h,Z){let H=this.normalizeInstanceIdentifier(Z),Q=this.onInitCallbacks.get(H)??new Set;Q.add(h),this.onInitCallbacks.set(H,Q);let G=this.instances.get(H);if(G)h(G,H);return()=>{Q.delete(h)}}invokeOnInitCallbacks(h,Z){let H=this.onInitCallbacks.get(Z);if(!H)return;for(let Q of H)try{Q(h,Z)}catch{}}getOrInitializeService({instanceIdentifier:h,options:Z={}}){let H=this.instances.get(h);if(!H&&this.component){if(H=this.component.instanceFactory(this.container,{instanceIdentifier:_K(h),options:Z}),this.instances.set(h,H),this.instancesOptions.set(h,Z),this.invokeOnInitCallbacks(H,h),this.component.onInstanceCreated)try{this.component.onInstanceCreated(this.container,h,H)}catch{}}return H||null}normalizeInstanceIdentifier(h=Eh){if(this.component)return this.component.multipleInstances?h:Eh;else return h}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _K(h){return h===Eh?void 0:h}function AK(h){return h.instantiationMode==="EAGER"}class N8{constructor(h){this.name=h,this.providers=new Map}addComponent(h){let Z=this.getProvider(h.name);if(Z.isComponentSet())throw Error(`Component ${h.name} has already been registered with ${this.name}`);Z.setComponent(h)}addOrOverwriteComponent(h){if(this.getProvider(h.name).isComponentSet())this.providers.delete(h.name);this.addComponent(h)}getProvider(h){if(this.providers.has(h))return this.providers.get(h);let Z=new k4(h,this);return this.providers.set(h,Z),Z}getProviders(){return Array.from(this.providers.values())}}var jK=[],f;(function(h){h[h.DEBUG=0]="DEBUG",h[h.VERBOSE=1]="VERBOSE",h[h.INFO=2]="INFO",h[h.WARN=3]="WARN",h[h.ERROR=4]="ERROR",h[h.SILENT=5]="SILENT"})(f||(f={}));var xK={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},mK=f.INFO,kK={[f.DEBUG]:"log",[f.VERBOSE]:"log",[f.INFO]:"info",[f.WARN]:"warn",[f.ERROR]:"error"},vK=(h,Z,...H)=>{if(Z<h.logLevel)return;let Q=new Date().toISOString(),G=kK[Z];if(G)console[G](`[${Q}]  ${h.name}:`,...H);else throw Error(`Attempted to log a message with an invalid logType (value: ${Z})`)};class w1{constructor(h){this.name=h,this._logLevel=mK,this._logHandler=vK,this._userLogHandler=null,jK.push(this)}get logLevel(){return this._logLevel}set logLevel(h){if(!(h in f))throw TypeError(`Invalid value "${h}" assigned to \`logLevel\``);this._logLevel=h}setLogLevel(h){this._logLevel=typeof h==="string"?xK[h]:h}get logHandler(){return this._logHandler}set logHandler(h){if(typeof h!=="function")throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=h}get userLogHandler(){return this._userLogHandler}set userLogHandler(h){this._userLogHandler=h}debug(...h){this._userLogHandler&&this._userLogHandler(this,f.DEBUG,...h),this._logHandler(this,f.DEBUG,...h)}log(...h){this._userLogHandler&&this._userLogHandler(this,f.VERBOSE,...h),this._logHandler(this,f.VERBOSE,...h)}info(...h){this._userLogHandler&&this._userLogHandler(this,f.INFO,...h),this._logHandler(this,f.INFO,...h)}warn(...h){this._userLogHandler&&this._userLogHandler(this,f.WARN,...h),this._logHandler(this,f.WARN,...h)}error(...h){this._userLogHandler&&this._userLogHandler(this,f.ERROR,...h),this._logHandler(this,f.ERROR,...h)}}var uK=(h,Z)=>Z.some((H)=>h instanceof H),v4,u4;function lK(){return v4||(v4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sK(){return u4||(u4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var l4=new WeakMap,C8=new WeakMap,s4=new WeakMap,S8=new WeakMap,_8=new WeakMap;function iK(h){let Z=new Promise((H,Q)=>{let G=()=>{h.removeEventListener("success",$),h.removeEventListener("error",M)},$=()=>{H(_0(h.result)),G()},M=()=>{Q(h.error),G()};h.addEventListener("success",$),h.addEventListener("error",M)});return Z.then((H)=>{if(H instanceof IDBCursor)l4.set(H,h)}).catch(()=>{}),_8.set(Z,h),Z}function fK(h){if(C8.has(h))return;let Z=new Promise((H,Q)=>{let G=()=>{h.removeEventListener("complete",$),h.removeEventListener("error",M),h.removeEventListener("abort",M)},$=()=>{H(),G()},M=()=>{Q(h.error||new DOMException("AbortError","AbortError")),G()};h.addEventListener("complete",$),h.addEventListener("error",M),h.addEventListener("abort",M)});C8.set(h,Z)}var O8={get(h,Z,H){if(h instanceof IDBTransaction){if(Z==="done")return C8.get(h);if(Z==="objectStoreNames")return h.objectStoreNames||s4.get(h);if(Z==="store")return H.objectStoreNames[1]?void 0:H.objectStore(H.objectStoreNames[0])}return _0(h[Z])},set(h,Z,H){return h[Z]=H,!0},has(h,Z){if(h instanceof IDBTransaction&&(Z==="done"||Z==="store"))return!0;return Z in h}};function i4(h){O8=h(O8)}function gK(h){if(h===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype))return function(Z,...H){let Q=h.call(D6(this),Z,...H);return s4.set(Q,Z.sort?Z.sort():[Z]),_0(Q)};if(sK().includes(h))return function(...Z){return h.apply(D6(this),Z),_0(l4.get(this))};return function(...Z){return _0(h.apply(D6(this),Z))}}function tK(h){if(typeof h==="function")return gK(h);if(h instanceof IDBTransaction)fK(h);if(uK(h,lK()))return new Proxy(h,O8);return h}function _0(h){if(h instanceof IDBRequest)return iK(h);if(S8.has(h))return S8.get(h);let Z=tK(h);if(Z!==h)S8.set(h,Z),_8.set(Z,h);return Z}var D6=(h)=>_8.get(h);function g4(h,Z,{blocked:H,upgrade:Q,blocking:G,terminated:$}={}){let M=indexedDB.open(h,Z),X=_0(M);if(Q)M.addEventListener("upgradeneeded",(B)=>{Q(_0(M.result),B.oldVersion,B.newVersion,_0(M.transaction),B)});if(H)M.addEventListener("blocked",(B)=>H(B.oldVersion,B.newVersion,B));return X.then((B)=>{if($)B.addEventListener("close",()=>$());if(G)B.addEventListener("versionchange",(V)=>G(V.oldVersion,V.newVersion,V))}).catch(()=>{}),X}var pK=["get","getKey","getAll","getAllKeys","count"],dK=["put","add","delete","clear"],A8=new Map;function f4(h,Z){if(!(h instanceof IDBDatabase&&!(Z in h)&&typeof Z==="string"))return;if(A8.get(Z))return A8.get(Z);let H=Z.replace(/FromIndex$/,""),Q=Z!==H,G=dK.includes(H);if(!(H in(Q?IDBIndex:IDBObjectStore).prototype)||!(G||pK.includes(H)))return;let $=async function(M,...X){let B=this.transaction(M,G?"readwrite":"readonly"),V=B.store;if(Q)V=V.index(X.shift());return(await Promise.all([V[H](...X),G&&B.done]))[0]};return A8.set(Z,$),$}i4((h)=>({...h,get:(Z,H,Q)=>f4(Z,H)||h.get(Z,H,Q),has:(Z,H)=>!!f4(Z,H)||h.has(Z,H)}));class r4{constructor(h){this.container=h}getPlatformInfoString(){return this.container.getProviders().map((Z)=>{if(oK(Z)){let H=Z.getImmediate();return`${H.library}/${H.version}`}else return null}).filter((Z)=>Z).join(" ")}}function oK(h){return h.getComponent()?.type==="VERSION"}var x8="@firebase/app",t4="0.14.6",i0=new w1("@firebase/app"),nK="@firebase/app-compat",rK="@firebase/analytics-compat",cK="@firebase/analytics",bK="@firebase/app-check-compat",eK="@firebase/app-check",aK="@firebase/auth",hG="@firebase/auth-compat",ZG="@firebase/database",HG="@firebase/data-connect",QG="@firebase/database-compat",KG="@firebase/functions",GG="@firebase/functions-compat",$G="@firebase/installations",JG="@firebase/installations-compat",MG="@firebase/messaging",WG="@firebase/messaging-compat",XG="@firebase/performance",BG="@firebase/performance-compat",UG="@firebase/remote-config",VG="@firebase/remote-config-compat",YG="@firebase/storage",zG="@firebase/storage-compat",IG="@firebase/firestore",DG="@firebase/ai",PG="@firebase/firestore-compat",wG="firebase",EG="12.6.0",m8="[DEFAULT]",qG={[x8]:"fire-core",[nK]:"fire-core-compat",[cK]:"fire-analytics",[rK]:"fire-analytics-compat",[eK]:"fire-app-check",[bK]:"fire-app-check-compat",[aK]:"fire-auth",[hG]:"fire-auth-compat",[ZG]:"fire-rtdb",[HG]:"fire-data-connect",[QG]:"fire-rtdb-compat",[KG]:"fire-fn",[GG]:"fire-fn-compat",[$G]:"fire-iid",[JG]:"fire-iid-compat",[MG]:"fire-fcm",[WG]:"fire-fcm-compat",[XG]:"fire-perf",[BG]:"fire-perf-compat",[UG]:"fire-rc",[VG]:"fire-rc-compat",[YG]:"fire-gcs",[zG]:"fire-gcs-compat",[IG]:"fire-fst",[PG]:"fire-fst-compat",[DG]:"fire-vertex","fire-js":"fire-js",[wG]:"fire-js-all"},P6=new Map,yG=new Map,k8=new Map;function p4(h,Z){try{h.container.addComponent(Z)}catch(H){i0.debug(`Component ${Z.name} failed to register with FirebaseApp ${h.name}`,H)}}function E1(h){let Z=h.name;if(k8.has(Z))return i0.debug(`There were multiple attempts to register component ${Z}.`),!1;k8.set(Z,h);for(let H of P6.values())p4(H,h);for(let H of yG.values())p4(H,h);return!0}function c4(h,Z){let H=h.container.getProvider("heartbeat").getImmediate({optional:!0});if(H)H.triggerHeartbeat();return h.container.getProvider(Z)}function b4(h){if(h===null||h===void 0)return!1;return h.settings!==void 0}var TG={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}'",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["server-app-deleted"]:"Firebase Server App has been deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.",["finalization-registry-not-supported"]:"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.",["invalid-server-app-environment"]:"FirebaseServerApp is not for use in browser environments."},Kh=new I6("app","Firebase",TG);class e4{constructor(h,Z,H){this._isDeleted=!1,this._options={...h},this._config={...Z},this._name=Z.name,this._automaticDataCollectionEnabled=Z.automaticDataCollectionEnabled,this._container=H,this.container.addComponent(new Qh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(h){this.checkDestroyed(),this._automaticDataCollectionEnabled=h}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(h){this._isDeleted=h}checkDestroyed(){if(this.isDeleted)throw Kh.create("app-deleted",{appName:this._name})}}var a4=EG;function v8(h,Z={}){let H=h;if(typeof Z!=="object")Z={name:Z};let Q={name:m8,automaticDataCollectionEnabled:!0,...Z},G=Q.name;if(typeof G!=="string"||!G)throw Kh.create("bad-app-name",{appName:String(G)});if(H||(H=F8()),!H)throw Kh.create("no-options");let $=P6.get(G);if($)if(Ch(H,$.options)&&Ch(Q,$.config))return $;else throw Kh.create("duplicate-app",{appName:G});let M=new N8(G);for(let B of k8.values())M.addComponent(B);let X=new e4(H,Q,M);return P6.set(G,X),X}function h5(h=m8){let Z=P6.get(h);if(!Z&&h===m8&&F8())return v8();if(!Z)throw Kh.create("no-app",{appName:h});return Z}function Gh(h,Z,H){let Q=qG[h]??h;if(H)Q+=`-${H}`;let G=Q.match(/\s|\//),$=Z.match(/\s|\//);if(G||$){let M=[`Unable to register library "${Q}" with version "${Z}":`];if(G)M.push(`library name "${Q}" contains illegal characters (whitespace or "/")`);if(G&&$)M.push("and");if($)M.push(`version name "${Z}" contains illegal characters (whitespace or "/")`);i0.warn(M.join(" "));return}E1(new Qh(`${Q}-version`,()=>({library:Q,version:Z}),"VERSION"))}var FG="firebase-heartbeat-database",RG=1,q1="firebase-heartbeat-store",j8=null;function Z5(){if(!j8)j8=g4(FG,RG,{upgrade:(h,Z)=>{switch(Z){case 0:try{h.createObjectStore(q1)}catch(H){console.warn(H)}}}}).catch((h)=>{throw Kh.create("idb-open",{originalErrorMessage:h.message})});return j8}async function LG(h){try{let H=(await Z5()).transaction(q1),Q=await H.objectStore(q1).get(H5(h));return await H.done,Q}catch(Z){if(Z instanceof s0)i0.warn(Z.message);else{let H=Kh.create("idb-get",{originalErrorMessage:Z?.message});i0.warn(H.message)}}}async function d4(h,Z){try{let Q=(await Z5()).transaction(q1,"readwrite");await Q.objectStore(q1).put(Z,H5(h)),await Q.done}catch(H){if(H instanceof s0)i0.warn(H.message);else{let Q=Kh.create("idb-set",{originalErrorMessage:H?.message});i0.warn(Q.message)}}}function H5(h){return`${h.name}!${h.options.appId}`}var NG=1024,SG=30;class Q5{constructor(h){this.container=h,this._heartbeatsCache=null;let Z=this.container.getProvider("app").getImmediate();this._storage=new K5(Z),this._heartbeatsCachePromise=this._storage.read().then((H)=>{return this._heartbeatsCache=H,H})}async triggerHeartbeat(){try{let Z=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),H=o4();if(this._heartbeatsCache?.heartbeats==null){if(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)return}if(this._heartbeatsCache.lastSentHeartbeatDate===H||this._heartbeatsCache.heartbeats.some((Q)=>Q.date===H))return;else if(this._heartbeatsCache.heartbeats.push({date:H,agent:Z}),this._heartbeatsCache.heartbeats.length>SG){let Q=OG(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(Q,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(h){i0.warn(h)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null)await this._heartbeatsCachePromise;if(this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let h=o4(),{heartbeatsToSend:Z,unsentEntries:H}=CG(this._heartbeatsCache.heartbeats),Q=P1(JSON.stringify({version:2,heartbeats:Z}));if(this._heartbeatsCache.lastSentHeartbeatDate=h,H.length>0)this._heartbeatsCache.heartbeats=H,await this._storage.overwrite(this._heartbeatsCache);else this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);return Q}catch(h){return i0.warn(h),""}}}function o4(){return new Date().toISOString().substring(0,10)}function CG(h,Z=NG){let H=[],Q=h.slice();for(let G of h){let $=H.find((M)=>M.agent===G.agent);if(!$){if(H.push({agent:G.agent,dates:[G.date]}),n4(H)>Z){H.pop();break}}else if($.dates.push(G.date),n4(H)>Z){$.dates.pop();break}Q=Q.slice(1)}return{heartbeatsToSend:H,unsentEntries:Q}}class K5{constructor(h){this.app=h,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){if(!L8())return!1;else return m4().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};else{let Z=await LG(this.app);if(Z?.heartbeats)return Z;else return{heartbeats:[]}}}async overwrite(h){if(!await this._canUseIndexedDBPromise)return;else{let H=await this.read();return d4(this.app,{lastSentHeartbeatDate:h.lastSentHeartbeatDate??H.lastSentHeartbeatDate,heartbeats:h.heartbeats})}}async add(h){if(!await this._canUseIndexedDBPromise)return;else{let H=await this.read();return d4(this.app,{lastSentHeartbeatDate:h.lastSentHeartbeatDate??H.lastSentHeartbeatDate,heartbeats:[...H.heartbeats,...h.heartbeats]})}}}function n4(h){return P1(JSON.stringify({version:2,heartbeats:h})).length}function OG(h){if(h.length===0)return-1;let Z=0,H=h[0].date;for(let Q=1;Q<h.length;Q++)if(h[Q].date<H)H=h[Q].date,Z=Q;return Z}function _G(h){E1(new Qh("platform-logger",(Z)=>new r4(Z),"PRIVATE")),E1(new Qh("heartbeat",(Z)=>new Q5(Z),"PRIVATE")),Gh(x8,t4,h),Gh(x8,t4,"esm2020"),Gh("fire-js","")}_G("");var AG="firebase",jG="12.7.0";Gh(AG,jG,"app");var G5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$5={},f0,u8;(function(){var h;function Z(w,Y){function I(){}I.prototype=Y.prototype,w.F=Y.prototype,w.prototype=new I,w.prototype.constructor=w,w.D=function(E,P,T){for(var z=Array(arguments.length-2),E0=2;E0<arguments.length;E0++)z[E0-2]=arguments[E0];return Y.prototype[P].apply(E,z)}}function H(){this.blockSize=-1}function Q(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}Z(Q,H),Q.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function G(w,Y,I){I||(I=0);let E=Array(16);if(typeof Y==="string")for(var P=0;P<16;++P)E[P]=Y.charCodeAt(I++)|Y.charCodeAt(I++)<<8|Y.charCodeAt(I++)<<16|Y.charCodeAt(I++)<<24;else for(P=0;P<16;++P)E[P]=Y[I++]|Y[I++]<<8|Y[I++]<<16|Y[I++]<<24;Y=w.g[0],I=w.g[1],P=w.g[2];let T=w.g[3],z;z=Y+(T^I&(P^T))+E[0]+3614090360&4294967295,Y=I+(z<<7&4294967295|z>>>25),z=T+(P^Y&(I^P))+E[1]+3905402710&4294967295,T=Y+(z<<12&4294967295|z>>>20),z=P+(I^T&(Y^I))+E[2]+606105819&4294967295,P=T+(z<<17&4294967295|z>>>15),z=I+(Y^P&(T^Y))+E[3]+3250441966&4294967295,I=P+(z<<22&4294967295|z>>>10),z=Y+(T^I&(P^T))+E[4]+4118548399&4294967295,Y=I+(z<<7&4294967295|z>>>25),z=T+(P^Y&(I^P))+E[5]+1200080426&4294967295,T=Y+(z<<12&4294967295|z>>>20),z=P+(I^T&(Y^I))+E[6]+2821735955&4294967295,P=T+(z<<17&4294967295|z>>>15),z=I+(Y^P&(T^Y))+E[7]+4249261313&4294967295,I=P+(z<<22&4294967295|z>>>10),z=Y+(T^I&(P^T))+E[8]+1770035416&4294967295,Y=I+(z<<7&4294967295|z>>>25),z=T+(P^Y&(I^P))+E[9]+2336552879&4294967295,T=Y+(z<<12&4294967295|z>>>20),z=P+(I^T&(Y^I))+E[10]+4294925233&4294967295,P=T+(z<<17&4294967295|z>>>15),z=I+(Y^P&(T^Y))+E[11]+2304563134&4294967295,I=P+(z<<22&4294967295|z>>>10),z=Y+(T^I&(P^T))+E[12]+1804603682&4294967295,Y=I+(z<<7&4294967295|z>>>25),z=T+(P^Y&(I^P))+E[13]+4254626195&4294967295,T=Y+(z<<12&4294967295|z>>>20),z=P+(I^T&(Y^I))+E[14]+2792965006&4294967295,P=T+(z<<17&4294967295|z>>>15),z=I+(Y^P&(T^Y))+E[15]+1236535329&4294967295,I=P+(z<<22&4294967295|z>>>10),z=Y+(P^T&(I^P))+E[1]+4129170786&4294967295,Y=I+(z<<5&4294967295|z>>>27),z=T+(I^P&(Y^I))+E[6]+3225465664&4294967295,T=Y+(z<<9&4294967295|z>>>23),z=P+(Y^I&(T^Y))+E[11]+643717713&4294967295,P=T+(z<<14&4294967295|z>>>18),z=I+(T^Y&(P^T))+E[0]+3921069994&4294967295,I=P+(z<<20&4294967295|z>>>12),z=Y+(P^T&(I^P))+E[5]+3593408605&4294967295,Y=I+(z<<5&4294967295|z>>>27),z=T+(I^P&(Y^I))+E[10]+38016083&4294967295,T=Y+(z<<9&4294967295|z>>>23),z=P+(Y^I&(T^Y))+E[15]+3634488961&4294967295,P=T+(z<<14&4294967295|z>>>18),z=I+(T^Y&(P^T))+E[4]+3889429448&4294967295,I=P+(z<<20&4294967295|z>>>12),z=Y+(P^T&(I^P))+E[9]+568446438&4294967295,Y=I+(z<<5&4294967295|z>>>27),z=T+(I^P&(Y^I))+E[14]+3275163606&4294967295,T=Y+(z<<9&4294967295|z>>>23),z=P+(Y^I&(T^Y))+E[3]+4107603335&4294967295,P=T+(z<<14&4294967295|z>>>18),z=I+(T^Y&(P^T))+E[8]+1163531501&4294967295,I=P+(z<<20&4294967295|z>>>12),z=Y+(P^T&(I^P))+E[13]+2850285829&4294967295,Y=I+(z<<5&4294967295|z>>>27),z=T+(I^P&(Y^I))+E[2]+4243563512&4294967295,T=Y+(z<<9&4294967295|z>>>23),z=P+(Y^I&(T^Y))+E[7]+1735328473&4294967295,P=T+(z<<14&4294967295|z>>>18),z=I+(T^Y&(P^T))+E[12]+2368359562&4294967295,I=P+(z<<20&4294967295|z>>>12),z=Y+(I^P^T)+E[5]+4294588738&4294967295,Y=I+(z<<4&4294967295|z>>>28),z=T+(Y^I^P)+E[8]+2272392833&4294967295,T=Y+(z<<11&4294967295|z>>>21),z=P+(T^Y^I)+E[11]+1839030562&4294967295,P=T+(z<<16&4294967295|z>>>16),z=I+(P^T^Y)+E[14]+4259657740&4294967295,I=P+(z<<23&4294967295|z>>>9),z=Y+(I^P^T)+E[1]+2763975236&4294967295,Y=I+(z<<4&4294967295|z>>>28),z=T+(Y^I^P)+E[4]+1272893353&4294967295,T=Y+(z<<11&4294967295|z>>>21),z=P+(T^Y^I)+E[7]+4139469664&4294967295,P=T+(z<<16&4294967295|z>>>16),z=I+(P^T^Y)+E[10]+3200236656&4294967295,I=P+(z<<23&4294967295|z>>>9),z=Y+(I^P^T)+E[13]+681279174&4294967295,Y=I+(z<<4&4294967295|z>>>28),z=T+(Y^I^P)+E[0]+3936430074&4294967295,T=Y+(z<<11&4294967295|z>>>21),z=P+(T^Y^I)+E[3]+3572445317&4294967295,P=T+(z<<16&4294967295|z>>>16),z=I+(P^T^Y)+E[6]+76029189&4294967295,I=P+(z<<23&4294967295|z>>>9),z=Y+(I^P^T)+E[9]+3654602809&4294967295,Y=I+(z<<4&4294967295|z>>>28),z=T+(Y^I^P)+E[12]+3873151461&4294967295,T=Y+(z<<11&4294967295|z>>>21),z=P+(T^Y^I)+E[15]+530742520&4294967295,P=T+(z<<16&4294967295|z>>>16),z=I+(P^T^Y)+E[2]+3299628645&4294967295,I=P+(z<<23&4294967295|z>>>9),z=Y+(P^(I|~T))+E[0]+4096336452&4294967295,Y=I+(z<<6&4294967295|z>>>26),z=T+(I^(Y|~P))+E[7]+1126891415&4294967295,T=Y+(z<<10&4294967295|z>>>22),z=P+(Y^(T|~I))+E[14]+2878612391&4294967295,P=T+(z<<15&4294967295|z>>>17),z=I+(T^(P|~Y))+E[5]+4237533241&4294967295,I=P+(z<<21&4294967295|z>>>11),z=Y+(P^(I|~T))+E[12]+1700485571&4294967295,Y=I+(z<<6&4294967295|z>>>26),z=T+(I^(Y|~P))+E[3]+2399980690&4294967295,T=Y+(z<<10&4294967295|z>>>22),z=P+(Y^(T|~I))+E[10]+4293915773&4294967295,P=T+(z<<15&4294967295|z>>>17),z=I+(T^(P|~Y))+E[1]+2240044497&4294967295,I=P+(z<<21&4294967295|z>>>11),z=Y+(P^(I|~T))+E[8]+1873313359&4294967295,Y=I+(z<<6&4294967295|z>>>26),z=T+(I^(Y|~P))+E[15]+4264355552&4294967295,T=Y+(z<<10&4294967295|z>>>22),z=P+(Y^(T|~I))+E[6]+2734768916&4294967295,P=T+(z<<15&4294967295|z>>>17),z=I+(T^(P|~Y))+E[13]+1309151649&4294967295,I=P+(z<<21&4294967295|z>>>11),z=Y+(P^(I|~T))+E[4]+4149444226&4294967295,Y=I+(z<<6&4294967295|z>>>26),z=T+(I^(Y|~P))+E[11]+3174756917&4294967295,T=Y+(z<<10&4294967295|z>>>22),z=P+(Y^(T|~I))+E[2]+718787259&4294967295,P=T+(z<<15&4294967295|z>>>17),z=I+(T^(P|~Y))+E[9]+3951481745&4294967295,w.g[0]=w.g[0]+Y&4294967295,w.g[1]=w.g[1]+(P+(z<<21&4294967295|z>>>11))&4294967295,w.g[2]=w.g[2]+P&4294967295,w.g[3]=w.g[3]+T&4294967295}Q.prototype.v=function(w,Y){Y===void 0&&(Y=w.length);let I=Y-this.blockSize,E=this.C,P=this.h,T=0;for(;T<Y;){if(P==0)for(;T<=I;)G(this,w,T),T+=this.blockSize;if(typeof w==="string"){for(;T<Y;)if(E[P++]=w.charCodeAt(T++),P==this.blockSize){G(this,E),P=0;break}}else for(;T<Y;)if(E[P++]=w[T++],P==this.blockSize){G(this,E),P=0;break}}this.h=P,this.o+=Y},Q.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var Y=1;Y<w.length-8;++Y)w[Y]=0;Y=this.o*8;for(var I=w.length-8;I<w.length;++I)w[I]=Y&255,Y/=256;this.v(w),w=Array(16),Y=0;for(I=0;I<4;++I)for(let E=0;E<32;E+=8)w[Y++]=this.g[I]>>>E&255;return w};function $(w,Y){var I=X;return Object.prototype.hasOwnProperty.call(I,w)?I[w]:I[w]=Y(w)}function M(w,Y){this.h=Y;let I=[],E=!0;for(let P=w.length-1;P>=0;P--){let T=w[P]|0;E&&T==Y||(I[P]=T,E=!1)}this.g=I}var X={};function B(w){return-128<=w&&w<128?$(w,function(Y){return new M([Y|0],Y<0?-1:0)}):new M([w|0],w<0?-1:0)}function V(w){if(isNaN(w)||!isFinite(w))return F;if(w<0)return x(V(-w));let Y=[],I=1;for(let E=0;w>=I;E++)Y[E]=w/I|0,I*=4294967296;return new M(Y,0)}function D(w,Y){if(w.length==0)throw Error("number format error: empty string");if(Y=Y||10,Y<2||36<Y)throw Error("radix out of range: "+Y);if(w.charAt(0)=="-")return x(D(w.substring(1),Y));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');let I=V(Math.pow(Y,8)),E=F;for(let T=0;T<w.length;T+=8){var P=Math.min(8,w.length-T);let z=parseInt(w.substring(T,T+P),Y);P<8?(P=V(Math.pow(Y,P)),E=E.j(P).add(V(z))):(E=E.j(I),E=E.add(V(z)))}return E}var F=B(0),y=B(1),S=B(16777216);h=M.prototype,h.m=function(){if(_(this))return-x(this).m();let w=0,Y=1;for(let I=0;I<this.g.length;I++){let E=this.i(I);w+=(E>=0?E:4294967296+E)*Y,Y*=4294967296}return w},h.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(j(this))return"0";if(_(this))return"-"+x(this).toString(w);let Y=V(Math.pow(w,6));var I=this;let E="";for(;;){let P=D0(I,Y).g;I=p(I,P.j(Y));let T=((I.g.length>0?I.g[0]:I.h)>>>0).toString(w);if(I=P,j(I))return T+E;for(;T.length<6;)T="0"+T;E=T+E}},h.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function j(w){if(w.h!=0)return!1;for(let Y=0;Y<w.g.length;Y++)if(w.g[Y]!=0)return!1;return!0}function _(w){return w.h==-1}h.l=function(w){return w=p(this,w),_(w)?-1:j(w)?0:1};function x(w){let Y=w.g.length,I=[];for(let E=0;E<Y;E++)I[E]=~w.g[E];return new M(I,~w.h).add(y)}h.abs=function(){return _(this)?x(this):this},h.add=function(w){let Y=Math.max(this.g.length,w.g.length),I=[],E=0;for(let P=0;P<=Y;P++){let T=E+(this.i(P)&65535)+(w.i(P)&65535),z=(T>>>16)+(this.i(P)>>>16)+(w.i(P)>>>16);E=z>>>16,T&=65535,z&=65535,I[P]=z<<16|T}return new M(I,I[I.length-1]&-2147483648?-1:0)};function p(w,Y){return w.add(x(Y))}h.j=function(w){if(j(this)||j(w))return F;if(_(this))return _(w)?x(this).j(x(w)):x(x(this).j(w));if(_(w))return x(this.j(x(w)));if(this.l(S)<0&&w.l(S)<0)return V(this.m()*w.m());let Y=this.g.length+w.g.length,I=[];for(var E=0;E<2*Y;E++)I[E]=0;for(E=0;E<this.g.length;E++)for(let P=0;P<w.g.length;P++){let T=this.i(E)>>>16,z=this.i(E)&65535,E0=w.i(P)>>>16,c0=w.i(P)&65535;I[2*E+2*P]+=z*c0,t(I,2*E+2*P),I[2*E+2*P+1]+=T*c0,t(I,2*E+2*P+1),I[2*E+2*P+1]+=z*E0,t(I,2*E+2*P+1),I[2*E+2*P+2]+=T*E0,t(I,2*E+2*P+2)}for(w=0;w<Y;w++)I[w]=I[2*w+1]<<16|I[2*w];for(w=Y;w<2*Y;w++)I[w]=0;return new M(I,0)};function t(w,Y){for(;(w[Y]&65535)!=w[Y];)w[Y+1]+=w[Y]>>>16,w[Y]&=65535,Y++}function o(w,Y){this.g=w,this.h=Y}function D0(w,Y){if(j(Y))throw Error("division by zero");if(j(w))return new o(F,F);if(_(w))return Y=D0(x(w),Y),new o(x(Y.g),x(Y.h));if(_(Y))return Y=D0(w,x(Y)),new o(x(Y.g),Y.h);if(w.g.length>30){if(_(w)||_(Y))throw Error("slowDivide_ only works with positive integers.");for(var I=y,E=Y;E.l(w)<=0;)I=T0(I),E=T0(E);var P=V0(I,1),T=V0(E,1);E=V0(E,2);for(I=V0(I,2);!j(E);){var z=T.add(E);z.l(w)<=0&&(P=P.add(I),T=z),E=V0(E,1),I=V0(I,1)}return Y=p(w,P.j(Y)),new o(P,Y)}for(P=F;w.l(Y)>=0;){I=Math.max(1,Math.floor(w.m()/Y.m())),E=Math.ceil(Math.log(I)/Math.LN2),E=E<=48?1:Math.pow(2,E-48),T=V(I);for(z=T.j(Y);_(z)||z.l(w)>0;)I-=E,T=V(I),z=T.j(Y);j(T)&&(T=y),P=P.add(T),w=p(w,z)}return new o(P,w)}h.B=function(w){return D0(this,w).h},h.and=function(w){let Y=Math.max(this.g.length,w.g.length),I=[];for(let E=0;E<Y;E++)I[E]=this.i(E)&w.i(E);return new M(I,this.h&w.h)},h.or=function(w){let Y=Math.max(this.g.length,w.g.length),I=[];for(let E=0;E<Y;E++)I[E]=this.i(E)|w.i(E);return new M(I,this.h|w.h)},h.xor=function(w){let Y=Math.max(this.g.length,w.g.length),I=[];for(let E=0;E<Y;E++)I[E]=this.i(E)^w.i(E);return new M(I,this.h^w.h)};function T0(w){let Y=w.g.length+1,I=[];for(let E=0;E<Y;E++)I[E]=w.i(E)<<1|w.i(E-1)>>>31;return new M(I,w.h)}function V0(w,Y){let I=Y>>5;Y%=32;let E=w.g.length-I,P=[];for(let T=0;T<E;T++)P[T]=Y>0?w.i(T+I)>>>Y|w.i(T+I+1)<<32-Y:w.i(T+I);return new M(P,w.h)}Q.prototype.digest=Q.prototype.A,Q.prototype.reset=Q.prototype.u,Q.prototype.update=Q.prototype.v,u8=$5.Md5=Q,M.prototype.add=M.prototype.add,M.prototype.multiply=M.prototype.j,M.prototype.modulo=M.prototype.B,M.prototype.compare=M.prototype.l,M.prototype.toNumber=M.prototype.m,M.prototype.toString=M.prototype.toString,M.prototype.getBits=M.prototype.i,M.fromNumber=V,M.fromString=D,f0=$5.Integer=M}).apply(typeof G5<"u"?G5:typeof self<"u"?self:typeof window<"u"?window:{});var w6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},g0={},l8,xG,Oh,s8,y1,E6,i8,f8,g8;(function(){var h,Z=Object.defineProperty;function H(K){K=[typeof globalThis=="object"&&globalThis,K,typeof window=="object"&&window,typeof self=="object"&&self,typeof w6=="object"&&w6];for(var J=0;J<K.length;++J){var W=K[J];if(W&&W.Math==Math)return W}throw Error("Cannot find global object")}var Q=H(this);function G(K,J){if(J)h:{var W=Q;K=K.split(".");for(var U=0;U<K.length-1;U++){var q=K[U];if(!(q in W))break h;W=W[q]}K=K[K.length-1],U=W[K],J=J(U),J!=U&&J!=null&&Z(W,K,{configurable:!0,writable:!0,value:J})}}G("Symbol.dispose",function(K){return K?K:Symbol("Symbol.dispose")}),G("Array.prototype.values",function(K){return K?K:function(){return this[Symbol.iterator]()}}),G("Object.entries",function(K){return K?K:function(J){var W=[],U;for(U in J)Object.prototype.hasOwnProperty.call(J,U)&&W.push([U,J[U]]);return W}});var $=$||{},M=this||self;function X(K){var J=typeof K;return J=="object"&&K!=null||J=="function"}function B(K,J,W){return K.call.apply(K.bind,arguments)}function V(K,J,W){return V=B,V.apply(null,arguments)}function D(K,J){var W=Array.prototype.slice.call(arguments,1);return function(){var U=W.slice();return U.push.apply(U,arguments),K.apply(this,U)}}function F(K,J){function W(){}W.prototype=J.prototype,K.Z=J.prototype,K.prototype=new W,K.prototype.constructor=K,K.Ob=function(U,q,R){for(var C=Array(arguments.length-2),l=2;l<arguments.length;l++)C[l-2]=arguments[l];return J.prototype[q].apply(U,C)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot==="function"?(K)=>K&&AsyncContext.Snapshot.wrap(K):(K)=>K;function S(K){let J=K.length;if(J>0){let W=Array(J);for(let U=0;U<J;U++)W[U]=K[U];return W}return[]}function j(K,J){for(let U=1;U<arguments.length;U++){let q=arguments[U];var W=typeof q;if(W=W!="object"?W:q?Array.isArray(q)?"array":W:"null",W=="array"||W=="object"&&typeof q.length=="number"){W=K.length||0;let R=q.length||0;K.length=W+R;for(let C=0;C<R;C++)K[W+C]=q[C]}else K.push(q)}}class _{constructor(K,J){this.i=K,this.j=J,this.h=0,this.g=null}get(){let K;return this.h>0?(this.h--,K=this.g,this.g=K.next,K.next=null):K=this.i(),K}}function x(K){M.setTimeout(()=>{throw K},0)}function p(){var K=w;let J=null;return K.g&&(J=K.g,K.g=K.g.next,K.g||(K.h=null),J.next=null),J}class t{constructor(){this.h=this.g=null}add(K,J){let W=o.get();W.set(K,J),this.h?this.h.next=W:this.g=W,this.h=W}}var o=new _(()=>new D0,(K)=>K.reset());class D0{constructor(){this.next=this.g=this.h=null}set(K,J){this.h=K,this.g=J,this.next=null}reset(){this.next=this.g=this.h=null}}let T0,V0=!1,w=new t,Y=()=>{let K=Promise.resolve(void 0);T0=()=>{K.then(I)}};function I(){for(var K;K=p();){try{K.h.call(K.g)}catch(W){x(W)}var J=o;J.j(K),J.h<100&&(J.h++,K.next=J.g,J.g=K)}V0=!1}function E(){this.u=this.u,this.C=this.C}E.prototype.u=!1,E.prototype.dispose=function(){this.u||(this.u=!0,this.N())},E.prototype[Symbol.dispose]=function(){this.dispose()},E.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(K,J){this.type=K,this.g=this.target=J,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var T=function(){if(!M.addEventListener||!Object.defineProperty)return!1;var K=!1,J=Object.defineProperty({},"passive",{get:function(){K=!0}});try{let W=()=>{};M.addEventListener("test",W,J),M.removeEventListener("test",W,J)}catch(W){}return K}();function z(K){return/^[\s\xa0]*$/.test(K)}function E0(K,J){P.call(this,K?K.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,K&&this.init(K,J)}F(E0,P),E0.prototype.init=function(K,J){let W=this.type=K.type,U=K.changedTouches&&K.changedTouches.length?K.changedTouches[0]:null;this.target=K.target||K.srcElement,this.g=J,J=K.relatedTarget,J||(W=="mouseover"?J=K.fromElement:W=="mouseout"&&(J=K.toElement)),this.relatedTarget=J,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=K.clientX!==void 0?K.clientX:K.pageX,this.clientY=K.clientY!==void 0?K.clientY:K.pageY,this.screenX=K.screenX||0,this.screenY=K.screenY||0),this.button=K.button,this.key=K.key||"",this.ctrlKey=K.ctrlKey,this.altKey=K.altKey,this.shiftKey=K.shiftKey,this.metaKey=K.metaKey,this.pointerId=K.pointerId||0,this.pointerType=K.pointerType,this.state=K.state,this.i=K,K.defaultPrevented&&E0.Z.h.call(this)},E0.prototype.h=function(){E0.Z.h.call(this);let K=this.i;K.preventDefault?K.preventDefault():K.returnValue=!1};var c0="closure_listenable_"+(Math.random()*1e6|0),gQ=0;function tQ(K,J,W,U,q){this.listener=K,this.proxy=null,this.src=J,this.type=W,this.capture=!!U,this.ha=q,this.key=++gQ,this.da=this.fa=!1}function a1(K){K.da=!0,K.listener=null,K.proxy=null,K.src=null,K.ha=null}function h6(K,J,W){for(let U in K)J.call(W,K[U],U,K)}function pQ(K,J){for(let W in K)J.call(void 0,K[W],W,K)}function DZ(K){let J={};for(let W in K)J[W]=K[W];return J}let PZ="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function wZ(K,J){let W,U;for(let q=1;q<arguments.length;q++){U=arguments[q];for(W in U)K[W]=U[W];for(let R=0;R<PZ.length;R++)W=PZ[R],Object.prototype.hasOwnProperty.call(U,W)&&(K[W]=U[W])}}function Z6(K){this.src=K,this.g={},this.h=0}Z6.prototype.add=function(K,J,W,U,q){let R=K.toString();K=this.g[R],K||(K=this.g[R]=[],this.h++);let C=e6(K,J,U,q);return C>-1?(J=K[C],W||(J.fa=!1)):(J=new tQ(J,this.src,R,!!U,q),J.fa=W,K.push(J)),J};function b6(K,J){let W=J.type;if(W in K.g){var U=K.g[W],q=Array.prototype.indexOf.call(U,J,void 0),R;(R=q>=0)&&Array.prototype.splice.call(U,q,1),R&&(a1(J),K.g[W].length==0&&(delete K.g[W],K.h--))}}function e6(K,J,W,U){for(let q=0;q<K.length;++q){let R=K[q];if(!R.da&&R.listener==J&&R.capture==!!W&&R.ha==U)return q}return-1}var a6="closure_lm_"+(Math.random()*1e6|0),h8={};function EZ(K,J,W,U,q){if(U&&U.once)return yZ(K,J,W,U,q);if(Array.isArray(J)){for(let R=0;R<J.length;R++)EZ(K,J[R],W,U,q);return null}return W=K8(W),K&&K[c0]?K.J(J,W,X(U)?!!U.capture:!!U,q):qZ(K,J,W,!1,U,q)}function qZ(K,J,W,U,q,R){if(!J)throw Error("Invalid event type");let C=X(q)?!!q.capture:!!q,l=H8(K);if(l||(K[a6]=l=new Z6(K)),W=l.add(J,W,U,C,R),W.proxy)return W;if(U=dQ(),W.proxy=U,U.src=K,U.listener=W,K.addEventListener)T||(q=C),q===void 0&&(q=!1),K.addEventListener(J.toString(),U,q);else if(K.attachEvent)K.attachEvent(FZ(J.toString()),U);else if(K.addListener&&K.removeListener)K.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return W}function dQ(){function K(W){return J.call(K.src,K.listener,W)}let J=oQ;return K}function yZ(K,J,W,U,q){if(Array.isArray(J)){for(let R=0;R<J.length;R++)yZ(K,J[R],W,U,q);return null}return W=K8(W),K&&K[c0]?K.K(J,W,X(U)?!!U.capture:!!U,q):qZ(K,J,W,!0,U,q)}function TZ(K,J,W,U,q){if(Array.isArray(J))for(var R=0;R<J.length;R++)TZ(K,J[R],W,U,q);else(U=X(U)?!!U.capture:!!U,W=K8(W),K&&K[c0])?(K=K.i,R=String(J).toString(),(R in K.g)&&(J=K.g[R],W=e6(J,W,U,q),W>-1&&(a1(J[W]),Array.prototype.splice.call(J,W,1),J.length==0&&(delete K.g[R],K.h--)))):K&&(K=H8(K))&&(J=K.g[J.toString()],K=-1,J&&(K=e6(J,W,U,q)),(W=K>-1?J[K]:null)&&Z8(W))}function Z8(K){if(typeof K!=="number"&&K&&!K.da){var J=K.src;if(J&&J[c0])b6(J.i,K);else{var{type:W,proxy:U}=K;J.removeEventListener?J.removeEventListener(W,U,K.capture):J.detachEvent?J.detachEvent(FZ(W),U):J.addListener&&J.removeListener&&J.removeListener(U),(W=H8(J))?(b6(W,K),W.h==0&&(W.src=null,J[a6]=null)):a1(K)}}}function FZ(K){return K in h8?h8[K]:h8[K]="on"+K}function oQ(K,J){if(K.da)K=!0;else{J=new E0(J,this);let W=K.listener,U=K.ha||K.src;K.fa&&Z8(K),K=W.call(U,J)}return K}function H8(K){return K=K[a6],K instanceof Z6?K:null}var Q8="__closure_events_fn_"+(Math.random()*1e9>>>0);function K8(K){if(typeof K==="function")return K;return K[Q8]||(K[Q8]=function(J){return K.handleEvent(J)}),K[Q8]}function Y0(){E.call(this),this.i=new Z6(this),this.M=this,this.G=null}F(Y0,E),Y0.prototype[c0]=!0,Y0.prototype.removeEventListener=function(K,J,W,U){TZ(this,K,J,W,U)};function P0(K,J){var W,U=K.G;if(U)for(W=[];U;U=U.G)W.push(U);if(K=K.M,U=J.type||J,typeof J==="string")J=new P(J,K);else if(J instanceof P)J.target=J.target||K;else{var q=J;J=new P(U,K),wZ(J,q)}q=!0;let R,C;if(W)for(C=W.length-1;C>=0;C--)R=J.g=W[C],q=H6(R,U,!0,J)&&q;if(R=J.g=K,q=H6(R,U,!0,J)&&q,q=H6(R,U,!1,J)&&q,W)for(C=0;C<W.length;C++)R=J.g=W[C],q=H6(R,U,!1,J)&&q}Y0.prototype.N=function(){if(Y0.Z.N.call(this),this.i){var K=this.i;for(let J in K.g){let W=K.g[J];for(let U=0;U<W.length;U++)a1(W[U]);delete K.g[J],K.h--}}this.G=null},Y0.prototype.J=function(K,J,W,U){return this.i.add(String(K),J,!1,W,U)},Y0.prototype.K=function(K,J,W,U){return this.i.add(String(K),J,!0,W,U)};function H6(K,J,W,U){if(J=K.i.g[String(J)],!J)return!0;J=J.concat();let q=!0;for(let R=0;R<J.length;++R){let C=J[R];if(C&&!C.da&&C.capture==W){let l=C.listener,K0=C.ha||C.src;C.fa&&b6(K.i,C),q=l.call(K0,U)!==!1&&q}}return q&&!U.defaultPrevented}function nQ(K,J){if(typeof K!=="function")if(K&&typeof K.handleEvent=="function")K=V(K.handleEvent,K);else throw Error("Invalid listener argument");return Number(J)>2147483647?-1:M.setTimeout(K,J||0)}function RZ(K){K.g=nQ(()=>{K.g=null,K.i&&(K.i=!1,RZ(K))},K.l);let J=K.h;K.h=null,K.m.apply(null,J)}class LZ extends E{constructor(K,J){super();this.m=K,this.l=J,this.h=null,this.i=!1,this.g=null}j(K){this.h=arguments,this.g?this.i=!0:RZ(this)}N(){super.N(),this.g&&(M.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Z1(K){E.call(this),this.h=K,this.g={}}F(Z1,E);var NZ=[];function SZ(K){h6(K.g,function(J,W){this.g.hasOwnProperty(W)&&Z8(J)},K),K.g={}}Z1.prototype.N=function(){Z1.Z.N.call(this),SZ(this)},Z1.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var G8=M.JSON.stringify,rQ=M.JSON.parse,cQ=class{stringify(K){return M.JSON.stringify(K,void 0)}parse(K){return M.JSON.parse(K,void 0)}};function CZ(){}function OZ(){}var H1={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $8(){P.call(this,"d")}F($8,P);function J8(){P.call(this,"c")}F(J8,P);var zh={},_Z=null;function Q6(){return _Z=_Z||new Y0}zh.Ia="serverreachability";function AZ(K){P.call(this,zh.Ia,K)}F(AZ,P);function Q1(K){let J=Q6();P0(J,new AZ(J))}zh.STAT_EVENT="statevent";function jZ(K,J){P.call(this,zh.STAT_EVENT,K),this.stat=J}F(jZ,P);function w0(K){let J=Q6();P0(J,new jZ(J,K))}zh.Ja="timingevent";function xZ(K,J){P.call(this,zh.Ja,K),this.size=J}F(xZ,P);function K1(K,J){if(typeof K!=="function")throw Error("Fn must not be null and must be a function");return M.setTimeout(function(){K()},J)}function G1(){this.g=!0}G1.prototype.ua=function(){this.g=!1};function bQ(K,J,W,U,q,R){K.info(function(){if(K.g)if(R){var C="",l=R.split("&");for(let n=0;n<l.length;n++){var K0=l[n].split("=");if(K0.length>1){let M0=K0[0];K0=K0[1];let C0=M0.split("_");C=C0.length>=2&&C0[1]=="type"?C+(M0+"="+K0+"&"):C+(M0+"=redacted&")}}}else C=null;else C=R;return"XMLHTTP REQ ("+U+") [attempt "+q+"]: "+J+`
`+W+`
`+C})}function eQ(K,J,W,U,q,R,C){K.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+q+"]: "+J+`
`+W+`
`+R+" "+C})}function Lh(K,J,W,U){K.info(function(){return"XMLHTTP TEXT ("+J+"): "+hK(K,W)+(U?" "+U:"")})}function aQ(K,J){K.info(function(){return"TIMEOUT: "+J})}G1.prototype.info=function(){};function hK(K,J){if(!K.g)return J;if(!J)return null;try{let R=JSON.parse(J);if(R){for(K=0;K<R.length;K++)if(Array.isArray(R[K])){var W=R[K];if(!(W.length<2)){var U=W[1];if(Array.isArray(U)&&!(U.length<1)){var q=U[0];if(q!="noop"&&q!="stop"&&q!="close")for(let C=1;C<U.length;C++)U[C]=""}}}}return G8(R)}catch(R){return J}}var K6={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},mZ={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},kZ;function M8(){}F(M8,CZ),M8.prototype.g=function(){return new XMLHttpRequest},kZ=new M8;function $1(K){return encodeURIComponent(String(K))}function ZK(K){var J=1;K=K.split(":");let W=[];for(;J>0&&K.length;)W.push(K.shift()),J--;return K.length&&W.push(K.join(":")),W}function b0(K,J,W,U){this.j=K,this.i=J,this.l=W,this.S=U||1,this.V=new Z1(this),this.H=45000,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new vZ}function vZ(){this.i=null,this.g="",this.h=!1}var uZ={},W8={};function X8(K,J,W){K.M=1,K.A=$6(S0(J)),K.u=W,K.R=!0,lZ(K,null)}function lZ(K,J){K.F=Date.now(),G6(K),K.B=S0(K.A);var{B:W,S:U}=K;Array.isArray(U)||(U=[String(U)]),eZ(W.i,"t",U),K.C=0,W=K.j.L,K.h=new vZ,K.g=I4(K.j,W?J:null,!K.u),K.P>0&&(K.O=new LZ(V(K.Y,K,K.g),K.P)),J=K.V,W=K.g,U=K.ba;var q="readystatechange";Array.isArray(q)||(q&&(NZ[0]=q.toString()),q=NZ);for(let R=0;R<q.length;R++){let C=EZ(W,q[R],U||J.handleEvent,!1,J.h||J);if(!C)break;J.g[C.key]=C}J=K.J?DZ(K.J):{},K.u?(K.v||(K.v="POST"),J["Content-Type"]="application/x-www-form-urlencoded",K.g.ea(K.B,K.v,K.u,J)):(K.v="GET",K.g.ea(K.B,K.v,null,J)),Q1(),bQ(K.i,K.v,K.B,K.l,K.S,K.u)}b0.prototype.ba=function(K){K=K.target;let J=this.O;J&&hh(K)==3?J.j():this.Y(K)},b0.prototype.Y=function(K){try{if(K==this.g)h:{let l=hh(this.g),K0=this.g.ya(),n=this.g.ca();if(!(l<3)&&(l!=3||this.g&&(this.h.h||this.g.la()||G4(this.g)))){this.K||l!=4||K0==7||(K0==8||n<=0?Q1(3):Q1(2)),B8(this);var J=this.g.ca();this.X=J;var W=HK(this);if(this.o=J==200,eQ(this.i,this.v,this.B,this.l,this.S,l,J),this.o){if(this.U&&!this.L){Z:{if(this.g){var U,q=this.g;if((U=q.g?q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(U)){var R=U;break Z}}R=null}if(K=R)Lh(this.i,this.l,K,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,U8(this,K);else{this.o=!1,this.m=3,w0(12),Ih(this),J1(this);break h}}if(this.R){K=!0;let M0;for(;!this.K&&this.C<W.length;)if(M0=QK(this,W),M0==W8){l==4&&(this.m=4,w0(14),K=!1),Lh(this.i,this.l,null,"[Incomplete Response]");break}else if(M0==uZ){this.m=4,w0(15),Lh(this.i,this.l,W,"[Invalid Chunk]"),K=!1;break}else Lh(this.i,this.l,M0,null),U8(this,M0);if(sZ(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),l!=4||W.length!=0||this.h.h||(this.m=1,w0(16),K=!1),this.o=this.o&&K,!K)Lh(this.i,this.l,W,"[Invalid Chunked Response]"),Ih(this),J1(this);else if(W.length>0&&!this.W){this.W=!0;var C=this.j;C.g==this&&C.aa&&!C.P&&(C.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),w8(C),C.P=!0,w0(11))}}else Lh(this.i,this.l,W,null),U8(this,W);l==4&&Ih(this),this.o&&!this.K&&(l==4?U4(this.j,this):(this.o=!1,G6(this)))}else DK(this.g),J==400&&W.indexOf("Unknown SID")>0?(this.m=3,w0(12)):(this.m=0,w0(13)),Ih(this),J1(this)}}}catch(l){}finally{}};function HK(K){if(!sZ(K))return K.g.la();let J=G4(K.g);if(J==="")return"";let W="",U=J.length,q=hh(K.g)==4;if(!K.h.i){if(typeof TextDecoder>"u")return Ih(K),J1(K),"";K.h.i=new M.TextDecoder}for(let R=0;R<U;R++)K.h.h=!0,W+=K.h.i.decode(J[R],{stream:!(q&&R==U-1)});return J.length=0,K.h.g+=W,K.C=0,K.h.g}function sZ(K){return K.g?K.v=="GET"&&K.M!=2&&K.j.Aa:!1}function QK(K,J){var W=K.C,U=J.indexOf(`
`,W);if(U==-1)return W8;if(W=Number(J.substring(W,U)),isNaN(W))return uZ;if(U+=1,U+W>J.length)return W8;return J=J.slice(U,U+W),K.C=U+W,J}b0.prototype.cancel=function(){this.K=!0,Ih(this)};function G6(K){K.T=Date.now()+K.H,iZ(K,K.H)}function iZ(K,J){if(K.D!=null)throw Error("WatchDog timer not null");K.D=K1(V(K.aa,K),J)}function B8(K){K.D&&(M.clearTimeout(K.D),K.D=null)}b0.prototype.aa=function(){this.D=null;let K=Date.now();K-this.T>=0?(aQ(this.i,this.B),this.M!=2&&(Q1(),w0(17)),Ih(this),this.m=2,J1(this)):iZ(this,this.T-K)};function J1(K){K.j.I==0||K.K||U4(K.j,K)}function Ih(K){B8(K);var J=K.O;J&&typeof J.dispose=="function"&&J.dispose(),K.O=null,SZ(K.V),K.g&&(J=K.g,K.g=null,J.abort(),J.dispose())}function U8(K,J){try{var W=K.j;if(W.I!=0&&(W.g==K||V8(W.h,K))){if(!K.L&&V8(W.h,K)&&W.I==3){try{var U=W.Ba.g.parse(J)}catch(n){U=null}if(Array.isArray(U)&&U.length==3){var q=U;if(q[0]==0)h:if(!W.v){if(W.g)if(W.g.F+3000<K.F)U6(W),X6(W);else break h;P8(W),w0(18)}else W.xa=q[1],0<W.xa-W.K&&q[2]<37500&&W.F&&W.A==0&&!W.C&&(W.C=K1(V(W.Va,W),6000));tZ(W.h)<=1&&W.ta&&(W.ta=void 0)}else Ph(W,11)}else if((K.L||W.g==K)&&U6(W),!z(J))for(q=W.Ba.g.parse(J),J=0;J<q.length;J++){let n=q[J],M0=n[0];if(!(M0<=W.K))if(W.K=M0,n=n[1],W.I==2)if(n[0]=="c"){W.M=n[1],W.ba=n[2];let C0=n[3];C0!=null&&(W.ka=C0,W.j.info("VER="+W.ka));let wh=n[4];wh!=null&&(W.za=wh,W.j.info("SVER="+W.za));let Zh=n[5];Zh!=null&&typeof Zh==="number"&&Zh>0&&(U=1.5*Zh,W.O=U,W.j.info("backChannelRequestTimeoutMs_="+U)),U=W;let Hh=K.g;if(Hh){let Y6=Hh.g?Hh.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Y6){var R=U.h;R.g||Y6.indexOf("spdy")==-1&&Y6.indexOf("quic")==-1&&Y6.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(Y8(R,R.h),R.h=null))}if(U.G){let E8=Hh.g?Hh.g.getResponseHeader("X-HTTP-Session-Id"):null;E8&&(U.wa=E8,c(U.J,U.G,E8))}}W.I=3,W.l&&W.l.ra(),W.aa&&(W.T=Date.now()-K.F,W.j.info("Handshake RTT: "+W.T+"ms")),U=W;var C=K;if(U.na=z4(U,U.L?U.ba:null,U.W),C.L){pZ(U.h,C);var l=C,K0=U.O;K0&&(l.H=K0),l.D&&(B8(l),G6(l)),U.g=C}else X4(U);W.i.length>0&&B6(W)}else n[0]!="stop"&&n[0]!="close"||Ph(W,7);else W.I==3&&(n[0]=="stop"||n[0]=="close"?n[0]=="stop"?Ph(W,7):D8(W):n[0]!="noop"&&W.l&&W.l.qa(n),W.A=0)}}Q1(4)}catch(n){}}var KK=class{constructor(K,J){this.g=K,this.map=J}};function fZ(K){this.l=K||10,M.PerformanceNavigationTiming?(K=M.performance.getEntriesByType("navigation"),K=K.length>0&&(K[0].nextHopProtocol=="hq"||K[0].nextHopProtocol=="h2")):K=!!(M.chrome&&M.chrome.loadTimes&&M.chrome.loadTimes()&&M.chrome.loadTimes().wasFetchedViaSpdy),this.j=K?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function gZ(K){return K.h?!0:K.g?K.g.size>=K.j:!1}function tZ(K){return K.h?1:K.g?K.g.size:0}function V8(K,J){return K.h?K.h==J:K.g?K.g.has(J):!1}function Y8(K,J){K.g?K.g.add(J):K.h=J}function pZ(K,J){K.h&&K.h==J?K.h=null:K.g&&K.g.has(J)&&K.g.delete(J)}fZ.prototype.cancel=function(){if(this.i=dZ(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let K of this.g.values())K.cancel();this.g.clear()}};function dZ(K){if(K.h!=null)return K.i.concat(K.h.G);if(K.g!=null&&K.g.size!==0){let J=K.i;for(let W of K.g.values())J=J.concat(W.G);return J}return S(K.i)}var oZ=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function GK(K,J){if(K){K=K.split("&");for(let W=0;W<K.length;W++){let U=K[W].indexOf("="),q,R=null;U>=0?(q=K[W].substring(0,U),R=K[W].substring(U+1)):q=K[W],J(q,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function e0(K){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let J;K instanceof e0?(this.l=K.l,M1(this,K.j),this.o=K.o,this.g=K.g,W1(this,K.u),this.h=K.h,z8(this,aZ(K.i)),this.m=K.m):K&&(J=String(K).match(oZ))?(this.l=!1,M1(this,J[1]||"",!0),this.o=X1(J[2]||""),this.g=X1(J[3]||"",!0),W1(this,J[4]),this.h=X1(J[5]||"",!0),z8(this,J[6]||"",!0),this.m=X1(J[7]||"")):(this.l=!1,this.i=new U1(null,this.l))}e0.prototype.toString=function(){let K=[];var J=this.j;J&&K.push(B1(J,nZ,!0),":");var W=this.g;if(W||J=="file")K.push("//"),(J=this.o)&&K.push(B1(J,nZ,!0),"@"),K.push($1(W).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),W=this.u,W!=null&&K.push(":",String(W));if(W=this.h)this.g&&W.charAt(0)!="/"&&K.push("/"),K.push(B1(W,W.charAt(0)=="/"?MK:JK,!0));return(W=this.i.toString())&&K.push("?",W),(W=this.m)&&K.push("#",B1(W,XK)),K.join("")},e0.prototype.resolve=function(K){let J=S0(this),W=!!K.j;W?M1(J,K.j):W=!!K.o,W?J.o=K.o:W=!!K.g,W?J.g=K.g:W=K.u!=null;var U=K.h;if(W)W1(J,K.u);else if(W=!!K.h){if(U.charAt(0)!="/")if(this.g&&!this.h)U="/"+U;else{var q=J.h.lastIndexOf("/");q!=-1&&(U=J.h.slice(0,q+1)+U)}if(q=U,q==".."||q==".")U="";else if(q.indexOf("./")!=-1||q.indexOf("/.")!=-1){U=q.lastIndexOf("/",0)==0,q=q.split("/");let R=[];for(let C=0;C<q.length;){let l=q[C++];l=="."?U&&C==q.length&&R.push(""):l==".."?((R.length>1||R.length==1&&R[0]!="")&&R.pop(),U&&C==q.length&&R.push("")):(R.push(l),U=!0)}U=R.join("/")}else U=q}return W?J.h=U:W=K.i.toString()!=="",W?z8(J,aZ(K.i)):W=!!K.m,W&&(J.m=K.m),J};function S0(K){return new e0(K)}function M1(K,J,W){K.j=W?X1(J,!0):J,K.j&&(K.j=K.j.replace(/:$/,""))}function W1(K,J){if(J){if(J=Number(J),isNaN(J)||J<0)throw Error("Bad port number "+J);K.u=J}else K.u=null}function z8(K,J,W){J instanceof U1?(K.i=J,BK(K.i,K.l)):(W||(J=B1(J,WK)),K.i=new U1(J,K.l))}function c(K,J,W){K.i.set(J,W)}function $6(K){return c(K,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),K}function X1(K,J){return K?J?decodeURI(K.replace(/%25/g,"%2525")):decodeURIComponent(K):""}function B1(K,J,W){return typeof K==="string"?(K=encodeURI(K).replace(J,$K),W&&(K=K.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),K):null}function $K(K){return K=K.charCodeAt(0),"%"+(K>>4&15).toString(16)+(K&15).toString(16)}var nZ=/[#\/\?@]/g,JK=/[#\?:]/g,MK=/[#\?]/g,WK=/[#\?@]/g,XK=/#/g;function U1(K,J){this.h=this.g=null,this.i=K||null,this.j=!!J}function Dh(K){K.g||(K.g=new Map,K.h=0,K.i&&GK(K.i,function(J,W){K.add(decodeURIComponent(J.replace(/\+/g," ")),W)}))}h=U1.prototype,h.add=function(K,J){Dh(this),this.i=null,K=Nh(this,K);let W=this.g.get(K);return W||this.g.set(K,W=[]),W.push(J),this.h+=1,this};function rZ(K,J){Dh(K),J=Nh(K,J),K.g.has(J)&&(K.i=null,K.h-=K.g.get(J).length,K.g.delete(J))}function cZ(K,J){return Dh(K),J=Nh(K,J),K.g.has(J)}h.forEach=function(K,J){Dh(this),this.g.forEach(function(W,U){W.forEach(function(q){K.call(J,q,U,this)},this)},this)};function bZ(K,J){Dh(K);let W=[];if(typeof J==="string")cZ(K,J)&&(W=W.concat(K.g.get(Nh(K,J))));else for(K=Array.from(K.g.values()),J=0;J<K.length;J++)W=W.concat(K[J]);return W}h.set=function(K,J){return Dh(this),this.i=null,K=Nh(this,K),cZ(this,K)&&(this.h-=this.g.get(K).length),this.g.set(K,[J]),this.h+=1,this},h.get=function(K,J){if(!K)return J;return K=bZ(this,K),K.length>0?String(K[0]):J};function eZ(K,J,W){rZ(K,J),W.length>0&&(K.i=null,K.g.set(Nh(K,J),S(W)),K.h+=W.length)}h.toString=function(){if(this.i)return this.i;if(!this.g)return"";let K=[],J=Array.from(this.g.keys());for(let U=0;U<J.length;U++){var W=J[U];let q=$1(W);W=bZ(this,W);for(let R=0;R<W.length;R++){let C=q;W[R]!==""&&(C+="="+$1(W[R])),K.push(C)}}return this.i=K.join("&")};function aZ(K){let J=new U1;return J.i=K.i,K.g&&(J.g=new Map(K.g),J.h=K.h),J}function Nh(K,J){return J=String(J),K.j&&(J=J.toLowerCase()),J}function BK(K,J){J&&!K.j&&(Dh(K),K.i=null,K.g.forEach(function(W,U){let q=U.toLowerCase();U!=q&&(rZ(this,U),eZ(this,q,W))},K)),K.j=J}function UK(K,J){let W=new G1;if(M.Image){let U=new Image;U.onload=D(a0,W,"TestLoadImage: loaded",!0,J,U),U.onerror=D(a0,W,"TestLoadImage: error",!1,J,U),U.onabort=D(a0,W,"TestLoadImage: abort",!1,J,U),U.ontimeout=D(a0,W,"TestLoadImage: timeout",!1,J,U),M.setTimeout(function(){if(U.ontimeout)U.ontimeout()},1e4),U.src=K}else J(!1)}function VK(K,J){let W=new G1,U=new AbortController,q=setTimeout(()=>{U.abort(),a0(W,"TestPingServer: timeout",!1,J)},1e4);fetch(K,{signal:U.signal}).then((R)=>{clearTimeout(q),R.ok?a0(W,"TestPingServer: ok",!0,J):a0(W,"TestPingServer: server error",!1,J)}).catch(()=>{clearTimeout(q),a0(W,"TestPingServer: error",!1,J)})}function a0(K,J,W,U,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),U(W)}catch(R){}}function YK(){this.g=new cQ}function J6(K){this.i=K.Sb||null,this.h=K.ab||!1}F(J6,CZ),J6.prototype.g=function(){return new M6(this.i,this.h)};function M6(K,J){Y0.call(this),this.H=K,this.o=J,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}F(M6,Y0),h=M6.prototype,h.open=function(K,J){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=K,this.D=J,this.readyState=1,Y1(this)},h.send=function(K){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let J={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};K&&(J.body=K),(this.H||M).fetch(new Request(this.D,J)).then(this.Pa.bind(this),this.ga.bind(this))},h.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,V1(this)),this.readyState=0},h.Pa=function(K){if(this.g&&(this.l=K,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=K.headers,this.readyState=2,Y1(this)),this.g&&(this.readyState=3,Y1(this),this.g)))if(this.responseType==="arraybuffer")K.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof M.ReadableStream<"u"&&"body"in K){if(this.j=K.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;h4(this)}else K.text().then(this.Oa.bind(this),this.ga.bind(this))};function h4(K){K.j.read().then(K.Ma.bind(K)).catch(K.ga.bind(K))}h.Ma=function(K){if(this.g){if(this.o&&K.value)this.response.push(K.value);else if(!this.o){var J=K.value?K.value:new Uint8Array(0);if(J=this.B.decode(J,{stream:!K.done}))this.response=this.responseText+=J}K.done?V1(this):Y1(this),this.readyState==3&&h4(this)}},h.Oa=function(K){this.g&&(this.response=this.responseText=K,V1(this))},h.Na=function(K){this.g&&(this.response=K,V1(this))},h.ga=function(){this.g&&V1(this)};function V1(K){K.readyState=4,K.l=null,K.j=null,K.B=null,Y1(K)}h.setRequestHeader=function(K,J){this.A.append(K,J)},h.getResponseHeader=function(K){return this.h?this.h.get(K.toLowerCase())||"":""},h.getAllResponseHeaders=function(){if(!this.h)return"";let K=[],J=this.h.entries();for(var W=J.next();!W.done;)W=W.value,K.push(W[0]+": "+W[1]),W=J.next();return K.join(`\r
`)};function Y1(K){K.onreadystatechange&&K.onreadystatechange.call(K)}Object.defineProperty(M6.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(K){this.m=K?"include":"same-origin"}});function Z4(K){let J="";return h6(K,function(W,U){J+=U,J+=":",J+=W,J+=`\r
`}),J}function I8(K,J,W){h:{for(U in W){var U=!1;break h}U=!0}U||(W=Z4(W),typeof K==="string"?W!=null&&$1(W):c(K,J,W))}function h0(K){Y0.call(this),this.headers=new Map,this.L=K||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}F(h0,Y0);var zK=/^https?$/i,IK=["POST","PUT"];h=h0.prototype,h.Fa=function(K){this.H=K},h.ea=function(K,J,W,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+K);J=J?J.toUpperCase():"GET",this.D=K,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():kZ.g(),this.g.onreadystatechange=y(V(this.Ca,this));try{this.B=!0,this.g.open(J,String(K),!0),this.B=!1}catch(R){H4(this,R);return}if(K=W||"",W=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var q in U)W.set(q,U[q]);else if(typeof U.keys==="function"&&typeof U.get==="function")for(let R of U.keys())W.set(R,U.get(R));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(W.keys()).find((R)=>R.toLowerCase()=="content-type"),q=M.FormData&&K instanceof M.FormData,!(Array.prototype.indexOf.call(IK,J,void 0)>=0)||U||q||W.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[R,C]of W)this.g.setRequestHeader(R,C);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(K),this.v=!1}catch(R){H4(this,R)}};function H4(K,J){K.h=!1,K.g&&(K.j=!0,K.g.abort(),K.j=!1),K.l=J,K.o=5,Q4(K),W6(K)}function Q4(K){K.A||(K.A=!0,P0(K,"complete"),P0(K,"error"))}h.abort=function(K){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=K||7,P0(this,"complete"),P0(this,"abort"),W6(this))},h.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),W6(this,!0)),h0.Z.N.call(this)},h.Ca=function(){this.u||(this.B||this.v||this.j?K4(this):this.Xa())},h.Xa=function(){K4(this)};function K4(K){if(K.h&&typeof $<"u"){if(K.v&&hh(K)==4)setTimeout(K.Ca.bind(K),0);else if(P0(K,"readystatechange"),hh(K)==4){K.h=!1;try{let R=K.ca();h:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var J=!0;break h;default:J=!1}var W;if(!(W=J)){var U;if(U=R===0){let C=String(K.D).match(oZ)[1]||null;!C&&M.self&&M.self.location&&(C=M.self.location.protocol.slice(0,-1)),U=!zK.test(C?C.toLowerCase():"")}W=U}if(W)P0(K,"complete"),P0(K,"success");else{K.o=6;try{var q=hh(K)>2?K.g.statusText:""}catch(C){q=""}K.l=q+" ["+K.ca()+"]",Q4(K)}}finally{W6(K)}}}}function W6(K,J){if(K.g){K.m&&(clearTimeout(K.m),K.m=null);let W=K.g;K.g=null,J||P0(K,"ready");try{W.onreadystatechange=null}catch(U){}}}h.isActive=function(){return!!this.g};function hh(K){return K.g?K.g.readyState:0}h.ca=function(){try{return hh(this)>2?this.g.status:-1}catch(K){return-1}},h.la=function(){try{return this.g?this.g.responseText:""}catch(K){return""}},h.La=function(K){if(this.g){var J=this.g.responseText;return K&&J.indexOf(K)==0&&(J=J.substring(K.length)),rQ(J)}};function G4(K){try{if(!K.g)return null;if("response"in K.g)return K.g.response;switch(K.F){case"":case"text":return K.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in K.g)return K.g.mozResponseArrayBuffer}return null}catch(J){return null}}function DK(K){let J={};K=(K.g&&hh(K)>=2?K.g.getAllResponseHeaders()||"":"").split(`\r
`);for(let U=0;U<K.length;U++){if(z(K[U]))continue;var W=ZK(K[U]);let q=W[0];if(W=W[1],typeof W!=="string")continue;W=W.trim();let R=J[q]||[];J[q]=R,R.push(W)}pQ(J,function(U){return U.join(", ")})}h.ya=function(){return this.o},h.Ha=function(){return typeof this.l==="string"?this.l:String(this.l)};function z1(K,J,W){return W&&W.internalChannelParams?W.internalChannelParams[K]||J:J}function $4(K){this.za=0,this.i=[],this.j=new G1,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=z1("failFast",!1,K),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=z1("baseRetryDelayMs",5000,K),this.Za=z1("retryDelaySeedMs",1e4,K),this.Ta=z1("forwardChannelMaxRetries",2,K),this.va=z1("forwardChannelRequestTimeoutMs",20000,K),this.ma=K&&K.xmlHttpFactory||void 0,this.Ua=K&&K.Rb||void 0,this.Aa=K&&K.useFetchStreams||!1,this.O=void 0,this.L=K&&K.supportsCrossDomainXhr||!1,this.M="",this.h=new fZ(K&&K.concurrentRequestLimit),this.Ba=new YK,this.S=K&&K.fastHandshake||!1,this.R=K&&K.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=K&&K.Pb||!1,K&&K.ua&&this.j.ua(),K&&K.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&K&&K.detectBufferingProxy||!1,this.ia=void 0,K&&K.longPollingTimeout&&K.longPollingTimeout>0&&(this.ia=K.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}h=$4.prototype,h.ka=8,h.I=1,h.connect=function(K,J,W,U){w0(0),this.W=K,this.H=J||{},W&&U!==void 0&&(this.H.OSID=W,this.H.OAID=U),this.F=this.X,this.J=z4(this,null,this.W),B6(this)};function D8(K){if(J4(K),K.I==3){var J=K.V++,W=S0(K.J);if(c(W,"SID",K.M),c(W,"RID",J),c(W,"TYPE","terminate"),I1(K,W),J=new b0(K,K.j,J),J.M=2,J.A=$6(S0(W)),W=!1,M.navigator&&M.navigator.sendBeacon)try{W=M.navigator.sendBeacon(J.A.toString(),"")}catch(U){}!W&&M.Image&&(new Image().src=J.A,W=!0),W||(J.g=I4(J.j,null),J.g.ea(J.A)),J.F=Date.now(),G6(J)}Y4(K)}function X6(K){K.g&&(w8(K),K.g.cancel(),K.g=null)}function J4(K){X6(K),K.v&&(M.clearTimeout(K.v),K.v=null),U6(K),K.h.cancel(),K.m&&(typeof K.m==="number"&&M.clearTimeout(K.m),K.m=null)}function B6(K){if(!gZ(K.h)&&!K.m){K.m=!0;var J=K.Ea;T0||Y(),V0||(T0(),V0=!0),w.add(J,K),K.D=0}}function PK(K,J){if(tZ(K.h)>=K.h.j-(K.m?1:0))return!1;if(K.m)return K.i=J.G.concat(K.i),!0;if(K.I==1||K.I==2||K.D>=(K.Sa?0:K.Ta))return!1;return K.m=K1(V(K.Ea,K,J),V4(K,K.D)),K.D++,!0}h.Ea=function(K){if(this.m)if(this.m=null,this.I==1){if(!K){this.V=Math.floor(Math.random()*1e5),K=this.V++;let q=new b0(this,this.j,K),R=this.o;if(this.U&&(R?(R=DZ(R),wZ(R,this.U)):R=this.U),this.u!==null||this.R||(q.J=R,R=null),this.S)h:{var J=0;for(var W=0;W<this.i.length;W++){Z:{var U=this.i[W];if("__data__"in U.map&&(U=U.map.__data__,typeof U==="string")){U=U.length;break Z}U=void 0}if(U===void 0)break;if(J+=U,J>4096){J=W;break h}if(J===4096||W===this.i.length-1){J=W+1;break h}}J=1000}else J=1000;J=W4(this,q,J),W=S0(this.J),c(W,"RID",K),c(W,"CVER",22),this.G&&c(W,"X-HTTP-Session-Id",this.G),I1(this,W),R&&(this.R?J="headers="+$1(Z4(R))+"&"+J:this.u&&I8(W,this.u,R)),Y8(this.h,q),this.Ra&&c(W,"TYPE","init"),this.S?(c(W,"$req",J),c(W,"SID","null"),q.U=!0,X8(q,W,null)):X8(q,W,J),this.I=2}}else this.I==3&&(K?M4(this,K):this.i.length==0||gZ(this.h)||M4(this))};function M4(K,J){var W;J?W=J.l:W=K.V++;let U=S0(K.J);c(U,"SID",K.M),c(U,"RID",W),c(U,"AID",K.K),I1(K,U),K.u&&K.o&&I8(U,K.u,K.o),W=new b0(K,K.j,W,K.D+1),K.u===null&&(W.J=K.o),J&&(K.i=J.G.concat(K.i)),J=W4(K,W,1000),W.H=Math.round(K.va*0.5)+Math.round(K.va*0.5*Math.random()),Y8(K.h,W),X8(W,U,J)}function I1(K,J){K.H&&h6(K.H,function(W,U){c(J,U,W)}),K.l&&h6({},function(W,U){c(J,U,W)})}function W4(K,J,W){W=Math.min(K.i.length,W);let U=K.l?V(K.l.Ka,K.l,K):null;h:{var q=K.i;let l=-1;for(;;){let K0=["count="+W];l==-1?W>0?(l=q[0].g,K0.push("ofs="+l)):l=0:K0.push("ofs="+l);let n=!0;for(let M0=0;M0<W;M0++){var R=q[M0].g;let C0=q[M0].map;if(R-=l,R<0)l=Math.max(0,q[M0].g-100),n=!1;else try{R="req"+R+"_"||"";try{var C=C0 instanceof Map?C0:Object.entries(C0);for(let[wh,Zh]of C){let Hh=Zh;X(Zh)&&(Hh=G8(Zh)),K0.push(R+wh+"="+encodeURIComponent(Hh))}}catch(wh){throw K0.push(R+"type="+encodeURIComponent("_badmap")),wh}}catch(wh){U&&U(C0)}}if(n){C=K0.join("&");break h}}C=void 0}return K=K.i.splice(0,W),J.G=K,C}function X4(K){if(!K.g&&!K.v){K.Y=1;var J=K.Da;T0||Y(),V0||(T0(),V0=!0),w.add(J,K),K.A=0}}function P8(K){if(K.g||K.v||K.A>=3)return!1;return K.Y++,K.v=K1(V(K.Da,K),V4(K,K.A)),K.A++,!0}h.Da=function(){if(this.v=null,B4(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var K=4*this.T;this.j.info("BP detection timer enabled: "+K),this.B=K1(V(this.Wa,this),K)}},h.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,w0(10),X6(this),B4(this))};function w8(K){K.B!=null&&(M.clearTimeout(K.B),K.B=null)}function B4(K){K.g=new b0(K,K.j,"rpc",K.Y),K.u===null&&(K.g.J=K.o),K.g.P=0;var J=S0(K.na);c(J,"RID","rpc"),c(J,"SID",K.M),c(J,"AID",K.K),c(J,"CI",K.F?"0":"1"),!K.F&&K.ia&&c(J,"TO",K.ia),c(J,"TYPE","xmlhttp"),I1(K,J),K.u&&K.o&&I8(J,K.u,K.o),K.O&&(K.g.H=K.O);var W=K.g;K=K.ba,W.M=1,W.A=$6(S0(J)),W.u=null,W.R=!0,lZ(W,K)}h.Va=function(){this.C!=null&&(this.C=null,X6(this),P8(this),w0(19))};function U6(K){K.C!=null&&(M.clearTimeout(K.C),K.C=null)}function U4(K,J){var W=null;if(K.g==J){U6(K),w8(K),K.g=null;var U=2}else if(V8(K.h,J))W=J.G,pZ(K.h,J),U=1;else return;if(K.I!=0){if(J.o)if(U==1){W=J.u?J.u.length:0,J=Date.now()-J.F;var q=K.D;U=Q6(),P0(U,new xZ(U,W)),B6(K)}else X4(K);else if(q=J.m,q==3||q==0&&J.X>0||!(U==1&&PK(K,J)||U==2&&P8(K)))switch(W&&W.length>0&&(J=K.h,J.i=J.i.concat(W)),q){case 1:Ph(K,5);break;case 4:Ph(K,10);break;case 3:Ph(K,6);break;default:Ph(K,2)}}}function V4(K,J){let W=K.Qa+Math.floor(Math.random()*K.Za);return K.isActive()||(W*=2),W*J}function Ph(K,J){if(K.j.info("Error code "+J),J==2){var W=V(K.bb,K),U=K.Ua;let q=!U;U=new e0(U||"//www.google.com/images/cleardot.gif"),M.location&&M.location.protocol=="http"||M1(U,"https"),$6(U),q?UK(U.toString(),W):VK(U.toString(),W)}else w0(2);K.I=0,K.l&&K.l.pa(J),Y4(K),J4(K)}h.bb=function(K){K?(this.j.info("Successfully pinged google.com"),w0(2)):(this.j.info("Failed to ping google.com"),w0(1))};function Y4(K){if(K.I=0,K.ja=[],K.l){let J=dZ(K.h);if(J.length!=0||K.i.length!=0)j(K.ja,J),j(K.ja,K.i),K.h.i.length=0,S(K.i),K.i.length=0;K.l.oa()}}function z4(K,J,W){var U=W instanceof e0?S0(W):new e0(W);if(U.g!="")J&&(U.g=J+"."+U.g),W1(U,U.u);else{var q=M.location;U=q.protocol,J=J?J+"."+q.hostname:q.hostname,q=+q.port;let R=new e0(null);U&&M1(R,U),J&&(R.g=J),q&&W1(R,q),W&&(R.h=W),U=R}return W=K.G,J=K.wa,W&&J&&c(U,W,J),c(U,"VER",K.ka),I1(K,U),U}function I4(K,J,W){if(J&&!K.L)throw Error("Can't create secondary domain capable XhrIo object.");return J=K.Aa&&!K.ma?new h0(new J6({ab:W})):new h0(K.ma),J.Fa(K.L),J}h.isActive=function(){return!!this.l&&this.l.isActive(this)};function D4(){}h=D4.prototype,h.ra=function(){},h.qa=function(){},h.pa=function(){},h.oa=function(){},h.isActive=function(){return!0},h.Ka=function(){};function V6(){}V6.prototype.g=function(K,J){return new F0(K,J)};function F0(K,J){Y0.call(this),this.g=new $4(J),this.l=K,this.h=J&&J.messageUrlParams||null,K=J&&J.messageHeaders||null,J&&J.clientProtocolHeaderRequired&&(K?K["X-Client-Protocol"]="webchannel":K={"X-Client-Protocol":"webchannel"}),this.g.o=K,K=J&&J.initMessageHeaders||null,J&&J.messageContentType&&(K?K["X-WebChannel-Content-Type"]=J.messageContentType:K={"X-WebChannel-Content-Type":J.messageContentType}),J&&J.sa&&(K?K["X-WebChannel-Client-Profile"]=J.sa:K={"X-WebChannel-Client-Profile":J.sa}),this.g.U=K,(K=J&&J.Qb)&&!z(K)&&(this.g.u=K),this.A=J&&J.supportsCrossDomainXhr||!1,this.v=J&&J.sendRawJson||!1,(J=J&&J.httpSessionIdParam)&&!z(J)&&(this.g.G=J,K=this.h,K!==null&&(J in K)&&(K=this.h,(J in K)&&delete K[J])),this.j=new Sh(this)}F(F0,Y0),F0.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},F0.prototype.close=function(){D8(this.g)},F0.prototype.o=function(K){var J=this.g;if(typeof K==="string"){var W={};W.__data__=K,K=W}else this.v&&(W={},W.__data__=G8(K),K=W);J.i.push(new KK(J.Ya++,K)),J.I==3&&B6(J)},F0.prototype.N=function(){this.g.l=null,delete this.j,D8(this.g),delete this.g,F0.Z.N.call(this)};function P4(K){$8.call(this),K.__headers__&&(this.headers=K.__headers__,this.statusCode=K.__status__,delete K.__headers__,delete K.__status__);var J=K.__sm__;if(J){h:{for(let W in J){K=W;break h}K=void 0}if(this.i=K)K=this.i,J=J!==null&&K in J?J[K]:void 0;this.data=J}else this.data=K}F(P4,$8);function w4(){J8.call(this),this.status=1}F(w4,J8);function Sh(K){this.g=K}F(Sh,D4),Sh.prototype.ra=function(){P0(this.g,"a")},Sh.prototype.qa=function(K){P0(this.g,new P4(K))},Sh.prototype.pa=function(K){P0(this.g,new w4)},Sh.prototype.oa=function(){P0(this.g,"b")},V6.prototype.createWebChannel=V6.prototype.g,F0.prototype.send=F0.prototype.o,F0.prototype.open=F0.prototype.m,F0.prototype.close=F0.prototype.close,g8=g0.createWebChannelTransport=function(){return new V6},f8=g0.getStatEventTarget=function(){return Q6()},i8=g0.Event=zh,E6=g0.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},K6.NO_ERROR=0,K6.TIMEOUT=8,K6.HTTP_ERROR=6,y1=g0.ErrorCode=K6,mZ.COMPLETE="complete",s8=g0.EventType=mZ,OZ.EventType=H1,H1.OPEN="a",H1.CLOSE="b",H1.ERROR="c",H1.MESSAGE="d",Y0.prototype.listen=Y0.prototype.J,Oh=g0.WebChannel=OZ,xG=g0.FetchXmlHttpFactory=J6,h0.prototype.listenOnce=h0.prototype.K,h0.prototype.getLastError=h0.prototype.Ha,h0.prototype.getLastErrorCode=h0.prototype.ya,h0.prototype.getStatus=h0.prototype.ca,h0.prototype.getResponseJson=h0.prototype.La,h0.prototype.getResponseText=h0.prototype.la,h0.prototype.send=h0.prototype.ea,h0.prototype.setWithCredentials=h0.prototype.Fa,l8=g0.XhrIo=h0}).apply(typeof w6<"u"?w6:typeof self<"u"?self:typeof window<"u"?window:{});var J5="@firebase/firestore",M5="4.9.3";class W0{constructor(h){this.uid=h}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(h){return h.uid===this.uid}}W0.UNAUTHENTICATED=new W0(null),W0.GOOGLE_CREDENTIALS=new W0("google-credentials-uid"),W0.FIRST_PARTY=new W0("first-party-uid"),W0.MOCK_USER=new W0("mock-user");var ch="12.7.0",yh=new w1("@firebase/firestore");function _h(){return yh.logLevel}function A(h,...Z){if(yh.logLevel<=f.DEBUG){let H=Z.map(w9);yh.debug(`Firestore (${ch}): ${h}`,...H)}}function p0(h,...Z){if(yh.logLevel<=f.ERROR){let H=Z.map(w9);yh.error(`Firestore (${ch}): ${h}`,...H)}}function lh(h,...Z){if(yh.logLevel<=f.WARN){let H=Z.map(w9);yh.warn(`Firestore (${ch}): ${h}`,...H)}}function w9(h){if(typeof h=="string")return h;try{return function(H){return JSON.stringify(H)}(h)}catch(Z){return h}}function k(h,Z,H){let Q="Unexpected state";typeof Z=="string"?Q=Z:H=Z,b5(h,Q,H)}function b5(h,Z,H){let Q=`FIRESTORE (${ch}) INTERNAL ASSERTION FAILED: ${Z} (ID: ${h.toString(16)})`;if(H!==void 0)try{Q+=" CONTEXT: "+JSON.stringify(H)}catch(G){Q+=" CONTEXT: "+H}throw p0(Q),Error(Q)}function d(h,Z,H,Q){let G="Unexpected state";typeof H=="string"?G=H:Q=H,h||b5(Z,G,Q)}function u(h,Z){return h}var L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class O extends s0{constructor(h,Z){super(h,Z),this.code=h,this.message=Z,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class t0{constructor(){this.promise=new Promise((h,Z)=>{this.resolve=h,this.reject=Z})}}class E9{constructor(h,Z){this.user=Z,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${h}`)}}class e5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(h,Z){h.enqueueRetryable(()=>Z(W0.UNAUTHENTICATED))}shutdown(){}}class a5{constructor(h){this.token=h,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(h,Z){this.changeListener=Z,h.enqueueRetryable(()=>Z(this.token.user))}shutdown(){this.changeListener=null}}class h7{constructor(h){this.t=h,this.currentUser=W0.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(h,Z){d(this.o===void 0,42304);let H=this.i,Q=(X)=>this.i!==H?(H=this.i,Z(X)):Promise.resolve(),G=new t0;this.o=()=>{this.i++,this.currentUser=this.u(),G.resolve(),G=new t0,h.enqueueRetryable(()=>Q(this.currentUser))};let $=()=>{let X=G;h.enqueueRetryable(async()=>{await X.promise,await Q(this.currentUser)})},M=(X)=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=X,this.o&&(this.auth.addAuthTokenListener(this.o),$())};this.t.onInit((X)=>M(X)),setTimeout(()=>{if(!this.auth){let X=this.t.getImmediate({optional:!0});X?M(X):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),G.resolve(),G=new t0)}},0),$()}getToken(){let h=this.i,Z=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(Z).then((H)=>this.i!==h?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):H?(d(typeof H.accessToken=="string",31837,{l:H}),new E9(H.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let h=this.auth&&this.auth.getUid();return d(h===null||typeof h=="string",2055,{h}),new W0(h)}}class Z7{constructor(h,Z,H){this.P=h,this.T=Z,this.I=H,this.type="FirstParty",this.user=W0.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let h=this.R();return h&&this.A.set("Authorization",h),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class H7{constructor(h,Z,H){this.P=h,this.T=Z,this.I=H}getToken(){return Promise.resolve(new Z7(this.P,this.T,this.I))}start(h,Z){h.enqueueRetryable(()=>Z(W0.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class r8{constructor(h){this.value=h,this.type="AppCheck",this.headers=new Map,h&&h.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Q7{constructor(h,Z){this.V=Z,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,b4(h)&&h.settings.appCheckToken&&(this.p=h.settings.appCheckToken)}start(h,Z){d(this.o===void 0,3512);let H=(G)=>{G.error!=null&&A("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${G.error.message}`);let $=G.token!==this.m;return this.m=G.token,A("FirebaseAppCheckTokenProvider",`Received ${$?"new":"existing"} token.`),$?Z(G.token):Promise.resolve()};this.o=(G)=>{h.enqueueRetryable(()=>H(G))};let Q=(G)=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=G,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((G)=>Q(G)),setTimeout(()=>{if(!this.appCheck){let G=this.V.getImmediate({optional:!0});G?Q(G):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new r8(this.p));let h=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(h).then((Z)=>Z?(d(typeof Z.token=="string",44558,{tokenResult:Z}),this.m=Z.token,new r8(Z.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function mG(h){let Z=typeof self<"u"&&(self.crypto||self.msCrypto),H=new Uint8Array(h);if(Z&&typeof Z.getRandomValues=="function")Z.getRandomValues(H);else for(let Q=0;Q<h;Q++)H[Q]=Math.floor(256*Math.random());return H}class x6{static newId(){let Z=62*Math.floor(4.129032258064516),H="";for(;H.length<20;){let Q=mG(40);for(let G=0;G<Q.length;++G)H.length<20&&Q[G]<Z&&(H+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Q[G]%62))}return H}}function s(h,Z){return h<Z?-1:h>Z?1:0}function c8(h,Z){let H=Math.min(h.length,Z.length);for(let Q=0;Q<H;Q++){let G=h.charAt(Q),$=Z.charAt(Q);if(G!==$)return t8(G)===t8($)?s(G,$):t8(G)?1:-1}return s(h.length,Z.length)}var kG=55296,vG=57343;function t8(h){let Z=h.charCodeAt(0);return Z>=kG&&Z<=vG}function sh(h,Z,H){return h.length===Z.length&&h.every((Q,G)=>H(Q,Z[G]))}var W5="__name__";class A0{constructor(h,Z,H){Z===void 0?Z=0:Z>h.length&&k(637,{offset:Z,range:h.length}),H===void 0?H=h.length-Z:H>h.length-Z&&k(1746,{length:H,range:h.length-Z}),this.segments=h,this.offset=Z,this.len=H}get length(){return this.len}isEqual(h){return A0.comparator(this,h)===0}child(h){let Z=this.segments.slice(this.offset,this.limit());return h instanceof A0?h.forEach((H)=>{Z.push(H)}):Z.push(h),this.construct(Z)}limit(){return this.offset+this.length}popFirst(h){return h=h===void 0?1:h,this.construct(this.segments,this.offset+h,this.length-h)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(h){return this.segments[this.offset+h]}isEmpty(){return this.length===0}isPrefixOf(h){if(h.length<this.length)return!1;for(let Z=0;Z<this.length;Z++)if(this.get(Z)!==h.get(Z))return!1;return!0}isImmediateParentOf(h){if(this.length+1!==h.length)return!1;for(let Z=0;Z<this.length;Z++)if(this.get(Z)!==h.get(Z))return!1;return!0}forEach(h){for(let Z=this.offset,H=this.limit();Z<H;Z++)h(this.segments[Z])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(h,Z){let H=Math.min(h.length,Z.length);for(let Q=0;Q<H;Q++){let G=A0.compareSegments(h.get(Q),Z.get(Q));if(G!==0)return G}return s(h.length,Z.length)}static compareSegments(h,Z){let H=A0.isNumericId(h),Q=A0.isNumericId(Z);return H&&!Q?-1:!H&&Q?1:H&&Q?A0.extractNumericId(h).compare(A0.extractNumericId(Z)):c8(h,Z)}static isNumericId(h){return h.startsWith("__id")&&h.endsWith("__")}static extractNumericId(h){return f0.fromString(h.substring(4,h.length-2))}}class r extends A0{construct(h,Z,H){return new r(h,Z,H)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...h){let Z=[];for(let H of h){if(H.indexOf("//")>=0)throw new O(L.INVALID_ARGUMENT,`Invalid segment (${H}). Paths must not contain // in them.`);Z.push(...H.split("/").filter((Q)=>Q.length>0))}return new r(Z)}static emptyPath(){return new r([])}}var uG=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class B0 extends A0{construct(h,Z,H){return new B0(h,Z,H)}static isValidIdentifier(h){return uG.test(h)}canonicalString(){return this.toArray().map((h)=>(h=h.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),B0.isValidIdentifier(h)||(h="`"+h+"`"),h)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===W5}static keyField(){return new B0([W5])}static fromServerFormat(h){let Z=[],H="",Q=0,G=()=>{if(H.length===0)throw new O(L.INVALID_ARGUMENT,`Invalid field path (${h}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);Z.push(H),H=""},$=!1;for(;Q<h.length;){let M=h[Q];if(M==="\\"){if(Q+1===h.length)throw new O(L.INVALID_ARGUMENT,"Path has trailing escape character: "+h);let X=h[Q+1];if(X!=="\\"&&X!=="."&&X!=="`")throw new O(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+h);H+=X,Q+=2}else M==="`"?($=!$,Q++):M!=="."||$?(H+=M,Q++):(G(),Q++)}if(G(),$)throw new O(L.INVALID_ARGUMENT,"Unterminated ` in path: "+h);return new B0(Z)}static emptyPath(){return new B0([])}}class m{constructor(h){this.path=h}static fromPath(h){return new m(r.fromString(h))}static fromName(h){return new m(r.fromString(h).popFirst(5))}static empty(){return new m(r.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(h){return this.path.length>=2&&this.path.get(this.path.length-2)===h}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(h){return h!==null&&r.comparator(this.path,h.path)===0}toString(){return this.path.toString()}static comparator(h,Z){return r.comparator(h.path,Z.path)}static isDocumentKey(h){return h.length%2==0}static fromSegments(h){return new m(new r(h.slice()))}}function K7(h,Z,H){if(!H)throw new O(L.INVALID_ARGUMENT,`Function ${h}() cannot be called with an empty ${Z}.`)}function lG(h,Z,H,Q){if(Z===!0&&Q===!0)throw new O(L.INVALID_ARGUMENT,`${h} and ${H} cannot be used together.`)}function X5(h){if(!m.isDocumentKey(h))throw new O(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${h} has ${h.length}.`)}function B5(h){if(m.isDocumentKey(h))throw new O(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${h} has ${h.length}.`)}function G7(h){return typeof h=="object"&&h!==null&&(Object.getPrototypeOf(h)===Object.prototype||Object.getPrototypeOf(h)===null)}function m6(h){if(h===void 0)return"undefined";if(h===null)return"null";if(typeof h=="string")return h.length>20&&(h=`${h.substring(0,20)}...`),JSON.stringify(h);if(typeof h=="number"||typeof h=="boolean")return""+h;if(typeof h=="object"){if(h instanceof Array)return"an array";{let Z=function(Q){if(Q.constructor)return Q.constructor.name;return null}(h);return Z?`a custom ${Z} object`:"an object"}}return typeof h=="function"?"a function":k(12329,{type:typeof h})}function ih(h,Z){if("_delegate"in h&&(h=h._delegate),!(h instanceof Z)){if(Z.name===h.constructor.name)throw new O(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let H=m6(h);throw new O(L.INVALID_ARGUMENT,`Expected type '${Z.name}', but it was: ${H}`)}}return h}function sG(h,Z){if(Z<=0)throw new O(L.INVALID_ARGUMENT,`Function ${h}() requires a positive number, but it was: ${Z}.`)}function Q0(h,Z){let H={typeString:h};return Z&&(H.value=Z),H}function i1(h,Z){if(!G7(h))throw new O(L.INVALID_ARGUMENT,"JSON must be an object");let H;for(let Q in Z)if(Z[Q]){let G=Z[Q].typeString,$="value"in Z[Q]?{value:Z[Q].value}:void 0;if(!(Q in h)){H=`JSON missing required field: '${Q}'`;break}let M=h[Q];if(G&&typeof M!==G){H=`JSON field '${Q}' must be a ${G}.`;break}if($!==void 0&&M!==$.value){H=`Expected '${Q}' field to equal '${$.value}'`;break}}if(H)throw new O(L.INVALID_ARGUMENT,H);return!0}var U5=-62135596800,V5=1e6;class b{static now(){return b.fromMillis(Date.now())}static fromDate(h){return b.fromMillis(h.getTime())}static fromMillis(h){let Z=Math.floor(h/1000),H=Math.floor((h-1000*Z)*V5);return new b(Z,H)}constructor(h,Z){if(this.seconds=h,this.nanoseconds=Z,Z<0)throw new O(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+Z);if(Z>=1e9)throw new O(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+Z);if(h<U5)throw new O(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+h);if(h>=253402300800)throw new O(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+h)}toDate(){return new Date(this.toMillis())}toMillis(){return 1000*this.seconds+this.nanoseconds/V5}_compareTo(h){return this.seconds===h.seconds?s(this.nanoseconds,h.nanoseconds):s(this.seconds,h.seconds)}isEqual(h){return h.seconds===this.seconds&&h.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:b._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(h){if(i1(h,b._jsonSchema))return new b(h.seconds,h.nanoseconds)}valueOf(){let h=this.seconds-U5;return String(h).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}b._jsonSchemaVersion="firestore/timestamp/1.0",b._jsonSchema={type:Q0("string",b._jsonSchemaVersion),seconds:Q0("number"),nanoseconds:Q0("number")};class v{static fromTimestamp(h){return new v(h)}static min(){return new v(new b(0,0))}static max(){return new v(new b(253402300799,999999999))}constructor(h){this.timestamp=h}compareTo(h){return this.timestamp._compareTo(h.timestamp)}isEqual(h){return this.timestamp.isEqual(h.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1000}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}var A1=-1;class $7{constructor(h,Z,H,Q){this.indexId=h,this.collectionGroup=Z,this.fields=H,this.indexState=Q}}$7.UNKNOWN_ID=-1;function iG(h,Z){let H=h.toTimestamp().seconds,Q=h.toTimestamp().nanoseconds+1,G=v.fromTimestamp(Q===1e9?new b(H+1,0):new b(H,Q));return new Mh(G,m.empty(),Z)}function fG(h){return new Mh(h.readTime,h.key,A1)}class Mh{constructor(h,Z,H){this.readTime=h,this.documentKey=Z,this.largestBatchId=H}static min(){return new Mh(v.min(),m.empty(),A1)}static max(){return new Mh(v.max(),m.empty(),A1)}}function gG(h,Z){let H=h.readTime.compareTo(Z.readTime);return H!==0?H:(H=m.comparator(h.documentKey,Z.documentKey),H!==0?H:s(h.largestBatchId,Z.largestBatchId))}var tG="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class J7{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(h){this.onCommittedListeners.push(h)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((h)=>h())}}async function bh(h){if(h.code!==L.FAILED_PRECONDITION||h.message!==tG)throw h;A("LocalStore","Unexpectedly lost primary lease")}class N{constructor(h){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,h((Z)=>{this.isDone=!0,this.result=Z,this.nextCallback&&this.nextCallback(Z)},(Z)=>{this.isDone=!0,this.error=Z,this.catchCallback&&this.catchCallback(Z)})}catch(h){return this.next(void 0,h)}next(h,Z){return this.callbackAttached&&k(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(Z,this.error):this.wrapSuccess(h,this.result):new N((H,Q)=>{this.nextCallback=(G)=>{this.wrapSuccess(h,G).next(H,Q)},this.catchCallback=(G)=>{this.wrapFailure(Z,G).next(H,Q)}})}toPromise(){return new Promise((h,Z)=>{this.next(h,Z)})}wrapUserFunction(h){try{let Z=h();return Z instanceof N?Z:N.resolve(Z)}catch(Z){return N.reject(Z)}}wrapSuccess(h,Z){return h?this.wrapUserFunction(()=>h(Z)):N.resolve(Z)}wrapFailure(h,Z){return h?this.wrapUserFunction(()=>h(Z)):N.reject(Z)}static resolve(h){return new N((Z,H)=>{Z(h)})}static reject(h){return new N((Z,H)=>{H(h)})}static waitFor(h){return new N((Z,H)=>{let Q=0,G=0,$=!1;h.forEach((M)=>{++Q,M.next(()=>{++G,$&&G===Q&&Z()},(X)=>H(X))}),$=!0,G===Q&&Z()})}static or(h){let Z=N.resolve(!1);for(let H of h)Z=Z.next((Q)=>Q?N.resolve(Q):H());return Z}static forEach(h,Z){let H=[];return h.forEach((Q,G)=>{H.push(Z.call(this,Q,G))}),this.waitFor(H)}static mapArray(h,Z){return new N((H,Q)=>{let G=h.length,$=Array(G),M=0;for(let X=0;X<G;X++){let B=X;Z(h[B]).next((V)=>{$[B]=V,++M,M===G&&H($)},(V)=>Q(V))}})}static doWhile(h,Z){return new N((H,Q)=>{let G=()=>{h()===!0?Z().next(()=>{G()},Q):H()};G()})}}function pG(h){let Z=h.match(/Android ([\d.]+)/i),H=Z?Z[1].split(".").slice(0,2).join("."):"-1";return Number(H)}function eh(h){return h.name==="IndexedDbTransactionError"}class f1{constructor(h,Z){this.previousValue=h,Z&&(Z.sequenceNumberHandler=(H)=>this.ae(H),this.ue=(H)=>Z.writeSequenceNumber(H))}ae(h){return this.previousValue=Math.max(h,this.previousValue),this.previousValue}next(){let h=++this.previousValue;return this.ue&&this.ue(h),h}}f1.ce=-1;var q9=-1;function k6(h){return h==null}function j1(h){return h===0&&1/h==-1/0}function dG(h){return typeof h=="number"&&Number.isInteger(h)&&!j1(h)&&h<=Number.MAX_SAFE_INTEGER&&h>=Number.MIN_SAFE_INTEGER}var M7="\x01";function oG(h){let Z="";for(let H=0;H<h.length;H++)Z.length>0&&(Z=Y5(Z)),Z=nG(h.get(H),Z);return Y5(Z)}function nG(h,Z){let H=Z,Q=h.length;for(let G=0;G<Q;G++){let $=h.charAt(G);switch($){case"\x00":H+="\x01\x10";break;case M7:H+="\x01\x11";break;default:H+=$}}return H}function Y5(h){return h+M7+"\x01"}var rG="remoteDocuments",W7="owner";var X7="mutationQueues";var B7="mutations";var U7="documentMutations",cG="remoteDocumentsV14";var V7="remoteDocumentGlobal";var Y7="targets";var z7="targetDocuments";var I7="targetGlobal",D7="collectionParents";var P7="clientMetadata";var w7="bundles";var E7="namedQueries";var bG="indexConfiguration";var eG="indexState";var aG="indexEntries";var q7="documentOverlays";var h3="globals";var Z3=[X7,B7,U7,rG,Y7,W7,I7,z7,P7,V7,D7,w7,E7],CJ=[...Z3,q7],H3=[X7,B7,U7,cG,Y7,W7,I7,z7,P7,V7,D7,w7,E7,q7],Q3=H3,K3=[...Q3,bG,eG,aG];var OJ=[...K3,h3];function z5(h){let Z=0;for(let H in h)Object.prototype.hasOwnProperty.call(h,H)&&Z++;return Z}function Uh(h,Z){for(let H in h)Object.prototype.hasOwnProperty.call(h,H)&&Z(H,h[H])}function y7(h){for(let Z in h)if(Object.prototype.hasOwnProperty.call(h,Z))return!1;return!0}class a{constructor(h,Z){this.comparator=h,this.root=Z||X0.EMPTY}insert(h,Z){return new a(this.comparator,this.root.insert(h,Z,this.comparator).copy(null,null,X0.BLACK,null,null))}remove(h){return new a(this.comparator,this.root.remove(h,this.comparator).copy(null,null,X0.BLACK,null,null))}get(h){let Z=this.root;for(;!Z.isEmpty();){let H=this.comparator(h,Z.key);if(H===0)return Z.value;H<0?Z=Z.left:H>0&&(Z=Z.right)}return null}indexOf(h){let Z=0,H=this.root;for(;!H.isEmpty();){let Q=this.comparator(h,H.key);if(Q===0)return Z+H.left.size;Q<0?H=H.left:(Z+=H.left.size+1,H=H.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(h){return this.root.inorderTraversal(h)}forEach(h){this.inorderTraversal((Z,H)=>(h(Z,H),!1))}toString(){let h=[];return this.inorderTraversal((Z,H)=>(h.push(`${Z}:${H}`),!1)),`{${h.join(", ")}}`}reverseTraversal(h){return this.root.reverseTraversal(h)}getIterator(){return new T1(this.root,null,this.comparator,!1)}getIteratorFrom(h){return new T1(this.root,h,this.comparator,!1)}getReverseIterator(){return new T1(this.root,null,this.comparator,!0)}getReverseIteratorFrom(h){return new T1(this.root,h,this.comparator,!0)}}class T1{constructor(h,Z,H,Q){this.isReverse=Q,this.nodeStack=[];let G=1;for(;!h.isEmpty();)if(G=Z?H(h.key,Z):1,Z&&Q&&(G*=-1),G<0)h=this.isReverse?h.left:h.right;else{if(G===0){this.nodeStack.push(h);break}this.nodeStack.push(h),h=this.isReverse?h.right:h.left}}getNext(){let h=this.nodeStack.pop(),Z={key:h.key,value:h.value};if(this.isReverse)for(h=h.left;!h.isEmpty();)this.nodeStack.push(h),h=h.right;else for(h=h.right;!h.isEmpty();)this.nodeStack.push(h),h=h.left;return Z}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let h=this.nodeStack[this.nodeStack.length-1];return{key:h.key,value:h.value}}}class X0{constructor(h,Z,H,Q,G){this.key=h,this.value=Z,this.color=H!=null?H:X0.RED,this.left=Q!=null?Q:X0.EMPTY,this.right=G!=null?G:X0.EMPTY,this.size=this.left.size+1+this.right.size}copy(h,Z,H,Q,G){return new X0(h!=null?h:this.key,Z!=null?Z:this.value,H!=null?H:this.color,Q!=null?Q:this.left,G!=null?G:this.right)}isEmpty(){return!1}inorderTraversal(h){return this.left.inorderTraversal(h)||h(this.key,this.value)||this.right.inorderTraversal(h)}reverseTraversal(h){return this.right.reverseTraversal(h)||h(this.key,this.value)||this.left.reverseTraversal(h)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(h,Z,H){let Q=this,G=H(h,Q.key);return Q=G<0?Q.copy(null,null,null,Q.left.insert(h,Z,H),null):G===0?Q.copy(null,Z,null,null,null):Q.copy(null,null,null,null,Q.right.insert(h,Z,H)),Q.fixUp()}removeMin(){if(this.left.isEmpty())return X0.EMPTY;let h=this;return h.left.isRed()||h.left.left.isRed()||(h=h.moveRedLeft()),h=h.copy(null,null,null,h.left.removeMin(),null),h.fixUp()}remove(h,Z){let H,Q=this;if(Z(h,Q.key)<0)Q.left.isEmpty()||Q.left.isRed()||Q.left.left.isRed()||(Q=Q.moveRedLeft()),Q=Q.copy(null,null,null,Q.left.remove(h,Z),null);else{if(Q.left.isRed()&&(Q=Q.rotateRight()),Q.right.isEmpty()||Q.right.isRed()||Q.right.left.isRed()||(Q=Q.moveRedRight()),Z(h,Q.key)===0){if(Q.right.isEmpty())return X0.EMPTY;H=Q.right.min(),Q=Q.copy(H.key,H.value,null,null,Q.right.removeMin())}Q=Q.copy(null,null,null,null,Q.right.remove(h,Z))}return Q.fixUp()}isRed(){return this.color}fixUp(){let h=this;return h.right.isRed()&&!h.left.isRed()&&(h=h.rotateLeft()),h.left.isRed()&&h.left.left.isRed()&&(h=h.rotateRight()),h.left.isRed()&&h.right.isRed()&&(h=h.colorFlip()),h}moveRedLeft(){let h=this.colorFlip();return h.right.left.isRed()&&(h=h.copy(null,null,null,null,h.right.rotateRight()),h=h.rotateLeft(),h=h.colorFlip()),h}moveRedRight(){let h=this.colorFlip();return h.left.left.isRed()&&(h=h.rotateRight(),h=h.colorFlip()),h}rotateLeft(){let h=this.copy(null,null,X0.RED,null,this.right.left);return this.right.copy(null,null,this.color,h,null)}rotateRight(){let h=this.copy(null,null,X0.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,h)}colorFlip(){let h=this.left.copy(null,null,!this.left.color,null,null),Z=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,h,Z)}checkMaxDepth(){let h=this.check();return Math.pow(2,h)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw k(43730,{key:this.key,value:this.value});if(this.right.isRed())throw k(14113,{key:this.key,value:this.value});let h=this.left.check();if(h!==this.right.check())throw k(27949);return h+(this.isRed()?0:1)}}X0.EMPTY=null,X0.RED=!0,X0.BLACK=!1;X0.EMPTY=new class{constructor(){this.size=0}get key(){throw k(57766)}get value(){throw k(16141)}get color(){throw k(16727)}get left(){throw k(29726)}get right(){throw k(36894)}copy(Z,H,Q,G,$){return this}insert(Z,H,Q){return new X0(Z,H)}remove(Z,H){return this}isEmpty(){return!0}inorderTraversal(Z){return!1}reverseTraversal(Z){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class J0{constructor(h){this.comparator=h,this.data=new a(this.comparator)}has(h){return this.data.get(h)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(h){return this.data.indexOf(h)}forEach(h){this.data.inorderTraversal((Z,H)=>(h(Z),!1))}forEachInRange(h,Z){let H=this.data.getIteratorFrom(h[0]);for(;H.hasNext();){let Q=H.getNext();if(this.comparator(Q.key,h[1])>=0)return;Z(Q.key)}}forEachWhile(h,Z){let H;for(H=Z!==void 0?this.data.getIteratorFrom(Z):this.data.getIterator();H.hasNext();)if(!h(H.getNext().key))return}firstAfterOrEqual(h){let Z=this.data.getIteratorFrom(h);return Z.hasNext()?Z.getNext().key:null}getIterator(){return new b8(this.data.getIterator())}getIteratorFrom(h){return new b8(this.data.getIteratorFrom(h))}add(h){return this.copy(this.data.remove(h).insert(h,!0))}delete(h){return this.has(h)?this.copy(this.data.remove(h)):this}isEmpty(){return this.data.isEmpty()}unionWith(h){let Z=this;return Z.size<h.size&&(Z=h,h=this),h.forEach((H)=>{Z=Z.add(H)}),Z}isEqual(h){if(!(h instanceof J0))return!1;if(this.size!==h.size)return!1;let Z=this.data.getIterator(),H=h.data.getIterator();for(;Z.hasNext();){let Q=Z.getNext().key,G=H.getNext().key;if(this.comparator(Q,G)!==0)return!1}return!0}toArray(){let h=[];return this.forEach((Z)=>{h.push(Z)}),h}toString(){let h=[];return this.forEach((Z)=>h.push(Z)),"SortedSet("+h.toString()+")"}copy(h){let Z=new J0(this.comparator);return Z.data=h,Z}}class b8{constructor(h){this.iter=h}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class R0{constructor(h){this.fields=h,h.sort(B0.comparator)}static empty(){return new R0([])}unionWith(h){let Z=new J0(B0.comparator);for(let H of this.fields)Z=Z.add(H);for(let H of h)Z=Z.add(H);return new R0(Z.toArray())}covers(h){for(let Z of this.fields)if(Z.isPrefixOf(h))return!0;return!1}isEqual(h){return sh(this.fields,h.fields,(Z,H)=>Z.isEqual(H))}}class y9 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class U0{constructor(h){this.binaryString=h}static fromBase64String(h){let Z=function(Q){try{return atob(Q)}catch(G){throw typeof DOMException<"u"&&G instanceof DOMException?new y9("Invalid base64 string: "+G):G}}(h);return new U0(Z)}static fromUint8Array(h){let Z=function(Q){let G="";for(let $=0;$<Q.length;++$)G+=String.fromCharCode(Q[$]);return G}(h);return new U0(Z)}[Symbol.iterator](){let h=0;return{next:()=>h<this.binaryString.length?{value:this.binaryString.charCodeAt(h++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(Z){return btoa(Z)}(this.binaryString)}toUint8Array(){return function(Z){let H=new Uint8Array(Z.length);for(let Q=0;Q<Z.length;Q++)H[Q]=Z.charCodeAt(Q);return H}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(h){return s(this.binaryString,h.binaryString)}isEqual(h){return this.binaryString===h.binaryString}}U0.EMPTY_BYTE_STRING=new U0("");var G3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function d0(h){if(d(!!h,39018),typeof h=="string"){let Z=0,H=G3.exec(h);if(d(!!H,46558,{timestamp:h}),H[1]){let G=H[1];G=(G+"000000000").substr(0,9),Z=Number(G)}let Q=new Date(h);return{seconds:Math.floor(Q.getTime()/1000),nanos:Z}}return{seconds:e(h.seconds),nanos:e(h.nanos)}}function e(h){return typeof h=="number"?h:typeof h=="string"?Number(h):0}function o0(h){return typeof h=="string"?U0.fromBase64String(h):U0.fromUint8Array(h)}var T7="server_timestamp",F7="__type__",R7="__previous_value__",L7="__local_write_time__";function T9(h){return(h?.mapValue?.fields||{})[F7]?.stringValue===T7}function v6(h){let Z=h.mapValue.fields[R7];return T9(Z)?v6(Z):Z}function x1(h){let Z=d0(h.mapValue.fields[L7].timestampValue);return new b(Z.seconds,Z.nanos)}class N7{constructor(h,Z,H,Q,G,$,M,X,B,V){this.databaseId=h,this.appId=Z,this.persistenceKey=H,this.host=Q,this.ssl=G,this.forceLongPolling=$,this.autoDetectLongPolling=M,this.longPollingOptions=X,this.useFetchStreams=B,this.isUsingEmulator=V}}var N6="(default)";class m1{constructor(h,Z){this.projectId=h,this.database=Z||N6}static empty(){return new m1("","")}get isDefaultDatabase(){return this.database===N6}isEqual(h){return h instanceof m1&&h.projectId===this.projectId&&h.database===this.database}}var F9="__type__",S7="__max__",q6={mapValue:{fields:{__type__:{stringValue:S7}}}},R9="__vector__",fh="value";function Wh(h){return"nullValue"in h?0:("booleanValue"in h)?1:("integerValue"in h)||("doubleValue"in h)?2:("timestampValue"in h)?3:("stringValue"in h)?5:("bytesValue"in h)?6:("referenceValue"in h)?7:("geoPointValue"in h)?8:("arrayValue"in h)?9:("mapValue"in h)?T9(h)?4:O7(h)?9007199254740991:C7(h)?10:11:k(28295,{value:h})}function u0(h,Z){if(h===Z)return!0;let H=Wh(h);if(H!==Wh(Z))return!1;switch(H){case 0:case 9007199254740991:return!0;case 1:return h.booleanValue===Z.booleanValue;case 4:return x1(h).isEqual(x1(Z));case 3:return function(G,$){if(typeof G.timestampValue=="string"&&typeof $.timestampValue=="string"&&G.timestampValue.length===$.timestampValue.length)return G.timestampValue===$.timestampValue;let M=d0(G.timestampValue),X=d0($.timestampValue);return M.seconds===X.seconds&&M.nanos===X.nanos}(h,Z);case 5:return h.stringValue===Z.stringValue;case 6:return function(G,$){return o0(G.bytesValue).isEqual(o0($.bytesValue))}(h,Z);case 7:return h.referenceValue===Z.referenceValue;case 8:return function(G,$){return e(G.geoPointValue.latitude)===e($.geoPointValue.latitude)&&e(G.geoPointValue.longitude)===e($.geoPointValue.longitude)}(h,Z);case 2:return function(G,$){if("integerValue"in G&&"integerValue"in $)return e(G.integerValue)===e($.integerValue);if("doubleValue"in G&&"doubleValue"in $){let M=e(G.doubleValue),X=e($.doubleValue);return M===X?j1(M)===j1(X):isNaN(M)&&isNaN(X)}return!1}(h,Z);case 9:return sh(h.arrayValue.values||[],Z.arrayValue.values||[],u0);case 10:case 11:return function(G,$){let M=G.mapValue.fields||{},X=$.mapValue.fields||{};if(z5(M)!==z5(X))return!1;for(let B in M)if(M.hasOwnProperty(B)&&(X[B]===void 0||!u0(M[B],X[B])))return!1;return!0}(h,Z);default:return k(52216,{left:h})}}function k1(h,Z){return(h.values||[]).find((H)=>u0(H,Z))!==void 0}function gh(h,Z){if(h===Z)return 0;let H=Wh(h),Q=Wh(Z);if(H!==Q)return s(H,Q);switch(H){case 0:case 9007199254740991:return 0;case 1:return s(h.booleanValue,Z.booleanValue);case 2:return function($,M){let X=e($.integerValue||$.doubleValue),B=e(M.integerValue||M.doubleValue);return X<B?-1:X>B?1:X===B?0:isNaN(X)?isNaN(B)?0:-1:1}(h,Z);case 3:return I5(h.timestampValue,Z.timestampValue);case 4:return I5(x1(h),x1(Z));case 5:return c8(h.stringValue,Z.stringValue);case 6:return function($,M){let X=o0($),B=o0(M);return X.compareTo(B)}(h.bytesValue,Z.bytesValue);case 7:return function($,M){let X=$.split("/"),B=M.split("/");for(let V=0;V<X.length&&V<B.length;V++){let D=s(X[V],B[V]);if(D!==0)return D}return s(X.length,B.length)}(h.referenceValue,Z.referenceValue);case 8:return function($,M){let X=s(e($.latitude),e(M.latitude));if(X!==0)return X;return s(e($.longitude),e(M.longitude))}(h.geoPointValue,Z.geoPointValue);case 9:return D5(h.arrayValue,Z.arrayValue);case 10:return function($,M){let X=$.fields||{},B=M.fields||{},V=X[fh]?.arrayValue,D=B[fh]?.arrayValue,F=s(V?.values?.length||0,D?.values?.length||0);if(F!==0)return F;return D5(V,D)}(h.mapValue,Z.mapValue);case 11:return function($,M){if($===q6.mapValue&&M===q6.mapValue)return 0;if($===q6.mapValue)return 1;if(M===q6.mapValue)return-1;let X=$.fields||{},B=Object.keys(X),V=M.fields||{},D=Object.keys(V);B.sort(),D.sort();for(let F=0;F<B.length&&F<D.length;++F){let y=c8(B[F],D[F]);if(y!==0)return y;let S=gh(X[B[F]],V[D[F]]);if(S!==0)return S}return s(B.length,D.length)}(h.mapValue,Z.mapValue);default:throw k(23264,{he:H})}}function I5(h,Z){if(typeof h=="string"&&typeof Z=="string"&&h.length===Z.length)return s(h,Z);let H=d0(h),Q=d0(Z),G=s(H.seconds,Q.seconds);return G!==0?G:s(H.nanos,Q.nanos)}function D5(h,Z){let H=h.values||[],Q=Z.values||[];for(let G=0;G<H.length&&G<Q.length;++G){let $=gh(H[G],Q[G]);if($)return $}return s(H.length,Q.length)}function th(h){return e8(h)}function e8(h){return"nullValue"in h?"null":("booleanValue"in h)?""+h.booleanValue:("integerValue"in h)?""+h.integerValue:("doubleValue"in h)?""+h.doubleValue:("timestampValue"in h)?function(H){let Q=d0(H);return`time(${Q.seconds},${Q.nanos})`}(h.timestampValue):("stringValue"in h)?h.stringValue:("bytesValue"in h)?function(H){return o0(H).toBase64()}(h.bytesValue):("referenceValue"in h)?function(H){return m.fromName(H).toString()}(h.referenceValue):("geoPointValue"in h)?function(H){return`geo(${H.latitude},${H.longitude})`}(h.geoPointValue):("arrayValue"in h)?function(H){let Q="[",G=!0;for(let $ of H.values||[])G?G=!1:Q+=",",Q+=e8($);return Q+"]"}(h.arrayValue):("mapValue"in h)?function(H){let Q=Object.keys(H.fields||{}).sort(),G="{",$=!0;for(let M of Q)$?$=!1:G+=",",G+=`${M}:${e8(H.fields[M])}`;return G+"}"}(h.mapValue):k(61005,{value:h})}function F6(h){switch(Wh(h)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let Z=v6(h);return Z?16+F6(Z):16;case 5:return 2*h.stringValue.length;case 6:return o0(h.bytesValue).approximateByteSize();case 7:return h.referenceValue.length;case 9:return function(Q){return(Q.values||[]).reduce((G,$)=>G+F6($),0)}(h.arrayValue);case 10:case 11:return function(Q){let G=0;return Uh(Q.fields,($,M)=>{G+=$.length+F6(M)}),G}(h.mapValue);default:throw k(13486,{value:h})}}function P5(h,Z){return{referenceValue:`projects/${h.projectId}/databases/${h.database}/documents/${Z.path.canonicalString()}`}}function a8(h){return!!h&&"integerValue"in h}function L9(h){return!!h&&"arrayValue"in h}function w5(h){return!!h&&"nullValue"in h}function E5(h){return!!h&&"doubleValue"in h&&isNaN(Number(h.doubleValue))}function R6(h){return!!h&&"mapValue"in h}function C7(h){return(h?.mapValue?.fields||{})[F9]?.stringValue===R9}function L1(h){if(h.geoPointValue)return{geoPointValue:{...h.geoPointValue}};if(h.timestampValue&&typeof h.timestampValue=="object")return{timestampValue:{...h.timestampValue}};if(h.mapValue){let Z={mapValue:{fields:{}}};return Uh(h.mapValue.fields,(H,Q)=>Z.mapValue.fields[H]=L1(Q)),Z}if(h.arrayValue){let Z={arrayValue:{values:[]}};for(let H=0;H<(h.arrayValue.values||[]).length;++H)Z.arrayValue.values[H]=L1(h.arrayValue.values[H]);return Z}return{...h}}function O7(h){return(((h.mapValue||{}).fields||{}).__type__||{}).stringValue===S7}var _J={mapValue:{fields:{[F9]:{stringValue:R9},[fh]:{arrayValue:{}}}}};class y0{constructor(h){this.value=h}static empty(){return new y0({mapValue:{}})}field(h){if(h.isEmpty())return this.value;{let Z=this.value;for(let H=0;H<h.length-1;++H)if(Z=(Z.mapValue.fields||{})[h.get(H)],!R6(Z))return null;return Z=(Z.mapValue.fields||{})[h.lastSegment()],Z||null}}set(h,Z){this.getFieldsMap(h.popLast())[h.lastSegment()]=L1(Z)}setAll(h){let Z=B0.emptyPath(),H={},Q=[];h.forEach(($,M)=>{if(!Z.isImmediateParentOf(M)){let X=this.getFieldsMap(Z);this.applyChanges(X,H,Q),H={},Q=[],Z=M.popLast()}$?H[M.lastSegment()]=L1($):Q.push(M.lastSegment())});let G=this.getFieldsMap(Z);this.applyChanges(G,H,Q)}delete(h){let Z=this.field(h.popLast());R6(Z)&&Z.mapValue.fields&&delete Z.mapValue.fields[h.lastSegment()]}isEqual(h){return u0(this.value,h.value)}getFieldsMap(h){let Z=this.value;Z.mapValue.fields||(Z.mapValue={fields:{}});for(let H=0;H<h.length;++H){let Q=Z.mapValue.fields[h.get(H)];R6(Q)&&Q.mapValue.fields||(Q={mapValue:{fields:{}}},Z.mapValue.fields[h.get(H)]=Q),Z=Q}return Z.mapValue.fields}applyChanges(h,Z,H){Uh(Z,(Q,G)=>h[Q]=G);for(let Q of H)delete h[Q]}clone(){return new y0(L1(this.value))}}function _7(h){let Z=[];return Uh(h.fields,(H,Q)=>{let G=new B0([H]);if(R6(Q)){let $=_7(Q.mapValue).fields;if($.length===0)Z.push(G);else for(let M of $)Z.push(G.child(M))}else Z.push(G)}),new R0(Z)}class I0{constructor(h,Z,H,Q,G,$,M){this.key=h,this.documentType=Z,this.version=H,this.readTime=Q,this.createTime=G,this.data=$,this.documentState=M}static newInvalidDocument(h){return new I0(h,0,v.min(),v.min(),v.min(),y0.empty(),0)}static newFoundDocument(h,Z,H,Q){return new I0(h,1,Z,v.min(),H,Q,0)}static newNoDocument(h,Z){return new I0(h,2,Z,v.min(),v.min(),y0.empty(),0)}static newUnknownDocument(h,Z){return new I0(h,3,Z,v.min(),v.min(),y0.empty(),2)}convertToFoundDocument(h,Z){return!this.createTime.isEqual(v.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=h),this.version=h,this.documentType=1,this.data=Z,this.documentState=0,this}convertToNoDocument(h){return this.version=h,this.documentType=2,this.data=y0.empty(),this.documentState=0,this}convertToUnknownDocument(h){return this.version=h,this.documentType=3,this.data=y0.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=v.min(),this}setReadTime(h){return this.readTime=h,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(h){return h instanceof I0&&this.key.isEqual(h.key)&&this.version.isEqual(h.version)&&this.documentType===h.documentType&&this.documentState===h.documentState&&this.data.isEqual(h.data)}mutableCopy(){return new I0(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class v1{constructor(h,Z){this.position=h,this.inclusive=Z}}function q5(h,Z,H){let Q=0;for(let G=0;G<h.position.length;G++){let $=Z[G],M=h.position[G];if($.field.isKeyField())Q=m.comparator(m.fromName(M.referenceValue),H.key);else Q=gh(M,H.data.field($.field));if($.dir==="desc"&&(Q*=-1),Q!==0)break}return Q}function y5(h,Z){if(h===null)return Z===null;if(Z===null)return!1;if(h.inclusive!==Z.inclusive||h.position.length!==Z.position.length)return!1;for(let H=0;H<h.position.length;H++)if(!u0(h.position[H],Z.position[H]))return!1;return!0}class ph{constructor(h,Z="asc"){this.field=h,this.dir=Z}}function $3(h,Z){return h.dir===Z.dir&&h.field.isEqual(Z.field)}class N9{}class H0 extends N9{constructor(h,Z,H){super(),this.field=h,this.op=Z,this.value=H}static create(h,Z,H){return h.isKeyField()?Z==="in"||Z==="not-in"?this.createKeyFieldInFilter(h,Z,H):new k7(h,Z,H):Z==="array-contains"?new s7(h,H):Z==="in"?new i7(h,H):Z==="not-in"?new f7(h,H):Z==="array-contains-any"?new g7(h,H):new H0(h,Z,H)}static createKeyFieldInFilter(h,Z,H){return Z==="in"?new v7(h,H):new u7(h,H)}matches(h){let Z=h.data.field(this.field);return this.op==="!="?Z!==null&&Z.nullValue===void 0&&this.matchesComparison(gh(Z,this.value)):Z!==null&&Wh(this.value)===Wh(Z)&&this.matchesComparison(gh(Z,this.value))}matchesComparison(h){switch(this.op){case"<":return h<0;case"<=":return h<=0;case"==":return h===0;case"!=":return h!==0;case">":return h>0;case">=":return h>=0;default:return k(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class N0 extends N9{constructor(h,Z){super(),this.filters=h,this.op=Z,this.Pe=null}static create(h,Z){return new N0(h,Z)}matches(h){return A7(this)?this.filters.find((Z)=>!Z.matches(h))===void 0:this.filters.find((Z)=>Z.matches(h))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((h,Z)=>h.concat(Z.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function A7(h){return h.op==="and"}function j7(h){return J3(h)&&A7(h)}function J3(h){for(let Z of h.filters)if(Z instanceof N0)return!1;return!0}function h9(h){if(h instanceof H0)return h.field.canonicalString()+h.op.toString()+th(h.value);if(j7(h))return h.filters.map((Z)=>h9(Z)).join(",");{let Z=h.filters.map((H)=>h9(H)).join(",");return`${h.op}(${Z})`}}function x7(h,Z){return h instanceof H0?function(Q,G){return G instanceof H0&&Q.op===G.op&&Q.field.isEqual(G.field)&&u0(Q.value,G.value)}(h,Z):h instanceof N0?function(Q,G){if(G instanceof N0&&Q.op===G.op&&Q.filters.length===G.filters.length)return Q.filters.reduce(($,M,X)=>$&&x7(M,G.filters[X]),!0);return!1}(h,Z):void k(19439)}function m7(h){return h instanceof H0?function(H){return`${H.field.canonicalString()} ${H.op} ${th(H.value)}`}(h):h instanceof N0?function(H){return H.op.toString()+" {"+H.getFilters().map(m7).join(" ,")+"}"}(h):"Filter"}class k7 extends H0{constructor(h,Z,H){super(h,Z,H),this.key=m.fromName(H.referenceValue)}matches(h){let Z=m.comparator(h.key,this.key);return this.matchesComparison(Z)}}class v7 extends H0{constructor(h,Z){super(h,"in",Z),this.keys=l7("in",Z)}matches(h){return this.keys.some((Z)=>Z.isEqual(h.key))}}class u7 extends H0{constructor(h,Z){super(h,"not-in",Z),this.keys=l7("not-in",Z)}matches(h){return!this.keys.some((Z)=>Z.isEqual(h.key))}}function l7(h,Z){return(Z.arrayValue?.values||[]).map((H)=>m.fromName(H.referenceValue))}class s7 extends H0{constructor(h,Z){super(h,"array-contains",Z)}matches(h){let Z=h.data.field(this.field);return L9(Z)&&k1(Z.arrayValue,this.value)}}class i7 extends H0{constructor(h,Z){super(h,"in",Z)}matches(h){let Z=h.data.field(this.field);return Z!==null&&k1(this.value.arrayValue,Z)}}class f7 extends H0{constructor(h,Z){super(h,"not-in",Z)}matches(h){if(k1(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let Z=h.data.field(this.field);return Z!==null&&Z.nullValue===void 0&&!k1(this.value.arrayValue,Z)}}class g7 extends H0{constructor(h,Z){super(h,"array-contains-any",Z)}matches(h){let Z=h.data.field(this.field);return!(!L9(Z)||!Z.arrayValue.values)&&Z.arrayValue.values.some((H)=>k1(this.value.arrayValue,H))}}class t7{constructor(h,Z=null,H=[],Q=[],G=null,$=null,M=null){this.path=h,this.collectionGroup=Z,this.orderBy=H,this.filters=Q,this.limit=G,this.startAt=$,this.endAt=M,this.Te=null}}function T5(h,Z=null,H=[],Q=[],G=null,$=null,M=null){return new t7(h,Z,H,Q,G,$,M)}function S9(h){let Z=u(h);if(Z.Te===null){let H=Z.path.canonicalString();Z.collectionGroup!==null&&(H+="|cg:"+Z.collectionGroup),H+="|f:",H+=Z.filters.map((Q)=>h9(Q)).join(","),H+="|ob:",H+=Z.orderBy.map((Q)=>function($){return $.field.canonicalString()+$.dir}(Q)).join(","),k6(Z.limit)||(H+="|l:",H+=Z.limit),Z.startAt&&(H+="|lb:",H+=Z.startAt.inclusive?"b:":"a:",H+=Z.startAt.position.map((Q)=>th(Q)).join(",")),Z.endAt&&(H+="|ub:",H+=Z.endAt.inclusive?"a:":"b:",H+=Z.endAt.position.map((Q)=>th(Q)).join(",")),Z.Te=H}return Z.Te}function C9(h,Z){if(h.limit!==Z.limit)return!1;if(h.orderBy.length!==Z.orderBy.length)return!1;for(let H=0;H<h.orderBy.length;H++)if(!$3(h.orderBy[H],Z.orderBy[H]))return!1;if(h.filters.length!==Z.filters.length)return!1;for(let H=0;H<h.filters.length;H++)if(!x7(h.filters[H],Z.filters[H]))return!1;return h.collectionGroup===Z.collectionGroup&&(!!h.path.isEqual(Z.path)&&(!!y5(h.startAt,Z.startAt)&&y5(h.endAt,Z.endAt)))}function Z9(h){return m.isDocumentKey(h.path)&&h.collectionGroup===null&&h.filters.length===0}class Fh{constructor(h,Z=null,H=[],Q=[],G=null,$="F",M=null,X=null){this.path=h,this.collectionGroup=Z,this.explicitOrderBy=H,this.filters=Q,this.limit=G,this.limitType=$,this.startAt=M,this.endAt=X,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function M3(h,Z,H,Q,G,$,M,X){return new Fh(h,Z,H,Q,G,$,M,X)}function p7(h){return new Fh(h)}function F5(h){return h.filters.length===0&&h.limit===null&&h.startAt==null&&h.endAt==null&&(h.explicitOrderBy.length===0||h.explicitOrderBy.length===1&&h.explicitOrderBy[0].field.isKeyField())}function d7(h){return h.collectionGroup!==null}function N1(h){let Z=u(h);if(Z.Ie===null){Z.Ie=[];let H=new Set;for(let $ of Z.explicitOrderBy)Z.Ie.push($),H.add($.field.canonicalString());let Q=Z.explicitOrderBy.length>0?Z.explicitOrderBy[Z.explicitOrderBy.length-1].dir:"asc";(function(M){let X=new J0(B0.comparator);return M.filters.forEach((B)=>{B.getFlattenedFilters().forEach((V)=>{V.isInequality()&&(X=X.add(V.field))})}),X})(Z).forEach(($)=>{H.has($.canonicalString())||$.isKeyField()||Z.Ie.push(new ph($,Q))}),H.has(B0.keyField().canonicalString())||Z.Ie.push(new ph(B0.keyField(),Q))}return Z.Ie}function j0(h){let Z=u(h);return Z.Ee||(Z.Ee=W3(Z,N1(h))),Z.Ee}function W3(h,Z){if(h.limitType==="F")return T5(h.path,h.collectionGroup,Z,h.filters,h.limit,h.startAt,h.endAt);{Z=Z.map((G)=>{let $=G.dir==="desc"?"asc":"desc";return new ph(G.field,$)});let H=h.endAt?new v1(h.endAt.position,h.endAt.inclusive):null,Q=h.startAt?new v1(h.startAt.position,h.startAt.inclusive):null;return T5(h.path,h.collectionGroup,Z,h.filters,h.limit,H,Q)}}function H9(h,Z){let H=h.filters.concat([Z]);return new Fh(h.path,h.collectionGroup,h.explicitOrderBy.slice(),H,h.limit,h.limitType,h.startAt,h.endAt)}function S6(h,Z,H){return new Fh(h.path,h.collectionGroup,h.explicitOrderBy.slice(),h.filters.slice(),Z,H,h.startAt,h.endAt)}function u6(h,Z){return C9(j0(h),j0(Z))&&h.limitType===Z.limitType}function o7(h){return`${S9(j0(h))}|lt:${h.limitType}`}function Ah(h){return`Query(target=${function(H){let Q=H.path.canonicalString();return H.collectionGroup!==null&&(Q+=" collectionGroup="+H.collectionGroup),H.filters.length>0&&(Q+=`, filters: [${H.filters.map((G)=>m7(G)).join(", ")}]`),k6(H.limit)||(Q+=", limit: "+H.limit),H.orderBy.length>0&&(Q+=`, orderBy: [${H.orderBy.map((G)=>function(M){return`${M.field.canonicalString()} (${M.dir})`}(G)).join(", ")}]`),H.startAt&&(Q+=", startAt: ",Q+=H.startAt.inclusive?"b:":"a:",Q+=H.startAt.position.map((G)=>th(G)).join(",")),H.endAt&&(Q+=", endAt: ",Q+=H.endAt.inclusive?"a:":"b:",Q+=H.endAt.position.map((G)=>th(G)).join(",")),`Target(${Q})`}(j0(h))}; limitType=${h.limitType})`}function l6(h,Z){return Z.isFoundDocument()&&function(Q,G){let $=G.key.path;return Q.collectionGroup!==null?G.key.hasCollectionId(Q.collectionGroup)&&Q.path.isPrefixOf($):m.isDocumentKey(Q.path)?Q.path.isEqual($):Q.path.isImmediateParentOf($)}(h,Z)&&function(Q,G){for(let $ of N1(Q))if(!$.field.isKeyField()&&G.data.field($.field)===null)return!1;return!0}(h,Z)&&function(Q,G){for(let $ of Q.filters)if(!$.matches(G))return!1;return!0}(h,Z)&&function(Q,G){if(Q.startAt&&!function(M,X,B){let V=q5(M,X,B);return M.inclusive?V<=0:V<0}(Q.startAt,N1(Q),G))return!1;if(Q.endAt&&!function(M,X,B){let V=q5(M,X,B);return M.inclusive?V>=0:V>0}(Q.endAt,N1(Q),G))return!1;return!0}(h,Z)}function X3(h){return h.collectionGroup||(h.path.length%2==1?h.path.lastSegment():h.path.get(h.path.length-2))}function n7(h){return(Z,H)=>{let Q=!1;for(let G of N1(h)){let $=B3(G,Z,H);if($!==0)return $;Q=Q||G.field.isKeyField()}return 0}}function B3(h,Z,H){let Q=h.field.isKeyField()?m.comparator(Z.key,H.key):function($,M,X){let B=M.data.field($),V=X.data.field($);return B!==null&&V!==null?gh(B,V):k(42886)}(h.field,Z,H);switch(h.dir){case"asc":return Q;case"desc":return-1*Q;default:return k(19790,{direction:h.dir})}}class Vh{constructor(h,Z){this.mapKeyFn=h,this.equalsFn=Z,this.inner={},this.innerSize=0}get(h){let Z=this.mapKeyFn(h),H=this.inner[Z];if(H!==void 0){for(let[Q,G]of H)if(this.equalsFn(Q,h))return G}}has(h){return this.get(h)!==void 0}set(h,Z){let H=this.mapKeyFn(h),Q=this.inner[H];if(Q===void 0)return this.inner[H]=[[h,Z]],void this.innerSize++;for(let G=0;G<Q.length;G++)if(this.equalsFn(Q[G][0],h))return void(Q[G]=[h,Z]);Q.push([h,Z]),this.innerSize++}delete(h){let Z=this.mapKeyFn(h),H=this.inner[Z];if(H===void 0)return!1;for(let Q=0;Q<H.length;Q++)if(this.equalsFn(H[Q][0],h))return H.length===1?delete this.inner[Z]:H.splice(Q,1),this.innerSize--,!0;return!1}forEach(h){Uh(this.inner,(Z,H)=>{for(let[Q,G]of H)h(Q,G)})}isEmpty(){return y7(this.inner)}size(){return this.innerSize}}var U3=new a(m.comparator);function n0(){return U3}var r7=new a(m.comparator);function F1(...h){let Z=r7;for(let H of h)Z=Z.insert(H.key,H);return Z}function c7(h){let Z=r7;return h.forEach((H,Q)=>Z=Z.insert(H,Q.overlayedDocument)),Z}function qh(){return S1()}function b7(){return S1()}function S1(){return new Vh((h)=>h.toString(),(h,Z)=>h.isEqual(Z))}var V3=new a(m.comparator),Y3=new J0(m.comparator);function i(...h){let Z=Y3;for(let H of h)Z=Z.add(H);return Z}var z3=new J0(s);function I3(){return z3}function O9(h,Z){if(h.useProto3Json){if(isNaN(Z))return{doubleValue:"NaN"};if(Z===1/0)return{doubleValue:"Infinity"};if(Z===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:j1(Z)?"-0":Z}}function e7(h){return{integerValue:""+h}}function D3(h,Z){return dG(Z)?e7(Z):O9(h,Z)}class g1{constructor(){this._=void 0}}function P3(h,Z,H){return h instanceof u1?function(G,$){let M={fields:{[F7]:{stringValue:T7},[L7]:{timestampValue:{seconds:G.seconds,nanos:G.nanoseconds}}}};return $&&T9($)&&($=v6($)),$&&(M.fields[R7]=$),{mapValue:M}}(H,Z):h instanceof dh?hH(h,Z):h instanceof oh?ZH(h,Z):function(G,$){let M=a7(G,$),X=R5(M)+R5(G.Ae);return a8(M)&&a8(G.Ae)?e7(X):O9(G.serializer,X)}(h,Z)}function w3(h,Z,H){return h instanceof dh?hH(h,Z):h instanceof oh?ZH(h,Z):H}function a7(h,Z){return h instanceof l1?function(Q){return a8(Q)||function($){return!!$&&"doubleValue"in $}(Q)}(Z)?Z:{integerValue:0}:null}class u1 extends g1{}class dh extends g1{constructor(h){super(),this.elements=h}}function hH(h,Z){let H=HH(Z);for(let Q of h.elements)H.some((G)=>u0(G,Q))||H.push(Q);return{arrayValue:{values:H}}}class oh extends g1{constructor(h){super(),this.elements=h}}function ZH(h,Z){let H=HH(Z);for(let Q of h.elements)H=H.filter((G)=>!u0(G,Q));return{arrayValue:{values:H}}}class l1 extends g1{constructor(h,Z){super(),this.serializer=h,this.Ae=Z}}function R5(h){return e(h.integerValue||h.doubleValue)}function HH(h){return L9(h)&&h.arrayValue.values?h.arrayValue.values.slice():[]}function E3(h,Z){return h.field.isEqual(Z.field)&&function(Q,G){return Q instanceof dh&&G instanceof dh||Q instanceof oh&&G instanceof oh?sh(Q.elements,G.elements,u0):Q instanceof l1&&G instanceof l1?u0(Q.Ae,G.Ae):Q instanceof u1&&G instanceof u1}(h.transform,Z.transform)}class QH{constructor(h,Z){this.version=h,this.transformResults=Z}}class x0{constructor(h,Z){this.updateTime=h,this.exists=Z}static none(){return new x0}static exists(h){return new x0(void 0,h)}static updateTime(h){return new x0(h)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(h){return this.exists===h.exists&&(this.updateTime?!!h.updateTime&&this.updateTime.isEqual(h.updateTime):!h.updateTime)}}function L6(h,Z){return h.updateTime!==void 0?Z.isFoundDocument()&&Z.version.isEqual(h.updateTime):h.exists===void 0||h.exists===Z.isFoundDocument()}class t1{}function KH(h,Z){if(!h.hasLocalMutations||Z&&Z.fields.length===0)return null;if(Z===null)return h.isNoDocument()?new _9(h.key,x0.none()):new ah(h.key,h.data,x0.none());{let H=h.data,Q=y0.empty(),G=new J0(B0.comparator);for(let $ of Z.fields)if(!G.has($)){let M=H.field($);M===null&&$.length>1&&($=$.popLast(),M=H.field($)),M===null?Q.delete($):Q.set($,M),G=G.add($)}return new r0(h.key,Q,new R0(G.toArray()),x0.none())}}function q3(h,Z,H){h instanceof ah?function(G,$,M){let X=G.value.clone(),B=N5(G.fieldTransforms,$,M.transformResults);X.setAll(B),$.convertToFoundDocument(M.version,X).setHasCommittedMutations()}(h,Z,H):h instanceof r0?function(G,$,M){if(!L6(G.precondition,$))return void $.convertToUnknownDocument(M.version);let X=N5(G.fieldTransforms,$,M.transformResults),B=$.data;B.setAll(GH(G)),B.setAll(X),$.convertToFoundDocument(M.version,B).setHasCommittedMutations()}(h,Z,H):function(G,$,M){$.convertToNoDocument(M.version).setHasCommittedMutations()}(0,Z,H)}function C1(h,Z,H,Q){return h instanceof ah?function($,M,X,B){if(!L6($.precondition,M))return X;let V=$.value.clone(),D=S5($.fieldTransforms,B,M);return V.setAll(D),M.convertToFoundDocument(M.version,V).setHasLocalMutations(),null}(h,Z,H,Q):h instanceof r0?function($,M,X,B){if(!L6($.precondition,M))return X;let V=S5($.fieldTransforms,B,M),D=M.data;if(D.setAll(GH($)),D.setAll(V),M.convertToFoundDocument(M.version,D).setHasLocalMutations(),X===null)return null;return X.unionWith($.fieldMask.fields).unionWith($.fieldTransforms.map((F)=>F.field))}(h,Z,H,Q):function($,M,X){if(L6($.precondition,M))return M.convertToNoDocument(M.version).setHasLocalMutations(),null;return X}(h,Z,H)}function y3(h,Z){let H=null;for(let Q of h.fieldTransforms){let G=Z.data.field(Q.field),$=a7(Q.transform,G||null);$!=null&&(H===null&&(H=y0.empty()),H.set(Q.field,$))}return H||null}function L5(h,Z){return h.type===Z.type&&(!!h.key.isEqual(Z.key)&&(!!h.precondition.isEqual(Z.precondition)&&(!!function(Q,G){return Q===void 0&&G===void 0||!(!Q||!G)&&sh(Q,G,($,M)=>E3($,M))}(h.fieldTransforms,Z.fieldTransforms)&&(h.type===0?h.value.isEqual(Z.value):h.type!==1||h.data.isEqual(Z.data)&&h.fieldMask.isEqual(Z.fieldMask)))))}class ah extends t1{constructor(h,Z,H,Q=[]){super(),this.key=h,this.value=Z,this.precondition=H,this.fieldTransforms=Q,this.type=0}getFieldMask(){return null}}class r0 extends t1{constructor(h,Z,H,Q,G=[]){super(),this.key=h,this.data=Z,this.fieldMask=H,this.precondition=Q,this.fieldTransforms=G,this.type=1}getFieldMask(){return this.fieldMask}}function GH(h){let Z=new Map;return h.fieldMask.fields.forEach((H)=>{if(!H.isEmpty()){let Q=h.data.field(H);Z.set(H,Q)}}),Z}function N5(h,Z,H){let Q=new Map;d(h.length===H.length,32656,{Re:H.length,Ve:h.length});for(let G=0;G<H.length;G++){let $=h[G],M=$.transform,X=Z.data.field($.field);Q.set($.field,w3(M,X,H[G]))}return Q}function S5(h,Z,H){let Q=new Map;for(let G of h){let $=G.transform,M=H.data.field(G.field);Q.set(G.field,P3($,M,Z))}return Q}class _9 extends t1{constructor(h,Z){super(),this.key=h,this.precondition=Z,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $H extends t1{constructor(h,Z){super(),this.key=h,this.precondition=Z,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class JH{constructor(h,Z,H,Q){this.batchId=h,this.localWriteTime=Z,this.baseMutations=H,this.mutations=Q}applyToRemoteDocument(h,Z){let H=Z.mutationResults;for(let Q=0;Q<this.mutations.length;Q++){let G=this.mutations[Q];if(G.key.isEqual(h.key))q3(G,h,H[Q])}}applyToLocalView(h,Z){for(let H of this.baseMutations)H.key.isEqual(h.key)&&(Z=C1(H,h,Z,this.localWriteTime));for(let H of this.mutations)H.key.isEqual(h.key)&&(Z=C1(H,h,Z,this.localWriteTime));return Z}applyToLocalDocumentSet(h,Z){let H=b7();return this.mutations.forEach((Q)=>{let G=h.get(Q.key),$=G.overlayedDocument,M=this.applyToLocalView($,G.mutatedFields);M=Z.has(Q.key)?null:M;let X=KH($,M);X!==null&&H.set(Q.key,X),$.isValidDocument()||$.convertToNoDocument(v.min())}),H}keys(){return this.mutations.reduce((h,Z)=>h.add(Z.key),i())}isEqual(h){return this.batchId===h.batchId&&sh(this.mutations,h.mutations,(Z,H)=>L5(Z,H))&&sh(this.baseMutations,h.baseMutations,(Z,H)=>L5(Z,H))}}class A9{constructor(h,Z,H,Q){this.batch=h,this.commitVersion=Z,this.mutationResults=H,this.docVersions=Q}static from(h,Z,H){d(h.mutations.length===H.length,58842,{me:h.mutations.length,fe:H.length});let Q=function(){return V3}(),G=h.mutations;for(let $=0;$<G.length;$++)Q=Q.insert(G[$].key,H[$].version);return new A9(h,Z,H,Q)}}class MH{constructor(h,Z){this.largestBatchId=h,this.mutation=Z}getKey(){return this.mutation.key}isEqual(h){return h!==null&&this.mutation===h.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class WH{constructor(h,Z){this.count=h,this.unchangedNames=Z}}var Z0,g;function T3(h){switch(h){case L.OK:return k(64938);case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0;default:return k(15467,{code:h})}}function XH(h){if(h===void 0)return p0("GRPC error has no .code"),L.UNKNOWN;switch(h){case Z0.OK:return L.OK;case Z0.CANCELLED:return L.CANCELLED;case Z0.UNKNOWN:return L.UNKNOWN;case Z0.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case Z0.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case Z0.INTERNAL:return L.INTERNAL;case Z0.UNAVAILABLE:return L.UNAVAILABLE;case Z0.UNAUTHENTICATED:return L.UNAUTHENTICATED;case Z0.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case Z0.NOT_FOUND:return L.NOT_FOUND;case Z0.ALREADY_EXISTS:return L.ALREADY_EXISTS;case Z0.PERMISSION_DENIED:return L.PERMISSION_DENIED;case Z0.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case Z0.ABORTED:return L.ABORTED;case Z0.OUT_OF_RANGE:return L.OUT_OF_RANGE;case Z0.UNIMPLEMENTED:return L.UNIMPLEMENTED;case Z0.DATA_LOSS:return L.DATA_LOSS;default:return k(39323,{code:h})}}(g=Z0||(Z0={}))[g.OK=0]="OK",g[g.CANCELLED=1]="CANCELLED",g[g.UNKNOWN=2]="UNKNOWN",g[g.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",g[g.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",g[g.NOT_FOUND=5]="NOT_FOUND",g[g.ALREADY_EXISTS=6]="ALREADY_EXISTS",g[g.PERMISSION_DENIED=7]="PERMISSION_DENIED",g[g.UNAUTHENTICATED=16]="UNAUTHENTICATED",g[g.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",g[g.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",g[g.ABORTED=10]="ABORTED",g[g.OUT_OF_RANGE=11]="OUT_OF_RANGE",g[g.UNIMPLEMENTED=12]="UNIMPLEMENTED",g[g.INTERNAL=13]="INTERNAL",g[g.UNAVAILABLE=14]="UNAVAILABLE",g[g.DATA_LOSS=15]="DATA_LOSS";var F3=null;function R3(){return new TextEncoder}var L3=new f0([4294967295,4294967295],0);function C5(h){let Z=R3().encode(h),H=new u8;return H.update(Z),new Uint8Array(H.digest())}function O5(h){let Z=new DataView(h.buffer),H=Z.getUint32(0,!0),Q=Z.getUint32(4,!0),G=Z.getUint32(8,!0),$=Z.getUint32(12,!0);return[new f0([H,Q],0),new f0([G,$],0)]}class j9{constructor(h,Z,H){if(this.bitmap=h,this.padding=Z,this.hashCount=H,Z<0||Z>=8)throw new mh(`Invalid padding: ${Z}`);if(H<0)throw new mh(`Invalid hash count: ${H}`);if(h.length>0&&this.hashCount===0)throw new mh(`Invalid hash count: ${H}`);if(h.length===0&&Z!==0)throw new mh(`Invalid padding when bitmap length is 0: ${Z}`);this.ge=8*h.length-Z,this.pe=f0.fromNumber(this.ge)}ye(h,Z,H){let Q=h.add(Z.multiply(f0.fromNumber(H)));return Q.compare(L3)===1&&(Q=new f0([Q.getBits(0),Q.getBits(1)],0)),Q.modulo(this.pe).toNumber()}we(h){return!!(this.bitmap[Math.floor(h/8)]&1<<h%8)}mightContain(h){if(this.ge===0)return!1;let Z=C5(h),[H,Q]=O5(Z);for(let G=0;G<this.hashCount;G++){let $=this.ye(H,Q,G);if(!this.we($))return!1}return!0}static create(h,Z,H){let Q=h%8==0?0:8-h%8,G=new Uint8Array(Math.ceil(h/8)),$=new j9(G,Q,Z);return H.forEach((M)=>$.insert(M)),$}insert(h){if(this.ge===0)return;let Z=C5(h),[H,Q]=O5(Z);for(let G=0;G<this.hashCount;G++){let $=this.ye(H,Q,G);this.Se($)}}Se(h){let Z=Math.floor(h/8),H=h%8;this.bitmap[Z]|=1<<H}}class mh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class s6{constructor(h,Z,H,Q,G){this.snapshotVersion=h,this.targetChanges=Z,this.targetMismatches=H,this.documentUpdates=Q,this.resolvedLimboDocuments=G}static createSynthesizedRemoteEventForCurrentChange(h,Z,H){let Q=new Map;return Q.set(h,p1.createSynthesizedTargetChangeForCurrentChange(h,Z,H)),new s6(v.min(),Q,new a(s),n0(),i())}}class p1{constructor(h,Z,H,Q,G){this.resumeToken=h,this.current=Z,this.addedDocuments=H,this.modifiedDocuments=Q,this.removedDocuments=G}static createSynthesizedTargetChangeForCurrentChange(h,Z,H){return new p1(H,Z,i(),i(),i())}}class O1{constructor(h,Z,H,Q){this.be=h,this.removedTargetIds=Z,this.key=H,this.De=Q}}class x9{constructor(h,Z){this.targetId=h,this.Ce=Z}}class m9{constructor(h,Z,H=U0.EMPTY_BYTE_STRING,Q=null){this.state=h,this.targetIds=Z,this.resumeToken=H,this.cause=Q}}class Q9{constructor(){this.ve=0,this.Fe=_5(),this.Me=U0.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(h){h.approximateByteSize()>0&&(this.Oe=!0,this.Me=h)}ke(){let h=i(),Z=i(),H=i();return this.Fe.forEach((Q,G)=>{switch(G){case 0:h=h.add(Q);break;case 2:Z=Z.add(Q);break;case 1:H=H.add(Q);break;default:k(38017,{changeType:G})}}),new p1(this.Me,this.xe,h,Z,H)}qe(){this.Oe=!1,this.Fe=_5()}Qe(h,Z){this.Oe=!0,this.Fe=this.Fe.insert(h,Z)}$e(h){this.Oe=!0,this.Fe=this.Fe.remove(h)}Ue(){this.ve+=1}Ke(){this.ve-=1,d(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class BH{constructor(h){this.Ge=h,this.ze=new Map,this.je=n0(),this.Je=y6(),this.He=y6(),this.Ye=new a(s)}Ze(h){for(let Z of h.be)h.De&&h.De.isFoundDocument()?this.Xe(Z,h.De):this.et(Z,h.key,h.De);for(let Z of h.removedTargetIds)this.et(Z,h.key,h.De)}tt(h){this.forEachTarget(h,(Z)=>{let H=this.nt(Z);switch(h.state){case 0:this.rt(Z)&&H.Le(h.resumeToken);break;case 1:H.Ke(),H.Ne||H.qe(),H.Le(h.resumeToken);break;case 2:H.Ke(),H.Ne||this.removeTarget(Z);break;case 3:this.rt(Z)&&(H.We(),H.Le(h.resumeToken));break;case 4:this.rt(Z)&&(this.it(Z),H.Le(h.resumeToken));break;default:k(56790,{state:h.state})}})}forEachTarget(h,Z){h.targetIds.length>0?h.targetIds.forEach(Z):this.ze.forEach((H,Q)=>{this.rt(Q)&&Z(Q)})}st(h){let Z=h.targetId,H=h.Ce.count,Q=this.ot(Z);if(Q){let G=Q.target;if(Z9(G))if(H===0){let $=new m(G.path);this.et(Z,$,I0.newNoDocument($,v.min()))}else d(H===1,20013,{expectedCount:H});else{let $=this._t(Z);if($!==H){let M=this.ut(h),X=M?this.ct(M,h,$):1;if(X!==0){this.it(Z);let B=X===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(Z,B)}F3?.lt(function(V,D,F,y,S){let j={localCacheCount:V,existenceFilterCount:D.count,databaseId:F.database,projectId:F.projectId},_=D.unchangedNames;return _&&(j.bloomFilter={applied:S===0,hashCount:_?.hashCount??0,bitmapLength:_?.bits?.bitmap?.length??0,padding:_?.bits?.padding??0,mightContain:(x)=>y?.mightContain(x)??!1}),j}($,h.Ce,this.Ge.ht(),M,X))}}}}ut(h){let Z=h.Ce.unchangedNames;if(!Z||!Z.bits)return null;let{bits:{bitmap:H="",padding:Q=0},hashCount:G=0}=Z,$,M;try{$=o0(H).toUint8Array()}catch(X){if(X instanceof y9)return lh("Decoding the base64 bloom filter in existence filter failed ("+X.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw X}try{M=new j9($,Q,G)}catch(X){return lh(X instanceof mh?"BloomFilter error: ":"Applying bloom filter failed: ",X),null}return M.ge===0?null:M}ct(h,Z,H){return Z.Ce.count===H-this.Pt(h,Z.targetId)?0:2}Pt(h,Z){let H=this.Ge.getRemoteKeysForTarget(Z),Q=0;return H.forEach((G)=>{let $=this.Ge.ht(),M=`projects/${$.projectId}/databases/${$.database}/documents/${G.path.canonicalString()}`;h.mightContain(M)||(this.et(Z,G,null),Q++)}),Q}Tt(h){let Z=new Map;this.ze.forEach((G,$)=>{let M=this.ot($);if(M){if(G.current&&Z9(M.target)){let X=new m(M.target.path);this.It(X).has($)||this.Et($,X)||this.et($,X,I0.newNoDocument(X,h))}G.Be&&(Z.set($,G.ke()),G.qe())}});let H=i();this.He.forEach((G,$)=>{let M=!0;$.forEachWhile((X)=>{let B=this.ot(X);return!B||B.purpose==="TargetPurposeLimboResolution"||(M=!1,!1)}),M&&(H=H.add(G))}),this.je.forEach((G,$)=>$.setReadTime(h));let Q=new s6(h,Z,this.Ye,this.je,H);return this.je=n0(),this.Je=y6(),this.He=y6(),this.Ye=new a(s),Q}Xe(h,Z){if(!this.rt(h))return;let H=this.Et(h,Z.key)?2:0;this.nt(h).Qe(Z.key,H),this.je=this.je.insert(Z.key,Z),this.Je=this.Je.insert(Z.key,this.It(Z.key).add(h)),this.He=this.He.insert(Z.key,this.dt(Z.key).add(h))}et(h,Z,H){if(!this.rt(h))return;let Q=this.nt(h);this.Et(h,Z)?Q.Qe(Z,1):Q.$e(Z),this.He=this.He.insert(Z,this.dt(Z).delete(h)),this.He=this.He.insert(Z,this.dt(Z).add(h)),H&&(this.je=this.je.insert(Z,H))}removeTarget(h){this.ze.delete(h)}_t(h){let Z=this.nt(h).ke();return this.Ge.getRemoteKeysForTarget(h).size+Z.addedDocuments.size-Z.removedDocuments.size}Ue(h){this.nt(h).Ue()}nt(h){let Z=this.ze.get(h);return Z||(Z=new Q9,this.ze.set(h,Z)),Z}dt(h){let Z=this.He.get(h);return Z||(Z=new J0(s),this.He=this.He.insert(h,Z)),Z}It(h){let Z=this.Je.get(h);return Z||(Z=new J0(s),this.Je=this.Je.insert(h,Z)),Z}rt(h){let Z=this.ot(h)!==null;return Z||A("WatchChangeAggregator","Detected inactive target",h),Z}ot(h){let Z=this.ze.get(h);return Z&&Z.Ne?null:this.Ge.At(h)}it(h){this.ze.set(h,new Q9),this.Ge.getRemoteKeysForTarget(h).forEach((Z)=>{this.et(h,Z,null)})}Et(h,Z){return this.Ge.getRemoteKeysForTarget(h).has(Z)}}function y6(){return new a(m.comparator)}function _5(){return new a(m.comparator)}var N3=(()=>{return{asc:"ASCENDING",desc:"DESCENDING"}})(),S3=(()=>{return{"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}})(),C3=(()=>{return{and:"AND",or:"OR"}})();class UH{constructor(h,Z){this.databaseId=h,this.useProto3Json=Z}}function K9(h,Z){return h.useProto3Json||k6(Z)?Z:{value:Z}}function C6(h,Z){if(h.useProto3Json)return`${new Date(1000*Z.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+Z.nanoseconds).slice(-9)}Z`;return{seconds:""+Z.seconds,nanos:Z.nanoseconds}}function VH(h,Z){return h.useProto3Json?Z.toBase64():Z.toUint8Array()}function O3(h,Z){return C6(h,Z.toTimestamp())}function m0(h){return d(!!h,49232),v.fromTimestamp(function(H){let Q=d0(H);return new b(Q.seconds,Q.nanos)}(h))}function k9(h,Z){return G9(h,Z).canonicalString()}function G9(h,Z){let H=function(G){return new r(["projects",G.projectId,"databases",G.database])}(h).child("documents");return Z===void 0?H:H.child(Z)}function YH(h){let Z=r.fromString(h);return d(wH(Z),10190,{key:Z.toString()}),Z}function $9(h,Z){return k9(h.databaseId,Z.path)}function p8(h,Z){let H=YH(Z);if(H.get(1)!==h.databaseId.projectId)throw new O(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+H.get(1)+" vs "+h.databaseId.projectId);if(H.get(3)!==h.databaseId.database)throw new O(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+H.get(3)+" vs "+h.databaseId.database);return new m(IH(H))}function zH(h,Z){return k9(h.databaseId,Z)}function _3(h){let Z=YH(h);return Z.length===4?r.emptyPath():IH(Z)}function J9(h){return new r(["projects",h.databaseId.projectId,"databases",h.databaseId.database]).canonicalString()}function IH(h){return d(h.length>4&&h.get(4)==="documents",29091,{key:h.toString()}),h.popFirst(5)}function A5(h,Z,H){return{name:$9(h,Z),fields:H.value.mapValue.fields}}function A3(h,Z){let H;if("targetChange"in Z){Z.targetChange;let Q=function(V){return V==="NO_CHANGE"?0:V==="ADD"?1:V==="REMOVE"?2:V==="CURRENT"?3:V==="RESET"?4:k(39313,{state:V})}(Z.targetChange.targetChangeType||"NO_CHANGE"),G=Z.targetChange.targetIds||[],$=function(V,D){return V.useProto3Json?(d(D===void 0||typeof D=="string",58123),U0.fromBase64String(D||"")):(d(D===void 0||D instanceof Buffer||D instanceof Uint8Array,16193),U0.fromUint8Array(D||new Uint8Array))}(h,Z.targetChange.resumeToken),M=Z.targetChange.cause,X=M&&function(V){let D=V.code===void 0?L.UNKNOWN:XH(V.code);return new O(D,V.message||"")}(M);H=new m9(Q,G,$,X||null)}else if("documentChange"in Z){Z.documentChange;let Q=Z.documentChange;Q.document,Q.document.name,Q.document.updateTime;let G=p8(h,Q.document.name),$=m0(Q.document.updateTime),M=Q.document.createTime?m0(Q.document.createTime):v.min(),X=new y0({mapValue:{fields:Q.document.fields}}),B=I0.newFoundDocument(G,$,M,X),V=Q.targetIds||[],D=Q.removedTargetIds||[];H=new O1(V,D,B.key,B)}else if("documentDelete"in Z){Z.documentDelete;let Q=Z.documentDelete;Q.document;let G=p8(h,Q.document),$=Q.readTime?m0(Q.readTime):v.min(),M=I0.newNoDocument(G,$),X=Q.removedTargetIds||[];H=new O1([],X,M.key,M)}else if("documentRemove"in Z){Z.documentRemove;let Q=Z.documentRemove;Q.document;let G=p8(h,Q.document),$=Q.removedTargetIds||[];H=new O1([],$,G,null)}else{if(!("filter"in Z))return k(11601,{Rt:Z});{Z.filter;let Q=Z.filter;Q.targetId;let{count:G=0,unchangedNames:$}=Q,M=new WH(G,$),X=Q.targetId;H=new x9(X,M)}}return H}function j3(h,Z){let H;if(Z instanceof ah)H={update:A5(h,Z.key,Z.value)};else if(Z instanceof _9)H={delete:$9(h,Z.key)};else if(Z instanceof r0)H={update:A5(h,Z.key,Z.data),updateMask:f3(Z.fieldMask)};else{if(!(Z instanceof $H))return k(16599,{Vt:Z.type});H={verify:$9(h,Z.key)}}return Z.fieldTransforms.length>0&&(H.updateTransforms=Z.fieldTransforms.map((Q)=>function($,M){let X=M.transform;if(X instanceof u1)return{fieldPath:M.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(X instanceof dh)return{fieldPath:M.field.canonicalString(),appendMissingElements:{values:X.elements}};if(X instanceof oh)return{fieldPath:M.field.canonicalString(),removeAllFromArray:{values:X.elements}};if(X instanceof l1)return{fieldPath:M.field.canonicalString(),increment:X.Ae};throw k(20930,{transform:M.transform})}(0,Q))),Z.precondition.isNone||(H.currentDocument=function(G,$){return $.updateTime!==void 0?{updateTime:O3(G,$.updateTime)}:$.exists!==void 0?{exists:$.exists}:k(27497)}(h,Z.precondition)),H}function x3(h,Z){return h&&h.length>0?(d(Z!==void 0,14353),h.map((H)=>function(G,$){let M=G.updateTime?m0(G.updateTime):m0($);return M.isEqual(v.min())&&(M=m0($)),new QH(M,G.transformResults||[])}(H,Z))):[]}function m3(h,Z){return{documents:[zH(h,Z.path)]}}function k3(h,Z){let H={structuredQuery:{}},Q=Z.path,G;Z.collectionGroup!==null?(G=Q,H.structuredQuery.from=[{collectionId:Z.collectionGroup,allDescendants:!0}]):(G=Q.popLast(),H.structuredQuery.from=[{collectionId:Q.lastSegment()}]),H.parent=zH(h,G);let $=function(V){if(V.length===0)return;return PH(N0.create(V,"and"))}(Z.filters);$&&(H.structuredQuery.where=$);let M=function(V){if(V.length===0)return;return V.map((D)=>function(y){return{field:jh(y.field),direction:l3(y.dir)}}(D))}(Z.orderBy);M&&(H.structuredQuery.orderBy=M);let X=K9(h,Z.limit);return X!==null&&(H.structuredQuery.limit=X),Z.startAt&&(H.structuredQuery.startAt=function(V){return{before:V.inclusive,values:V.position}}(Z.startAt)),Z.endAt&&(H.structuredQuery.endAt=function(V){return{before:!V.inclusive,values:V.position}}(Z.endAt)),{ft:H,parent:G}}function v3(h){let Z=_3(h.parent),H=h.structuredQuery,Q=H.from?H.from.length:0,G=null;if(Q>0){d(Q===1,65062);let D=H.from[0];D.allDescendants?G=D.collectionId:Z=Z.child(D.collectionId)}let $=[];H.where&&($=function(F){let y=DH(F);if(y instanceof N0&&j7(y))return y.getFilters();return[y]}(H.where));let M=[];H.orderBy&&(M=function(F){return F.map((y)=>function(j){return new ph(xh(j.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(j.direction))}(y))}(H.orderBy));let X=null;H.limit&&(X=function(F){let y;return y=typeof F=="object"?F.value:F,k6(y)?null:y}(H.limit));let B=null;H.startAt&&(B=function(F){let y=!!F.before,S=F.values||[];return new v1(S,y)}(H.startAt));let V=null;return H.endAt&&(V=function(F){let y=!F.before,S=F.values||[];return new v1(S,y)}(H.endAt)),M3(Z,G,M,$,X,"F",B,V)}function u3(h,Z){let H=function(G){switch(G){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return k(28987,{purpose:G})}}(Z.purpose);return H==null?null:{"goog-listen-tags":H}}function DH(h){return h.unaryFilter!==void 0?function(H){switch(H.unaryFilter.op){case"IS_NAN":let Q=xh(H.unaryFilter.field);return H0.create(Q,"==",{doubleValue:NaN});case"IS_NULL":let G=xh(H.unaryFilter.field);return H0.create(G,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let $=xh(H.unaryFilter.field);return H0.create($,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let M=xh(H.unaryFilter.field);return H0.create(M,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return k(61313);default:return k(60726)}}(h):h.fieldFilter!==void 0?function(H){return H0.create(xh(H.fieldFilter.field),function(G){switch(G){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return k(58110);default:return k(50506)}}(H.fieldFilter.op),H.fieldFilter.value)}(h):h.compositeFilter!==void 0?function(H){return N0.create(H.compositeFilter.filters.map((Q)=>DH(Q)),function(G){switch(G){case"AND":return"and";case"OR":return"or";default:return k(1026)}}(H.compositeFilter.op))}(h):k(30097,{filter:h})}function l3(h){return N3[h]}function s3(h){return S3[h]}function i3(h){return C3[h]}function jh(h){return{fieldPath:h.canonicalString()}}function xh(h){return B0.fromServerFormat(h.fieldPath)}function PH(h){return h instanceof H0?function(H){if(H.op==="=="){if(E5(H.value))return{unaryFilter:{field:jh(H.field),op:"IS_NAN"}};if(w5(H.value))return{unaryFilter:{field:jh(H.field),op:"IS_NULL"}}}else if(H.op==="!="){if(E5(H.value))return{unaryFilter:{field:jh(H.field),op:"IS_NOT_NAN"}};if(w5(H.value))return{unaryFilter:{field:jh(H.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jh(H.field),op:s3(H.op),value:H.value}}}(h):h instanceof N0?function(H){let Q=H.getFilters().map((G)=>PH(G));if(Q.length===1)return Q[0];return{compositeFilter:{op:i3(H.op),filters:Q}}}(h):k(54877,{filter:h})}function f3(h){let Z=[];return h.fields.forEach((H)=>Z.push(H.canonicalString())),{fieldPaths:Z}}function wH(h){return h.length>=4&&h.get(0)==="projects"&&h.get(2)==="databases"}class $h{constructor(h,Z,H,Q,G=v.min(),$=v.min(),M=U0.EMPTY_BYTE_STRING,X=null){this.target=h,this.targetId=Z,this.purpose=H,this.sequenceNumber=Q,this.snapshotVersion=G,this.lastLimboFreeSnapshotVersion=$,this.resumeToken=M,this.expectedCount=X}withSequenceNumber(h){return new $h(this.target,this.targetId,this.purpose,h,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(h,Z){return new $h(this.target,this.targetId,this.purpose,this.sequenceNumber,Z,this.lastLimboFreeSnapshotVersion,h,null)}withExpectedCount(h){return new $h(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,h)}withLastLimboFreeSnapshotVersion(h){return new $h(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,h,this.resumeToken,this.expectedCount)}}class EH{constructor(h){this.yt=h}}function g3(h){let Z=v3({parent:h.parent,structuredQuery:h.structuredQuery});return h.limitType==="LAST"?S6(Z,Z.limit,"L"):Z}class M9{constructor(){}Dt(h,Z){this.Ct(h,Z),Z.vt()}Ct(h,Z){if("nullValue"in h)this.Ft(Z,5);else if("booleanValue"in h)this.Ft(Z,10),Z.Mt(h.booleanValue?1:0);else if("integerValue"in h)this.Ft(Z,15),Z.Mt(e(h.integerValue));else if("doubleValue"in h){let H=e(h.doubleValue);isNaN(H)?this.Ft(Z,13):(this.Ft(Z,15),j1(H)?Z.Mt(0):Z.Mt(H))}else if("timestampValue"in h){let H=h.timestampValue;this.Ft(Z,20),typeof H=="string"&&(H=d0(H)),Z.xt(`${H.seconds||""}`),Z.Mt(H.nanos||0)}else if("stringValue"in h)this.Ot(h.stringValue,Z),this.Nt(Z);else if("bytesValue"in h)this.Ft(Z,30),Z.Bt(o0(h.bytesValue)),this.Nt(Z);else if("referenceValue"in h)this.Lt(h.referenceValue,Z);else if("geoPointValue"in h){let H=h.geoPointValue;this.Ft(Z,45),Z.Mt(H.latitude||0),Z.Mt(H.longitude||0)}else"mapValue"in h?O7(h)?this.Ft(Z,Number.MAX_SAFE_INTEGER):C7(h)?this.kt(h.mapValue,Z):(this.qt(h.mapValue,Z),this.Nt(Z)):("arrayValue"in h)?(this.Qt(h.arrayValue,Z),this.Nt(Z)):k(19022,{$t:h})}Ot(h,Z){this.Ft(Z,25),this.Ut(h,Z)}Ut(h,Z){Z.xt(h)}qt(h,Z){let H=h.fields||{};this.Ft(Z,55);for(let Q of Object.keys(H))this.Ot(Q,Z),this.Ct(H[Q],Z)}kt(h,Z){let H=h.fields||{};this.Ft(Z,53);let Q=fh,G=H[Q].arrayValue?.values?.length||0;this.Ft(Z,15),Z.Mt(e(G)),this.Ot(Q,Z),this.Ct(H[Q],Z)}Qt(h,Z){let H=h.values||[];this.Ft(Z,50);for(let Q of H)this.Ct(Q,Z)}Lt(h,Z){this.Ft(Z,37),m.fromName(h).path.forEach((H)=>{this.Ft(Z,60),this.Ut(H,Z)})}Ft(h,Z){h.Mt(Z)}Nt(h){h.Mt(2)}}M9.Kt=new M9;class qH{constructor(){this.Cn=new yH}addToCollectionParentIndex(h,Z){return this.Cn.add(Z),N.resolve()}getCollectionParents(h,Z){return N.resolve(this.Cn.getEntries(Z))}addFieldIndex(h,Z){return N.resolve()}deleteFieldIndex(h,Z){return N.resolve()}deleteAllFieldIndexes(h){return N.resolve()}createTargetIndexes(h,Z){return N.resolve()}getDocumentsMatchingTarget(h,Z){return N.resolve(null)}getIndexType(h,Z){return N.resolve(0)}getFieldIndexes(h,Z){return N.resolve([])}getNextCollectionGroupToUpdate(h){return N.resolve(null)}getMinOffset(h,Z){return N.resolve(Mh.min())}getMinOffsetFromCollectionGroup(h,Z){return N.resolve(Mh.min())}updateCollectionGroup(h,Z,H){return N.resolve()}updateIndexEntries(h,Z){return N.resolve()}}class yH{constructor(){this.index={}}add(h){let Z=h.lastSegment(),H=h.popLast(),Q=this.index[Z]||new J0(r.comparator),G=!Q.has(H);return this.index[Z]=Q.add(H),G}has(h){let Z=h.lastSegment(),H=h.popLast(),Q=this.index[Z];return Q&&Q.has(H)}getEntries(h){return(this.index[h]||new J0(r.comparator)).toArray()}}var AJ=new Uint8Array(0);var j5={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},TH=41943040;class q0{static withCacheSize(h){return new q0(h,q0.DEFAULT_COLLECTION_PERCENTILE,q0.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(h,Z,H){this.cacheSizeCollectionThreshold=h,this.percentileToCollect=Z,this.maximumSequenceNumbersToCollect=H}}q0.DEFAULT_COLLECTION_PERCENTILE=10,q0.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1000,q0.DEFAULT=new q0(TH,q0.DEFAULT_COLLECTION_PERCENTILE,q0.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),q0.DISABLED=new q0(-1,0,0);class nh{constructor(h){this.ar=h}next(){return this.ar+=2,this.ar}static ur(){return new nh(0)}static cr(){return new nh(-1)}}var x5="LruGarbageCollector",t3=1048576;function m5([h,Z],[H,Q]){let G=s(h,H);return G===0?s(Z,Q):G}class FH{constructor(h){this.Ir=h,this.buffer=new J0(m5),this.Er=0}dr(){return++this.Er}Ar(h){let Z=[h,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(Z);else{let H=this.buffer.last();m5(Z,H)<0&&(this.buffer=this.buffer.delete(H).add(Z))}}get maxValue(){return this.buffer.last()[0]}}class RH{constructor(h,Z,H){this.garbageCollector=h,this.asyncQueue=Z,this.localStore=H,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(60000)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(h){A(x5,`Garbage collection scheduled in ${h}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",h,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(Z){eh(Z)?A(x5,"Ignoring IndexedDB error during garbage collection: ",Z):await bh(Z)}await this.Vr(300000)})}}class LH{constructor(h,Z){this.mr=h,this.params=Z}calculateTargetCount(h,Z){return this.mr.gr(h).next((H)=>Math.floor(Z/100*H))}nthSequenceNumber(h,Z){if(Z===0)return N.resolve(f1.ce);let H=new FH(Z);return this.mr.forEachTarget(h,(Q)=>H.Ar(Q.sequenceNumber)).next(()=>this.mr.pr(h,(Q)=>H.Ar(Q))).next(()=>H.maxValue)}removeTargets(h,Z,H){return this.mr.removeTargets(h,Z,H)}removeOrphanedDocuments(h,Z){return this.mr.removeOrphanedDocuments(h,Z)}collect(h,Z){return this.params.cacheSizeCollectionThreshold===-1?(A("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(j5)):this.getCacheSize(h).next((H)=>H<this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector",`Garbage collection skipped; Cache size ${H} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),j5):this.yr(h,Z))}getCacheSize(h){return this.mr.getCacheSize(h)}yr(h,Z){let H,Q,G,$,M,X,B,V=Date.now();return this.calculateTargetCount(h,this.params.percentileToCollect).next((D)=>(D>this.params.maximumSequenceNumbersToCollect?(A("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${D}`),Q=this.params.maximumSequenceNumbersToCollect):Q=D,$=Date.now(),this.nthSequenceNumber(h,Q))).next((D)=>(H=D,M=Date.now(),this.removeTargets(h,H,Z))).next((D)=>(G=D,X=Date.now(),this.removeOrphanedDocuments(h,H))).next((D)=>{if(B=Date.now(),_h()<=f.DEBUG)A("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${$-V}ms
	Determined least recently used ${Q} in `+(M-$)+`ms
	Removed ${G} targets in `+(X-M)+`ms
	Removed ${D} documents in `+(B-X)+`ms
Total Duration: ${B-V}ms`);return N.resolve({didRun:!0,sequenceNumbersCollected:Q,targetsRemoved:G,documentsRemoved:D})})}}function p3(h,Z){return new LH(h,Z)}class NH{constructor(){this.changes=new Vh((h)=>h.toString(),(h,Z)=>h.isEqual(Z)),this.changesApplied=!1}addEntry(h){this.assertNotApplied(),this.changes.set(h.key,h)}removeEntry(h,Z){this.assertNotApplied(),this.changes.set(h,I0.newInvalidDocument(h).setReadTime(Z))}getEntry(h,Z){this.assertNotApplied();let H=this.changes.get(Z);return H!==void 0?N.resolve(H):this.getFromCache(h,Z)}getEntries(h,Z){return this.getAllFromCache(h,Z)}apply(h){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(h)}assertNotApplied(){}}class SH{constructor(h,Z){this.overlayedDocument=h,this.mutatedFields=Z}}class CH{constructor(h,Z,H,Q){this.remoteDocumentCache=h,this.mutationQueue=Z,this.documentOverlayCache=H,this.indexManager=Q}getDocument(h,Z){let H=null;return this.documentOverlayCache.getOverlay(h,Z).next((Q)=>(H=Q,this.remoteDocumentCache.getEntry(h,Z))).next((Q)=>(H!==null&&C1(H.mutation,Q,R0.empty(),b.now()),Q))}getDocuments(h,Z){return this.remoteDocumentCache.getEntries(h,Z).next((H)=>this.getLocalViewOfDocuments(h,H,i()).next(()=>H))}getLocalViewOfDocuments(h,Z,H=i()){let Q=qh();return this.populateOverlays(h,Q,Z).next(()=>this.computeViews(h,Z,Q,H).next((G)=>{let $=F1();return G.forEach((M,X)=>{$=$.insert(M,X.overlayedDocument)}),$}))}getOverlayedDocuments(h,Z){let H=qh();return this.populateOverlays(h,H,Z).next(()=>this.computeViews(h,Z,H,i()))}populateOverlays(h,Z,H){let Q=[];return H.forEach((G)=>{Z.has(G)||Q.push(G)}),this.documentOverlayCache.getOverlays(h,Q).next((G)=>{G.forEach(($,M)=>{Z.set($,M)})})}computeViews(h,Z,H,Q){let G=n0(),$=S1(),M=function(){return S1()}();return Z.forEach((X,B)=>{let V=H.get(B.key);Q.has(B.key)&&(V===void 0||V.mutation instanceof r0)?G=G.insert(B.key,B):V!==void 0?($.set(B.key,V.mutation.getFieldMask()),C1(V.mutation,B,V.mutation.getFieldMask(),b.now())):$.set(B.key,R0.empty())}),this.recalculateAndSaveOverlays(h,G).next((X)=>(X.forEach((B,V)=>$.set(B,V)),Z.forEach((B,V)=>M.set(B,new SH(V,$.get(B)??null))),M))}recalculateAndSaveOverlays(h,Z){let H=S1(),Q=new a(($,M)=>$-M),G=i();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(h,Z).next(($)=>{for(let M of $)M.keys().forEach((X)=>{let B=Z.get(X);if(B===null)return;let V=H.get(X)||R0.empty();V=M.applyToLocalView(B,V),H.set(X,V);let D=(Q.get(M.batchId)||i()).add(X);Q=Q.insert(M.batchId,D)})}).next(()=>{let $=[],M=Q.getReverseIterator();for(;M.hasNext();){let X=M.getNext(),B=X.key,V=X.value,D=b7();V.forEach((F)=>{if(!G.has(F)){let y=KH(Z.get(F),H.get(F));y!==null&&D.set(F,y),G=G.add(F)}}),$.push(this.documentOverlayCache.saveOverlays(h,B,D))}return N.waitFor($)}).next(()=>H)}recalculateAndSaveOverlaysForDocumentKeys(h,Z){return this.remoteDocumentCache.getEntries(h,Z).next((H)=>this.recalculateAndSaveOverlays(h,H))}getDocumentsMatchingQuery(h,Z,H,Q){return function($){return m.isDocumentKey($.path)&&$.collectionGroup===null&&$.filters.length===0}(Z)?this.getDocumentsMatchingDocumentQuery(h,Z.path):d7(Z)?this.getDocumentsMatchingCollectionGroupQuery(h,Z,H,Q):this.getDocumentsMatchingCollectionQuery(h,Z,H,Q)}getNextDocuments(h,Z,H,Q){return this.remoteDocumentCache.getAllFromCollectionGroup(h,Z,H,Q).next((G)=>{let $=Q-G.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(h,Z,H.largestBatchId,Q-G.size):N.resolve(qh()),M=A1,X=G;return $.next((B)=>N.forEach(B,(V,D)=>(M<D.largestBatchId&&(M=D.largestBatchId),G.get(V)?N.resolve():this.remoteDocumentCache.getEntry(h,V).next((F)=>{X=X.insert(V,F)}))).next(()=>this.populateOverlays(h,B,G)).next(()=>this.computeViews(h,X,B,i())).next((V)=>({batchId:M,changes:c7(V)})))})}getDocumentsMatchingDocumentQuery(h,Z){return this.getDocument(h,new m(Z)).next((H)=>{let Q=F1();return H.isFoundDocument()&&(Q=Q.insert(H.key,H)),Q})}getDocumentsMatchingCollectionGroupQuery(h,Z,H,Q){let G=Z.collectionGroup,$=F1();return this.indexManager.getCollectionParents(h,G).next((M)=>N.forEach(M,(X)=>{let B=function(D,F){return new Fh(F,null,D.explicitOrderBy.slice(),D.filters.slice(),D.limit,D.limitType,D.startAt,D.endAt)}(Z,X.child(G));return this.getDocumentsMatchingCollectionQuery(h,B,H,Q).next((V)=>{V.forEach((D,F)=>{$=$.insert(D,F)})})}).next(()=>$))}getDocumentsMatchingCollectionQuery(h,Z,H,Q){let G;return this.documentOverlayCache.getOverlaysForCollection(h,Z.path,H.largestBatchId).next(($)=>(G=$,this.remoteDocumentCache.getDocumentsMatchingQuery(h,Z,H,G,Q))).next(($)=>{G.forEach((X,B)=>{let V=B.getKey();$.get(V)===null&&($=$.insert(V,I0.newInvalidDocument(V)))});let M=F1();return $.forEach((X,B)=>{let V=G.get(X);V!==void 0&&C1(V.mutation,B,R0.empty(),b.now()),l6(Z,B)&&(M=M.insert(X,B))}),M})}}class OH{constructor(h){this.serializer=h,this.Lr=new Map,this.kr=new Map}getBundleMetadata(h,Z){return N.resolve(this.Lr.get(Z))}saveBundleMetadata(h,Z){return this.Lr.set(Z.id,function(Q){return{id:Q.id,version:Q.version,createTime:m0(Q.createTime)}}(Z)),N.resolve()}getNamedQuery(h,Z){return N.resolve(this.kr.get(Z))}saveNamedQuery(h,Z){return this.kr.set(Z.name,function(Q){return{name:Q.name,query:g3(Q.bundledQuery),readTime:m0(Q.readTime)}}(Z)),N.resolve()}}class _H{constructor(){this.overlays=new a(m.comparator),this.qr=new Map}getOverlay(h,Z){return N.resolve(this.overlays.get(Z))}getOverlays(h,Z){let H=qh();return N.forEach(Z,(Q)=>this.getOverlay(h,Q).next((G)=>{G!==null&&H.set(Q,G)})).next(()=>H)}saveOverlays(h,Z,H){return H.forEach((Q,G)=>{this.St(h,Z,G)}),N.resolve()}removeOverlaysForBatchId(h,Z,H){let Q=this.qr.get(H);return Q!==void 0&&(Q.forEach((G)=>this.overlays=this.overlays.remove(G)),this.qr.delete(H)),N.resolve()}getOverlaysForCollection(h,Z,H){let Q=qh(),G=Z.length+1,$=new m(Z.child("")),M=this.overlays.getIteratorFrom($);for(;M.hasNext();){let X=M.getNext().value,B=X.getKey();if(!Z.isPrefixOf(B.path))break;B.path.length===G&&(X.largestBatchId>H&&Q.set(X.getKey(),X))}return N.resolve(Q)}getOverlaysForCollectionGroup(h,Z,H,Q){let G=new a((B,V)=>B-V),$=this.overlays.getIterator();for(;$.hasNext();){let B=$.getNext().value;if(B.getKey().getCollectionGroup()===Z&&B.largestBatchId>H){let V=G.get(B.largestBatchId);V===null&&(V=qh(),G=G.insert(B.largestBatchId,V)),V.set(B.getKey(),B)}}let M=qh(),X=G.getIterator();for(;X.hasNext();)if(X.getNext().value.forEach((B,V)=>M.set(B,V)),M.size()>=Q)break;return N.resolve(M)}St(h,Z,H){let Q=this.overlays.get(H.key);if(Q!==null){let $=this.qr.get(Q.largestBatchId).delete(H.key);this.qr.set(Q.largestBatchId,$)}this.overlays=this.overlays.insert(H.key,new MH(Z,H));let G=this.qr.get(Z);G===void 0&&(G=i(),this.qr.set(Z,G)),this.qr.set(Z,G.add(H.key))}}class AH{constructor(){this.sessionToken=U0.EMPTY_BYTE_STRING}getSessionToken(h){return N.resolve(this.sessionToken)}setSessionToken(h,Z){return this.sessionToken=Z,N.resolve()}}class i6{constructor(){this.Qr=new J0(G0.$r),this.Ur=new J0(G0.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(h,Z){let H=new G0(h,Z);this.Qr=this.Qr.add(H),this.Ur=this.Ur.add(H)}Wr(h,Z){h.forEach((H)=>this.addReference(H,Z))}removeReference(h,Z){this.Gr(new G0(h,Z))}zr(h,Z){h.forEach((H)=>this.removeReference(H,Z))}jr(h){let Z=new m(new r([])),H=new G0(Z,h),Q=new G0(Z,h+1),G=[];return this.Ur.forEachInRange([H,Q],($)=>{this.Gr($),G.push($.key)}),G}Jr(){this.Qr.forEach((h)=>this.Gr(h))}Gr(h){this.Qr=this.Qr.delete(h),this.Ur=this.Ur.delete(h)}Hr(h){let Z=new m(new r([])),H=new G0(Z,h),Q=new G0(Z,h+1),G=i();return this.Ur.forEachInRange([H,Q],($)=>{G=G.add($.key)}),G}containsKey(h){let Z=new G0(h,0),H=this.Qr.firstAfterOrEqual(Z);return H!==null&&h.isEqual(H.key)}}class G0{constructor(h,Z){this.key=h,this.Yr=Z}static $r(h,Z){return m.comparator(h.key,Z.key)||s(h.Yr,Z.Yr)}static Kr(h,Z){return s(h.Yr,Z.Yr)||m.comparator(h.key,Z.key)}}class jH{constructor(h,Z){this.indexManager=h,this.referenceDelegate=Z,this.mutationQueue=[],this.tr=1,this.Zr=new J0(G0.$r)}checkEmpty(h){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(h,Z,H,Q){let G=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let $=new JH(G,Z,H,Q);this.mutationQueue.push($);for(let M of Q)this.Zr=this.Zr.add(new G0(M.key,G)),this.indexManager.addToCollectionParentIndex(h,M.key.path.popLast());return N.resolve($)}lookupMutationBatch(h,Z){return N.resolve(this.Xr(Z))}getNextMutationBatchAfterBatchId(h,Z){let H=Z+1,Q=this.ei(H),G=Q<0?0:Q;return N.resolve(this.mutationQueue.length>G?this.mutationQueue[G]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?q9:this.tr-1)}getAllMutationBatches(h){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(h,Z){let H=new G0(Z,0),Q=new G0(Z,Number.POSITIVE_INFINITY),G=[];return this.Zr.forEachInRange([H,Q],($)=>{let M=this.Xr($.Yr);G.push(M)}),N.resolve(G)}getAllMutationBatchesAffectingDocumentKeys(h,Z){let H=new J0(s);return Z.forEach((Q)=>{let G=new G0(Q,0),$=new G0(Q,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([G,$],(M)=>{H=H.add(M.Yr)})}),N.resolve(this.ti(H))}getAllMutationBatchesAffectingQuery(h,Z){let H=Z.path,Q=H.length+1,G=H;m.isDocumentKey(G)||(G=G.child(""));let $=new G0(new m(G),0),M=new J0(s);return this.Zr.forEachWhile((X)=>{let B=X.key.path;return!!H.isPrefixOf(B)&&(B.length===Q&&(M=M.add(X.Yr)),!0)},$),N.resolve(this.ti(M))}ti(h){let Z=[];return h.forEach((H)=>{let Q=this.Xr(H);Q!==null&&Z.push(Q)}),Z}removeMutationBatch(h,Z){d(this.ni(Z.batchId,"removed")===0,55003),this.mutationQueue.shift();let H=this.Zr;return N.forEach(Z.mutations,(Q)=>{let G=new G0(Q.key,Z.batchId);return H=H.delete(G),this.referenceDelegate.markPotentiallyOrphaned(h,Q.key)}).next(()=>{this.Zr=H})}ir(h){}containsKey(h,Z){let H=new G0(Z,0),Q=this.Zr.firstAfterOrEqual(H);return N.resolve(Z.isEqual(Q&&Q.key))}performConsistencyCheck(h){return this.mutationQueue.length,N.resolve()}ni(h,Z){return this.ei(h)}ei(h){if(this.mutationQueue.length===0)return 0;return h-this.mutationQueue[0].batchId}Xr(h){let Z=this.ei(h);if(Z<0||Z>=this.mutationQueue.length)return null;return this.mutationQueue[Z]}}class xH{constructor(h){this.ri=h,this.docs=function(){return new a(m.comparator)}(),this.size=0}setIndexManager(h){this.indexManager=h}addEntry(h,Z){let H=Z.key,Q=this.docs.get(H),G=Q?Q.size:0,$=this.ri(Z);return this.docs=this.docs.insert(H,{document:Z.mutableCopy(),size:$}),this.size+=$-G,this.indexManager.addToCollectionParentIndex(h,H.path.popLast())}removeEntry(h){let Z=this.docs.get(h);Z&&(this.docs=this.docs.remove(h),this.size-=Z.size)}getEntry(h,Z){let H=this.docs.get(Z);return N.resolve(H?H.document.mutableCopy():I0.newInvalidDocument(Z))}getEntries(h,Z){let H=n0();return Z.forEach((Q)=>{let G=this.docs.get(Q);H=H.insert(Q,G?G.document.mutableCopy():I0.newInvalidDocument(Q))}),N.resolve(H)}getDocumentsMatchingQuery(h,Z,H,Q){let G=n0(),$=Z.path,M=new m($.child("__id-9223372036854775808__")),X=this.docs.getIteratorFrom(M);for(;X.hasNext();){let{key:B,value:{document:V}}=X.getNext();if(!$.isPrefixOf(B.path))break;B.path.length>$.length+1||(gG(fG(V),H)<=0||(Q.has(V.key)||l6(Z,V))&&(G=G.insert(V.key,V.mutableCopy())))}return N.resolve(G)}getAllFromCollectionGroup(h,Z,H,Q){k(9500)}ii(h,Z){return N.forEach(this.docs,(H)=>Z(H))}newChangeBuffer(h){return new mH(this)}getSize(h){return N.resolve(this.size)}}class mH extends NH{constructor(h){super(),this.Nr=h}applyChanges(h){let Z=[];return this.changes.forEach((H,Q)=>{Q.isValidDocument()?Z.push(this.Nr.addEntry(h,Q)):this.Nr.removeEntry(H)}),N.waitFor(Z)}getFromCache(h,Z){return this.Nr.getEntry(h,Z)}getAllFromCache(h,Z){return this.Nr.getEntries(h,Z)}}class kH{constructor(h){this.persistence=h,this.si=new Vh((Z)=>S9(Z),C9),this.lastRemoteSnapshotVersion=v.min(),this.highestTargetId=0,this.oi=0,this._i=new i6,this.targetCount=0,this.ai=nh.ur()}forEachTarget(h,Z){return this.si.forEach((H,Q)=>Z(Q)),N.resolve()}getLastRemoteSnapshotVersion(h){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(h){return N.resolve(this.oi)}allocateTargetId(h){return this.highestTargetId=this.ai.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(h,Z,H){return H&&(this.lastRemoteSnapshotVersion=H),Z>this.oi&&(this.oi=Z),N.resolve()}Pr(h){this.si.set(h.target,h);let Z=h.targetId;Z>this.highestTargetId&&(this.ai=new nh(Z),this.highestTargetId=Z),h.sequenceNumber>this.oi&&(this.oi=h.sequenceNumber)}addTargetData(h,Z){return this.Pr(Z),this.targetCount+=1,N.resolve()}updateTargetData(h,Z){return this.Pr(Z),N.resolve()}removeTargetData(h,Z){return this.si.delete(Z.target),this._i.jr(Z.targetId),this.targetCount-=1,N.resolve()}removeTargets(h,Z,H){let Q=0,G=[];return this.si.forEach(($,M)=>{M.sequenceNumber<=Z&&H.get(M.targetId)===null&&(this.si.delete($),G.push(this.removeMatchingKeysForTargetId(h,M.targetId)),Q++)}),N.waitFor(G).next(()=>Q)}getTargetCount(h){return N.resolve(this.targetCount)}getTargetData(h,Z){let H=this.si.get(Z)||null;return N.resolve(H)}addMatchingKeys(h,Z,H){return this._i.Wr(Z,H),N.resolve()}removeMatchingKeys(h,Z,H){this._i.zr(Z,H);let Q=this.persistence.referenceDelegate,G=[];return Q&&Z.forEach(($)=>{G.push(Q.markPotentiallyOrphaned(h,$))}),N.waitFor(G)}removeMatchingKeysForTargetId(h,Z){return this._i.jr(Z),N.resolve()}getMatchingKeysForTargetId(h,Z){let H=this._i.Hr(Z);return N.resolve(H)}containsKey(h,Z){return N.resolve(this._i.containsKey(Z))}}class v9{constructor(h,Z){this.ui={},this.overlays={},this.ci=new f1(0),this.li=!1,this.li=!0,this.hi=new AH,this.referenceDelegate=h(this),this.Pi=new kH(this),this.indexManager=new qH,this.remoteDocumentCache=function(Q){return new xH(Q)}((H)=>this.referenceDelegate.Ti(H)),this.serializer=new EH(Z),this.Ii=new OH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(h){return this.indexManager}getDocumentOverlayCache(h){let Z=this.overlays[h.toKey()];return Z||(Z=new _H,this.overlays[h.toKey()]=Z),Z}getMutationQueue(h,Z){let H=this.ui[h.toKey()];return H||(H=new jH(Z,this.referenceDelegate),this.ui[h.toKey()]=H),H}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(h,Z,H){A("MemoryPersistence","Starting transaction:",h);let Q=new vH(this.ci.next());return this.referenceDelegate.Ei(),H(Q).next((G)=>this.referenceDelegate.di(Q).next(()=>G)).toPromise().then((G)=>(Q.raiseOnCommittedEvent(),G))}Ai(h,Z){return N.or(Object.values(this.ui).map((H)=>()=>H.containsKey(h,Z)))}}class vH extends J7{constructor(h){super(),this.currentSequenceNumber=h}}class u9{constructor(h){this.persistence=h,this.Ri=new i6,this.Vi=null}static mi(h){return new u9(h)}get fi(){if(this.Vi)return this.Vi;throw k(60996)}addReference(h,Z,H){return this.Ri.addReference(H,Z),this.fi.delete(H.toString()),N.resolve()}removeReference(h,Z,H){return this.Ri.removeReference(H,Z),this.fi.add(H.toString()),N.resolve()}markPotentiallyOrphaned(h,Z){return this.fi.add(Z.toString()),N.resolve()}removeTarget(h,Z){this.Ri.jr(Z.targetId).forEach((Q)=>this.fi.add(Q.toString()));let H=this.persistence.getTargetCache();return H.getMatchingKeysForTargetId(h,Z.targetId).next((Q)=>{Q.forEach((G)=>this.fi.add(G.toString()))}).next(()=>H.removeTargetData(h,Z))}Ei(){this.Vi=new Set}di(h){let Z=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.fi,(H)=>{let Q=m.fromPath(H);return this.gi(h,Q).next((G)=>{G||Z.removeEntry(Q,v.min())})}).next(()=>(this.Vi=null,Z.apply(h)))}updateLimboDocument(h,Z){return this.gi(h,Z).next((H)=>{H?this.fi.delete(Z.toString()):this.fi.add(Z.toString())})}Ti(h){return 0}gi(h,Z){return N.or([()=>N.resolve(this.Ri.containsKey(Z)),()=>this.persistence.getTargetCache().containsKey(h,Z),()=>this.persistence.Ai(h,Z)])}}class O6{constructor(h,Z){this.persistence=h,this.pi=new Vh((H)=>oG(H.path),(H,Q)=>H.isEqual(Q)),this.garbageCollector=p3(this,Z)}static mi(h,Z){return new O6(h,Z)}Ei(){}di(h){return N.resolve()}forEachTarget(h,Z){return this.persistence.getTargetCache().forEachTarget(h,Z)}gr(h){let Z=this.wr(h);return this.persistence.getTargetCache().getTargetCount(h).next((H)=>Z.next((Q)=>H+Q))}wr(h){let Z=0;return this.pr(h,(H)=>{Z++}).next(()=>Z)}pr(h,Z){return N.forEach(this.pi,(H,Q)=>this.br(h,H,Q).next((G)=>G?N.resolve():Z(Q)))}removeTargets(h,Z,H){return this.persistence.getTargetCache().removeTargets(h,Z,H)}removeOrphanedDocuments(h,Z){let H=0,Q=this.persistence.getRemoteDocumentCache(),G=Q.newChangeBuffer();return Q.ii(h,($)=>this.br(h,$,Z).next((M)=>{M||(H++,G.removeEntry($,v.min()))})).next(()=>G.apply(h)).next(()=>H)}markPotentiallyOrphaned(h,Z){return this.pi.set(Z,h.currentSequenceNumber),N.resolve()}removeTarget(h,Z){let H=Z.withSequenceNumber(h.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(h,H)}addReference(h,Z,H){return this.pi.set(H,h.currentSequenceNumber),N.resolve()}removeReference(h,Z,H){return this.pi.set(H,h.currentSequenceNumber),N.resolve()}updateLimboDocument(h,Z){return this.pi.set(Z,h.currentSequenceNumber),N.resolve()}Ti(h){let Z=h.key.toString().length;return h.isFoundDocument()&&(Z+=F6(h.data.value)),Z}br(h,Z,H){return N.or([()=>this.persistence.Ai(h,Z),()=>this.persistence.getTargetCache().containsKey(h,Z),()=>{let Q=this.pi.get(Z);return N.resolve(Q!==void 0&&Q>H)}])}getCacheSize(h){return this.persistence.getRemoteDocumentCache().getSize(h)}}class l9{constructor(h,Z,H,Q){this.targetId=h,this.fromCache=Z,this.Es=H,this.ds=Q}static As(h,Z){let H=i(),Q=i();for(let G of Z.docChanges)switch(G.type){case 0:H=H.add(G.doc.key);break;case 1:Q=Q.add(G.doc.key)}return new l9(h,Z.fromCache,H,Q)}}class uH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(h){this._documentReadCount+=h}}class lH{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return x4()?8:pG(j4())>0?6:4}()}initialize(h,Z){this.ps=h,this.indexManager=Z,this.Rs=!0}getDocumentsMatchingQuery(h,Z,H,Q){let G={result:null};return this.ys(h,Z).next(($)=>{G.result=$}).next(()=>{if(!G.result)return this.ws(h,Z,Q,H).next(($)=>{G.result=$})}).next(()=>{if(G.result)return;let $=new uH;return this.Ss(h,Z,$).next((M)=>{if(G.result=M,this.Vs)return this.bs(h,Z,$,M.size)})}).next(()=>G.result)}bs(h,Z,H,Q){return H.documentReadCount<this.fs?(_h()<=f.DEBUG&&A("QueryEngine","SDK will not create cache indexes for query:",Ah(Z),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),N.resolve()):(_h()<=f.DEBUG&&A("QueryEngine","Query:",Ah(Z),"scans",H.documentReadCount,"local documents and returns",Q,"documents as results."),H.documentReadCount>this.gs*Q?(_h()<=f.DEBUG&&A("QueryEngine","The SDK decides to create cache indexes for query:",Ah(Z),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(h,j0(Z))):N.resolve())}ys(h,Z){if(F5(Z))return N.resolve(null);let H=j0(Z);return this.indexManager.getIndexType(h,H).next((Q)=>Q===0?null:(Z.limit!==null&&Q===1&&(Z=S6(Z,null,"F"),H=j0(Z)),this.indexManager.getDocumentsMatchingTarget(h,H).next((G)=>{let $=i(...G);return this.ps.getDocuments(h,$).next((M)=>this.indexManager.getMinOffset(h,H).next((X)=>{let B=this.Ds(Z,M);return this.Cs(Z,B,$,X.readTime)?this.ys(h,S6(Z,null,"F")):this.vs(h,B,Z,X)}))})))}ws(h,Z,H,Q){return F5(Z)||Q.isEqual(v.min())?N.resolve(null):this.ps.getDocuments(h,H).next((G)=>{let $=this.Ds(Z,G);return this.Cs(Z,$,H,Q)?N.resolve(null):(_h()<=f.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",Q.toString(),Ah(Z)),this.vs(h,$,Z,iG(Q,A1)).next((M)=>M))})}Ds(h,Z){let H=new J0(n7(h));return Z.forEach((Q,G)=>{l6(h,G)&&(H=H.add(G))}),H}Cs(h,Z,H,Q){if(h.limit===null)return!1;if(H.size!==Z.size)return!0;let G=h.limitType==="F"?Z.last():Z.first();return!!G&&(G.hasPendingWrites||G.version.compareTo(Q)>0)}Ss(h,Z,H){return _h()<=f.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",Ah(Z)),this.ps.getDocumentsMatchingQuery(h,Z,Mh.min(),H)}vs(h,Z,H,Q){return this.ps.getDocumentsMatchingQuery(h,H,Q).next((G)=>(Z.forEach(($)=>{G=G.insert($.key,$)}),G))}}var s9="LocalStore",d3=300000000;class sH{constructor(h,Z,H,Q){this.persistence=h,this.Fs=Z,this.serializer=Q,this.Ms=new a(s),this.xs=new Vh((G)=>S9(G),C9),this.Os=new Map,this.Ns=h.getRemoteDocumentCache(),this.Pi=h.getTargetCache(),this.Ii=h.getBundleCache(),this.Bs(H)}Bs(h){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(h),this.indexManager=this.persistence.getIndexManager(h),this.mutationQueue=this.persistence.getMutationQueue(h,this.indexManager),this.localDocuments=new CH(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(h){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(Z)=>h.collect(Z,this.Ms))}}function o3(h,Z,H,Q){return new sH(h,Z,H,Q)}async function iH(h,Z){let H=u(h);return await H.persistence.runTransaction("Handle user change","readonly",(Q)=>{let G;return H.mutationQueue.getAllMutationBatches(Q).next(($)=>(G=$,H.Bs(Z),H.mutationQueue.getAllMutationBatches(Q))).next(($)=>{let M=[],X=[],B=i();for(let V of G){M.push(V.batchId);for(let D of V.mutations)B=B.add(D.key)}for(let V of $){X.push(V.batchId);for(let D of V.mutations)B=B.add(D.key)}return H.localDocuments.getDocuments(Q,B).next((V)=>({Ls:V,removedBatchIds:M,addedBatchIds:X}))})})}function n3(h,Z){let H=u(h);return H.persistence.runTransaction("Acknowledge batch","readwrite-primary",(Q)=>{let G=Z.batch.keys(),$=H.Ns.newChangeBuffer({trackRemovals:!0});return function(X,B,V,D){let F=V.batch,y=F.keys(),S=N.resolve();return y.forEach((j)=>{S=S.next(()=>D.getEntry(B,j)).next((_)=>{let x=V.docVersions.get(j);d(x!==null,48541),_.version.compareTo(x)<0&&(F.applyToRemoteDocument(_,V),_.isValidDocument()&&(_.setReadTime(V.commitVersion),D.addEntry(_)))})}),S.next(()=>X.mutationQueue.removeMutationBatch(B,F))}(H,Q,Z,$).next(()=>$.apply(Q)).next(()=>H.mutationQueue.performConsistencyCheck(Q)).next(()=>H.documentOverlayCache.removeOverlaysForBatchId(Q,G,Z.batch.batchId)).next(()=>H.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(Q,function(X){let B=i();for(let V=0;V<X.mutationResults.length;++V)X.mutationResults[V].transformResults.length>0&&(B=B.add(X.batch.mutations[V].key));return B}(Z))).next(()=>H.localDocuments.getDocuments(Q,G))})}function fH(h){let Z=u(h);return Z.persistence.runTransaction("Get last remote snapshot version","readonly",(H)=>Z.Pi.getLastRemoteSnapshotVersion(H))}function r3(h,Z){let H=u(h),Q=Z.snapshotVersion,G=H.Ms;return H.persistence.runTransaction("Apply remote event","readwrite-primary",($)=>{let M=H.Ns.newChangeBuffer({trackRemovals:!0});G=H.Ms;let X=[];Z.targetChanges.forEach((D,F)=>{let y=G.get(F);if(!y)return;X.push(H.Pi.removeMatchingKeys($,D.removedDocuments,F).next(()=>H.Pi.addMatchingKeys($,D.addedDocuments,F)));let S=y.withSequenceNumber($.currentSequenceNumber);Z.targetMismatches.get(F)!==null?S=S.withResumeToken(U0.EMPTY_BYTE_STRING,v.min()).withLastLimboFreeSnapshotVersion(v.min()):D.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(D.resumeToken,Q)),G=G.insert(F,S),function(_,x,p){if(_.resumeToken.approximateByteSize()===0)return!0;if(x.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=d3)return!0;return p.addedDocuments.size+p.modifiedDocuments.size+p.removedDocuments.size>0}(y,S,D)&&X.push(H.Pi.updateTargetData($,S))});let B=n0(),V=i();if(Z.documentUpdates.forEach((D)=>{Z.resolvedLimboDocuments.has(D)&&X.push(H.persistence.referenceDelegate.updateLimboDocument($,D))}),X.push(c3($,M,Z.documentUpdates).next((D)=>{B=D.ks,V=D.qs})),!Q.isEqual(v.min())){let D=H.Pi.getLastRemoteSnapshotVersion($).next((F)=>H.Pi.setTargetsMetadata($,$.currentSequenceNumber,Q));X.push(D)}return N.waitFor(X).next(()=>M.apply($)).next(()=>H.localDocuments.getLocalViewOfDocuments($,B,V)).next(()=>B)}).then(($)=>(H.Ms=G,$))}function c3(h,Z,H){let Q=i(),G=i();return H.forEach(($)=>Q=Q.add($)),Z.getEntries(h,Q).next(($)=>{let M=n0();return H.forEach((X,B)=>{let V=$.get(X);B.isFoundDocument()!==V.isFoundDocument()&&(G=G.add(X)),B.isNoDocument()&&B.version.isEqual(v.min())?(Z.removeEntry(X,B.readTime),M=M.insert(X,B)):!V.isValidDocument()||B.version.compareTo(V.version)>0||B.version.compareTo(V.version)===0&&V.hasPendingWrites?(Z.addEntry(B),M=M.insert(X,B)):A(s9,"Ignoring outdated watch update for ",X,". Current version:",V.version," Watch version:",B.version)}),{ks:M,qs:G}})}function b3(h,Z){let H=u(h);return H.persistence.runTransaction("Get next mutation batch","readonly",(Q)=>(Z===void 0&&(Z=q9),H.mutationQueue.getNextMutationBatchAfterBatchId(Q,Z)))}function e3(h,Z){let H=u(h);return H.persistence.runTransaction("Allocate target","readwrite",(Q)=>{let G;return H.Pi.getTargetData(Q,Z).next(($)=>$?(G=$,N.resolve(G)):H.Pi.allocateTargetId(Q).next((M)=>(G=new $h(Z,M,"TargetPurposeListen",Q.currentSequenceNumber),H.Pi.addTargetData(Q,G).next(()=>G))))}).then((Q)=>{let G=H.Ms.get(Q.targetId);return(G===null||Q.snapshotVersion.compareTo(G.snapshotVersion)>0)&&(H.Ms=H.Ms.insert(Q.targetId,Q),H.xs.set(Z,Q.targetId)),Q})}async function W9(h,Z,H){let Q=u(h),G=Q.Ms.get(Z),$=H?"readwrite":"readwrite-primary";try{H||await Q.persistence.runTransaction("Release target",$,(M)=>Q.persistence.referenceDelegate.removeTarget(M,G))}catch(M){if(!eh(M))throw M;A(s9,`Failed to update sequence numbers for target ${Z}: ${M}`)}Q.Ms=Q.Ms.remove(Z),Q.xs.delete(G.target)}function k5(h,Z,H){let Q=u(h),G=v.min(),$=i();return Q.persistence.runTransaction("Execute query","readwrite",(M)=>function(B,V,D){let F=u(B),y=F.xs.get(D);return y!==void 0?N.resolve(F.Ms.get(y)):F.Pi.getTargetData(V,D)}(Q,M,j0(Z)).next((X)=>{if(X)return G=X.lastLimboFreeSnapshotVersion,Q.Pi.getMatchingKeysForTargetId(M,X.targetId).next((B)=>{$=B})}).next(()=>Q.Fs.getDocumentsMatchingQuery(M,Z,H?G:v.min(),H?$:i())).next((X)=>(a3(Q,X3(Z),X),{documents:X,Qs:$})))}function a3(h,Z,H){let Q=h.Os.get(Z)||v.min();H.forEach((G,$)=>{$.readTime.compareTo(Q)>0&&(Q=$.readTime)}),h.Os.set(Z,Q)}class X9{constructor(){this.activeTargetIds=I3()}zs(h){this.activeTargetIds=this.activeTargetIds.add(h)}js(h){this.activeTargetIds=this.activeTargetIds.delete(h)}Gs(){let h={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(h)}}class gH{constructor(){this.Mo=new X9,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(h){}updateMutationState(h,Z,H){}addLocalQueryTarget(h,Z=!0){return Z&&this.Mo.zs(h),this.xo[h]||"not-current"}updateQueryState(h,Z,H){this.xo[h]=Z}removeLocalQueryTarget(h){this.Mo.js(h)}isLocalQueryTarget(h){return this.Mo.activeTargetIds.has(h)}clearQueryState(h){delete this.xo[h]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(h){return this.Mo.activeTargetIds.has(h)}start(){return this.Mo=new X9,Promise.resolve()}handleUserChange(h,Z,H){}setOnlineState(h){}shutdown(){}writeSequenceNumber(h){}notifyBundleLoaded(h){}}class tH{Oo(h){}shutdown(){}}var v5="ConnectivityMonitor";class B9{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(h){this.qo.push(h)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){A(v5,"Network connectivity changed: AVAILABLE");for(let h of this.qo)h(0)}ko(){A(v5,"Network connectivity changed: UNAVAILABLE");for(let h of this.qo)h(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}var T6=null;function U9(){return T6===null?T6=function(){return 268435456+Math.round(2147483648*Math.random())}():T6++,"0x"+T6.toString(16)}var d8="RestConnection",h$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pH{get $o(){return!1}constructor(h){this.databaseInfo=h,this.databaseId=h.databaseId;let Z=h.ssl?"https":"http",H=encodeURIComponent(this.databaseId.projectId),Q=encodeURIComponent(this.databaseId.database);this.Uo=Z+"://"+h.host,this.Ko=`projects/${H}/databases/${Q}`,this.Wo=this.databaseId.database===N6?`project_id=${H}`:`project_id=${H}&database_id=${Q}`}Go(h,Z,H,Q,G){let $=U9(),M=this.zo(h,Z.toUriEncodedString());A(d8,`Sending RPC '${h}' ${$}:`,M,H);let X={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(X,Q,G);let{host:B}=new URL(M),V=z6(B);return this.Jo(h,M,X,H,V).then((D)=>(A(d8,`Received RPC '${h}' ${$}: `,D),D),(D)=>{throw lh(d8,`RPC '${h}' ${$} failed with error: `,D,"url: ",M,"request:",H),D})}Ho(h,Z,H,Q,G,$){return this.Go(h,Z,H,Q,G)}jo(h,Z,H){h["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ch}(),h["Content-Type"]="text/plain",this.databaseInfo.appId&&(h["X-Firebase-GMPID"]=this.databaseInfo.appId),Z&&Z.headers.forEach((Q,G)=>h[G]=Q),H&&H.headers.forEach((Q,G)=>h[G]=Q)}zo(h,Z){let H=h$[h];return`${this.Uo}/v1/${Z}:${H}`}terminate(){}}class dH{constructor(h){this.Yo=h.Yo,this.Zo=h.Zo}Xo(h){this.e_=h}t_(h){this.n_=h}r_(h){this.i_=h}onMessage(h){this.s_=h}close(){this.Zo()}send(h){this.Yo(h)}o_(){this.e_()}__(){this.n_()}a_(h){this.i_(h)}u_(h){this.s_(h)}}var z0="WebChannelConnection";class oH extends pH{constructor(h){super(h),this.c_=[],this.forceLongPolling=h.forceLongPolling,this.autoDetectLongPolling=h.autoDetectLongPolling,this.useFetchStreams=h.useFetchStreams,this.longPollingOptions=h.longPollingOptions}Jo(h,Z,H,Q,G){let $=U9();return new Promise((M,X)=>{let B=new l8;B.setWithCredentials(!0),B.listenOnce(s8.COMPLETE,()=>{try{switch(B.getLastErrorCode()){case y1.NO_ERROR:let D=B.getResponseJson();A(z0,`XHR for RPC '${h}' ${$} received:`,JSON.stringify(D)),M(D);break;case y1.TIMEOUT:A(z0,`RPC '${h}' ${$} timed out`),X(new O(L.DEADLINE_EXCEEDED,"Request time out"));break;case y1.HTTP_ERROR:let F=B.getStatus();if(A(z0,`RPC '${h}' ${$} failed with status:`,F,"response text:",B.getResponseText()),F>0){let y=B.getResponseJson();Array.isArray(y)&&(y=y[0]);let S=y?.error;if(S&&S.status&&S.message){let j=function(x){let p=x.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(p)>=0?p:L.UNKNOWN}(S.status);X(new O(j,S.message))}else X(new O(L.UNKNOWN,"Server responded with status "+B.getStatus()))}else X(new O(L.UNAVAILABLE,"Connection failed."));break;default:k(9055,{l_:h,streamId:$,h_:B.getLastErrorCode(),P_:B.getLastError()})}}finally{A(z0,`RPC '${h}' ${$} completed.`)}});let V=JSON.stringify(Q);A(z0,`RPC '${h}' ${$} sending request:`,Q),B.send(Z,"POST",V,H,15)})}T_(h,Z,H){let Q=U9(),G=[this.Uo,"/","google.firestore.v1.Firestore","/",h,"/channel"],$=g8(),M=f8(),X={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:600000},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},B=this.longPollingOptions.timeoutSeconds;B!==void 0&&(X.longPollingTimeout=Math.round(1000*B)),this.useFetchStreams&&(X.useFetchStreams=!0),this.jo(X.initMessageHeaders,Z,H),X.encodeInitMessageHeaders=!0;let V=G.join("");A(z0,`Creating RPC '${h}' stream ${Q}: ${V}`,X);let D=$.createWebChannel(V,X);this.I_(D);let F=!1,y=!1,S=new dH({Yo:(_)=>{y?A(z0,`Not sending because RPC '${h}' stream ${Q} is closed:`,_):(F||(A(z0,`Opening RPC '${h}' stream ${Q} transport.`),D.open(),F=!0),A(z0,`RPC '${h}' stream ${Q} sending:`,_),D.send(_))},Zo:()=>D.close()}),j=(_,x,p)=>{_.listen(x,(t)=>{try{p(t)}catch(o){setTimeout(()=>{throw o},0)}})};return j(D,Oh.EventType.OPEN,()=>{y||(A(z0,`RPC '${h}' stream ${Q} transport opened.`),S.o_())}),j(D,Oh.EventType.CLOSE,()=>{y||(y=!0,A(z0,`RPC '${h}' stream ${Q} transport closed`),S.a_(),this.E_(D))}),j(D,Oh.EventType.ERROR,(_)=>{y||(y=!0,lh(z0,`RPC '${h}' stream ${Q} transport errored. Name:`,_.name,"Message:",_.message),S.a_(new O(L.UNAVAILABLE,"The operation could not be completed")))}),j(D,Oh.EventType.MESSAGE,(_)=>{if(!y){let x=_.data[0];d(!!x,16349);let p=x,t=p?.error||p[0]?.error;if(t){A(z0,`RPC '${h}' stream ${Q} received error:`,t);let o=t.status,D0=function(w){let Y=Z0[w];if(Y!==void 0)return XH(Y)}(o),T0=t.message;D0===void 0&&(D0=L.INTERNAL,T0="Unknown error status: "+o+" with message "+t.message),y=!0,S.a_(new O(D0,T0)),D.close()}else A(z0,`RPC '${h}' stream ${Q} received:`,x),S.u_(x)}}),j(M,i8.STAT_EVENT,(_)=>{_.stat===E6.PROXY?A(z0,`RPC '${h}' stream ${Q} detected buffering proxy`):_.stat===E6.NOPROXY&&A(z0,`RPC '${h}' stream ${Q} detected no buffering proxy`)}),setTimeout(()=>{S.__()},0),S}terminate(){this.c_.forEach((h)=>h.close()),this.c_=[]}I_(h){this.c_.push(h)}E_(h){this.c_=this.c_.filter((Z)=>Z===h)}}function o8(){return typeof document<"u"?document:null}function f6(h){return new UH(h,!0)}class i9{constructor(h,Z,H=1000,Q=1.5,G=60000){this.Mi=h,this.timerId=Z,this.d_=H,this.A_=Q,this.R_=G,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(h){this.cancel();let Z=Math.floor(this.V_+this.y_()),H=Math.max(0,Date.now()-this.f_),Q=Math.max(0,Z-H);Q>0&&A("ExponentialBackoff",`Backing off for ${Q} ms (base delay: ${this.V_} ms, delay with jitter: ${Z} ms, last attempt: ${H} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,Q,()=>(this.f_=Date.now(),h())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-0.5)*this.V_}}var u5="PersistentStream";class f9{constructor(h,Z,H,Q,G,$,M,X){this.Mi=h,this.S_=H,this.b_=Q,this.connection=G,this.authCredentialsProvider=$,this.appCheckCredentialsProvider=M,this.listener=X,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new i9(h,Z)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,60000,()=>this.k_()))}q_(h){this.Q_(),this.stream.send(h)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(h,Z){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,h!==4?this.M_.reset():Z&&Z.code===L.RESOURCE_EXHAUSTED?(p0(Z.toString()),p0("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):Z&&Z.code===L.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=h,await this.listener.r_(Z)}K_(){}auth(){this.state=1;let h=this.W_(this.D_),Z=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([H,Q])=>{this.D_===Z&&this.G_(H,Q)},(H)=>{h(()=>{let Q=new O(L.UNKNOWN,"Fetching auth token failed: "+H.message);return this.z_(Q)})})}G_(h,Z){let H=this.W_(this.D_);this.stream=this.j_(h,Z),this.stream.Xo(()=>{H(()=>this.listener.Xo())}),this.stream.t_(()=>{H(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_((Q)=>{H(()=>this.z_(Q))}),this.stream.onMessage((Q)=>{H(()=>++this.F_==1?this.J_(Q):this.onNext(Q))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(h){return A(u5,`close with error: ${h}`),this.stream=null,this.close(4,h)}W_(h){return(Z)=>{this.Mi.enqueueAndForget(()=>this.D_===h?Z():(A(u5,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nH extends f9{constructor(h,Z,H,Q,G,$){super(h,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",Z,H,Q,$),this.serializer=G}j_(h,Z){return this.connection.T_("Listen",h,Z)}J_(h){return this.onNext(h)}onNext(h){this.M_.reset();let Z=A3(this.serializer,h),H=function(G){if(!("targetChange"in G))return v.min();let $=G.targetChange;return $.targetIds&&$.targetIds.length?v.min():$.readTime?m0($.readTime):v.min()}(h);return this.listener.H_(Z,H)}Y_(h){let Z={};Z.database=J9(this.serializer),Z.addTarget=function(G,$){let M,X=$.target;if(M=Z9(X)?{documents:m3(G,X)}:{query:k3(G,X).ft},M.targetId=$.targetId,$.resumeToken.approximateByteSize()>0){M.resumeToken=VH(G,$.resumeToken);let B=K9(G,$.expectedCount);B!==null&&(M.expectedCount=B)}else if($.snapshotVersion.compareTo(v.min())>0){M.readTime=C6(G,$.snapshotVersion.toTimestamp());let B=K9(G,$.expectedCount);B!==null&&(M.expectedCount=B)}return M}(this.serializer,h);let H=u3(this.serializer,h);H&&(Z.labels=H),this.q_(Z)}Z_(h){let Z={};Z.database=J9(this.serializer),Z.removeTarget=h,this.q_(Z)}}class rH extends f9{constructor(h,Z,H,Q,G,$){super(h,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",Z,H,Q,$),this.serializer=G}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(h,Z){return this.connection.T_("Write",h,Z)}J_(h){return d(!!h.streamToken,31322),this.lastStreamToken=h.streamToken,d(!h.writeResults||h.writeResults.length===0,55816),this.listener.ta()}onNext(h){d(!!h.streamToken,12678),this.lastStreamToken=h.streamToken,this.M_.reset();let Z=x3(h.writeResults,h.commitTime),H=m0(h.commitTime);return this.listener.na(H,Z)}ra(){let h={};h.database=J9(this.serializer),this.q_(h)}ea(h){let Z={streamToken:this.lastStreamToken,writes:h.map((H)=>j3(this.serializer,H))};this.q_(Z)}}class cH{}class bH extends cH{constructor(h,Z,H,Q){super(),this.authCredentials=h,this.appCheckCredentials=Z,this.connection=H,this.serializer=Q,this.ia=!1}sa(){if(this.ia)throw new O(L.FAILED_PRECONDITION,"The client has already been terminated.")}Go(h,Z,H,Q){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([G,$])=>this.connection.Go(h,G9(Z,H),Q,G,$)).catch((G)=>{throw G.name==="FirebaseError"?(G.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),G):new O(L.UNKNOWN,G.toString())})}Ho(h,Z,H,Q,G){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([$,M])=>this.connection.Ho(h,G9(Z,H),Q,$,M,G)).catch(($)=>{throw $.name==="FirebaseError"?($.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),$):new O(L.UNKNOWN,$.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class eH{constructor(h,Z){this.asyncQueue=h,this.onlineStateHandler=Z,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(h){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${h.toString()}`),this.ca("Offline")))}set(h){this.Pa(),this.oa=0,h==="Online"&&(this.aa=!1),this.ca(h)}ca(h){h!==this.state&&(this.state=h,this.onlineStateHandler(h))}la(h){let Z=`Could not reach Cloud Firestore backend. ${h}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(p0(Z),this.aa=!1):A("OnlineStateTracker",Z)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}var Th="RemoteStore";class aH{constructor(h,Z,H,Q,G){this.localStore=h,this.datastore=Z,this.asyncQueue=H,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=G,this.Aa.Oo(($)=>{H.enqueueAndForget(async()=>{Rh(this)&&(A(Th,"Restarting streams for network reachability change."),await async function(X){let B=u(X);B.Ea.add(4),await d1(B),B.Ra.set("Unknown"),B.Ea.delete(4),await g6(B)}(this))})}),this.Ra=new eH(H,Q)}}async function g6(h){if(Rh(h))for(let Z of h.da)await Z(!0)}async function d1(h){for(let Z of h.da)await Z(!1)}function hQ(h,Z){let H=u(h);H.Ia.has(Z.targetId)||(H.Ia.set(Z.targetId,Z),d9(H)?p9(H):h1(H).O_()&&t9(H,Z))}function g9(h,Z){let H=u(h),Q=h1(H);H.Ia.delete(Z),Q.O_()&&ZQ(H,Z),H.Ia.size===0&&(Q.O_()?Q.L_():Rh(H)&&H.Ra.set("Unknown"))}function t9(h,Z){if(h.Va.Ue(Z.targetId),Z.resumeToken.approximateByteSize()>0||Z.snapshotVersion.compareTo(v.min())>0){let H=h.remoteSyncer.getRemoteKeysForTarget(Z.targetId).size;Z=Z.withExpectedCount(H)}h1(h).Y_(Z)}function ZQ(h,Z){h.Va.Ue(Z),h1(h).Z_(Z)}function p9(h){h.Va=new BH({getRemoteKeysForTarget:(Z)=>h.remoteSyncer.getRemoteKeysForTarget(Z),At:(Z)=>h.Ia.get(Z)||null,ht:()=>h.datastore.serializer.databaseId}),h1(h).start(),h.Ra.ua()}function d9(h){return Rh(h)&&!h1(h).x_()&&h.Ia.size>0}function Rh(h){return u(h).Ea.size===0}function HQ(h){h.Va=void 0}async function Z$(h){h.Ra.set("Online")}async function H$(h){h.Ia.forEach((Z,H)=>{t9(h,Z)})}async function Q$(h,Z){HQ(h),d9(h)?(h.Ra.ha(Z),p9(h)):h.Ra.set("Unknown")}async function K$(h,Z,H){if(h.Ra.set("Online"),Z instanceof m9&&Z.state===2&&Z.cause)try{await async function(G,$){let M=$.cause;for(let X of $.targetIds)G.Ia.has(X)&&(await G.remoteSyncer.rejectListen(X,M),G.Ia.delete(X),G.Va.removeTarget(X))}(h,Z)}catch(Q){A(Th,"Failed to remove targets %s: %s ",Z.targetIds.join(","),Q),await _6(h,Q)}else if(Z instanceof O1?h.Va.Ze(Z):Z instanceof x9?h.Va.st(Z):h.Va.tt(Z),!H.isEqual(v.min()))try{let Q=await fH(h.localStore);H.compareTo(Q)>=0&&await function($,M){let X=$.Va.Tt(M);return X.targetChanges.forEach((B,V)=>{if(B.resumeToken.approximateByteSize()>0){let D=$.Ia.get(V);D&&$.Ia.set(V,D.withResumeToken(B.resumeToken,M))}}),X.targetMismatches.forEach((B,V)=>{let D=$.Ia.get(B);if(!D)return;$.Ia.set(B,D.withResumeToken(U0.EMPTY_BYTE_STRING,D.snapshotVersion)),ZQ($,B);let F=new $h(D.target,B,V,D.sequenceNumber);t9($,F)}),$.remoteSyncer.applyRemoteEvent(X)}(h,H)}catch(Q){A(Th,"Failed to raise snapshot:",Q),await _6(h,Q)}}async function _6(h,Z,H){if(!eh(Z))throw Z;h.Ea.add(1),await d1(h),h.Ra.set("Offline"),H||(H=()=>fH(h.localStore)),h.asyncQueue.enqueueRetryable(async()=>{A(Th,"Retrying IndexedDB access"),await H(),h.Ea.delete(1),await g6(h)})}function QQ(h,Z){return Z().catch((H)=>_6(h,H,Z))}async function t6(h){let Z=u(h),H=Xh(Z),Q=Z.Ta.length>0?Z.Ta[Z.Ta.length-1].batchId:q9;for(;G$(Z);)try{let G=await b3(Z.localStore,Q);if(G===null){Z.Ta.length===0&&H.L_();break}Q=G.batchId,$$(Z,G)}catch(G){await _6(Z,G)}KQ(Z)&&GQ(Z)}function G$(h){return Rh(h)&&h.Ta.length<10}function $$(h,Z){h.Ta.push(Z);let H=Xh(h);H.O_()&&H.X_&&H.ea(Z.mutations)}function KQ(h){return Rh(h)&&!Xh(h).x_()&&h.Ta.length>0}function GQ(h){Xh(h).start()}async function J$(h){Xh(h).ra()}async function M$(h){let Z=Xh(h);for(let H of h.Ta)Z.ea(H.mutations)}async function W$(h,Z,H){let Q=h.Ta.shift(),G=A9.from(Q,Z,H);await QQ(h,()=>h.remoteSyncer.applySuccessfulWrite(G)),await t6(h)}async function X$(h,Z){Z&&Xh(h).X_&&await async function(Q,G){if(function(M){return T3(M)&&M!==L.ABORTED}(G.code)){let $=Q.Ta.shift();Xh(Q).B_(),await QQ(Q,()=>Q.remoteSyncer.rejectFailedWrite($.batchId,G)),await t6(Q)}}(h,Z),KQ(h)&&GQ(h)}async function l5(h,Z){let H=u(h);H.asyncQueue.verifyOperationInProgress(),A(Th,"RemoteStore received new credentials");let Q=Rh(H);H.Ea.add(3),await d1(H),Q&&H.Ra.set("Unknown"),await H.remoteSyncer.handleCredentialChange(Z),H.Ea.delete(3),await g6(H)}async function B$(h,Z){let H=u(h);Z?(H.Ea.delete(2),await g6(H)):Z||(H.Ea.add(2),await d1(H),H.Ra.set("Unknown"))}function h1(h){return h.ma||(h.ma=function(H,Q,G){let $=u(H);return $.sa(),new nH(Q,$.connection,$.authCredentials,$.appCheckCredentials,$.serializer,G)}(h.datastore,h.asyncQueue,{Xo:Z$.bind(null,h),t_:H$.bind(null,h),r_:Q$.bind(null,h),H_:K$.bind(null,h)}),h.da.push(async(Z)=>{Z?(h.ma.B_(),d9(h)?p9(h):h.Ra.set("Unknown")):(await h.ma.stop(),HQ(h))})),h.ma}function Xh(h){return h.fa||(h.fa=function(H,Q,G){let $=u(H);return $.sa(),new rH(Q,$.connection,$.authCredentials,$.appCheckCredentials,$.serializer,G)}(h.datastore,h.asyncQueue,{Xo:()=>Promise.resolve(),t_:J$.bind(null,h),r_:X$.bind(null,h),ta:M$.bind(null,h),na:W$.bind(null,h)}),h.da.push(async(Z)=>{Z?(h.fa.B_(),await t6(h)):(await h.fa.stop(),h.Ta.length>0&&(A(Th,`Stopping write stream with ${h.Ta.length} pending writes`),h.Ta=[]))})),h.fa}class o9{constructor(h,Z,H,Q,G){this.asyncQueue=h,this.timerId=Z,this.targetTimeMs=H,this.op=Q,this.removalCallback=G,this.deferred=new t0,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(($)=>{})}get promise(){return this.deferred.promise}static createAndSchedule(h,Z,H,Q,G){let $=Date.now()+H,M=new o9(h,Z,$,Q,G);return M.start(H),M}start(h){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),h)}skipDelay(){return this.handleDelayElapsed()}cancel(h){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new O(L.CANCELLED,"Operation cancelled"+(h?": "+h:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((h)=>this.deferred.resolve(h))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function n9(h,Z){if(p0("AsyncQueue",`${Z}: ${h}`),eh(h))return new O(L.UNAVAILABLE,`${Z}: ${h}`);throw h}class kh{static emptySet(h){return new kh(h.comparator)}constructor(h){this.comparator=h?(Z,H)=>h(Z,H)||m.comparator(Z.key,H.key):(Z,H)=>m.comparator(Z.key,H.key),this.keyedMap=F1(),this.sortedSet=new a(this.comparator)}has(h){return this.keyedMap.get(h)!=null}get(h){return this.keyedMap.get(h)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(h){let Z=this.keyedMap.get(h);return Z?this.sortedSet.indexOf(Z):-1}get size(){return this.sortedSet.size}forEach(h){this.sortedSet.inorderTraversal((Z,H)=>(h(Z),!1))}add(h){let Z=this.delete(h.key);return Z.copy(Z.keyedMap.insert(h.key,h),Z.sortedSet.insert(h,null))}delete(h){let Z=this.get(h);return Z?this.copy(this.keyedMap.remove(h),this.sortedSet.remove(Z)):this}isEqual(h){if(!(h instanceof kh))return!1;if(this.size!==h.size)return!1;let Z=this.sortedSet.getIterator(),H=h.sortedSet.getIterator();for(;Z.hasNext();){let Q=Z.getNext().key,G=H.getNext().key;if(!Q.isEqual(G))return!1}return!0}toString(){let h=[];return this.forEach((Z)=>{h.push(Z.toString())}),h.length===0?"DocumentSet ()":`DocumentSet (
  `+h.join(`  
`)+`
)`}copy(h,Z){let H=new kh;return H.comparator=this.comparator,H.keyedMap=h,H.sortedSet=Z,H}}class V9{constructor(){this.ga=new a(m.comparator)}track(h){let Z=h.doc.key,H=this.ga.get(Z);H?h.type!==0&&H.type===3?this.ga=this.ga.insert(Z,h):h.type===3&&H.type!==1?this.ga=this.ga.insert(Z,{type:H.type,doc:h.doc}):h.type===2&&H.type===2?this.ga=this.ga.insert(Z,{type:2,doc:h.doc}):h.type===2&&H.type===0?this.ga=this.ga.insert(Z,{type:0,doc:h.doc}):h.type===1&&H.type===0?this.ga=this.ga.remove(Z):h.type===1&&H.type===2?this.ga=this.ga.insert(Z,{type:1,doc:H.doc}):h.type===0&&H.type===1?this.ga=this.ga.insert(Z,{type:2,doc:h.doc}):k(63341,{Rt:h,pa:H}):this.ga=this.ga.insert(Z,h)}ya(){let h=[];return this.ga.inorderTraversal((Z,H)=>{h.push(H)}),h}}class rh{constructor(h,Z,H,Q,G,$,M,X,B){this.query=h,this.docs=Z,this.oldDocs=H,this.docChanges=Q,this.mutatedKeys=G,this.fromCache=$,this.syncStateChanged=M,this.excludesMetadataChanges=X,this.hasCachedResults=B}static fromInitialDocuments(h,Z,H,Q,G){let $=[];return Z.forEach((M)=>{$.push({type:0,doc:M})}),new rh(h,Z,kh.emptySet(Z),$,H,Q,!0,!1,G)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(h){if(!(this.fromCache===h.fromCache&&this.hasCachedResults===h.hasCachedResults&&this.syncStateChanged===h.syncStateChanged&&this.mutatedKeys.isEqual(h.mutatedKeys)&&u6(this.query,h.query)&&this.docs.isEqual(h.docs)&&this.oldDocs.isEqual(h.oldDocs)))return!1;let Z=this.docChanges,H=h.docChanges;if(Z.length!==H.length)return!1;for(let Q=0;Q<Z.length;Q++)if(Z[Q].type!==H[Q].type||!Z[Q].doc.isEqual(H[Q].doc))return!1;return!0}}class $Q{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((h)=>h.Da())}}class JQ{constructor(){this.queries=s5(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(Z,H){let Q=u(Z),G=Q.queries;Q.queries=s5(),G.forEach(($,M)=>{for(let X of M.Sa)X.onError(H)})})(this,new O(L.ABORTED,"Firestore shutting down"))}}function s5(){return new Vh((h)=>o7(h),u6)}async function U$(h,Z){let H=u(h),Q=3,G=Z.query,$=H.queries.get(G);$?!$.ba()&&Z.Da()&&(Q=2):($=new $Q,Q=Z.Da()?0:1);try{switch(Q){case 0:$.wa=await H.onListen(G,!0);break;case 1:$.wa=await H.onListen(G,!1);break;case 2:await H.onFirstRemoteStoreListen(G)}}catch(M){let X=n9(M,`Initialization of query '${Ah(Z.query)}' failed`);return void Z.onError(X)}if(H.queries.set(G,$),$.Sa.push(Z),Z.va(H.onlineState),$.wa)Z.Fa($.wa)&&r9(H)}async function V$(h,Z){let H=u(h),Q=Z.query,G=3,$=H.queries.get(Q);if($){let M=$.Sa.indexOf(Z);M>=0&&($.Sa.splice(M,1),$.Sa.length===0?G=Z.Da()?0:1:!$.ba()&&Z.Da()&&(G=2))}switch(G){case 0:return H.queries.delete(Q),H.onUnlisten(Q,!0);case 1:return H.queries.delete(Q),H.onUnlisten(Q,!1);case 2:return H.onLastRemoteStoreUnlisten(Q);default:return}}function Y$(h,Z){let H=u(h),Q=!1;for(let G of Z){let $=G.query,M=H.queries.get($);if(M){for(let X of M.Sa)X.Fa(G)&&(Q=!0);M.wa=G}}Q&&r9(H)}function z$(h,Z,H){let Q=u(h),G=Q.queries.get(Z);if(G)for(let $ of G.Sa)$.onError(H);Q.queries.delete(Z)}function r9(h){h.Ca.forEach((Z)=>{Z.next()})}var Y9,i5;(i5=Y9||(Y9={})).Ma="default",i5.Cache="cache";class MQ{constructor(h,Z,H){this.query=h,this.xa=Z,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=H||{}}Fa(h){if(!this.options.includeMetadataChanges){let H=[];for(let Q of h.docChanges)Q.type!==3&&H.push(Q);h=new rh(h.query,h.docs,h.oldDocs,H,h.mutatedKeys,h.fromCache,h.syncStateChanged,!0,h.hasCachedResults)}let Z=!1;return this.Oa?this.Ba(h)&&(this.xa.next(h),Z=!0):this.La(h,this.onlineState)&&(this.ka(h),Z=!0),this.Na=h,Z}onError(h){this.xa.error(h)}va(h){this.onlineState=h;let Z=!1;return this.Na&&!this.Oa&&this.La(this.Na,h)&&(this.ka(this.Na),Z=!0),Z}La(h,Z){if(!h.fromCache)return!0;if(!this.Da())return!0;let H=Z!=="Offline";return(!this.options.qa||!H)&&(!h.docs.isEmpty()||h.hasCachedResults||Z==="Offline")}Ba(h){if(h.docChanges.length>0)return!0;let Z=this.Na&&this.Na.hasPendingWrites!==h.hasPendingWrites;return!(!h.syncStateChanged&&!Z)&&this.options.includeMetadataChanges===!0}ka(h){h=rh.fromInitialDocuments(h.query,h.docs,h.mutatedKeys,h.fromCache,h.hasCachedResults),this.Oa=!0,this.xa.next(h)}Da(){return this.options.source!==Y9.Cache}}class c9{constructor(h){this.key=h}}class b9{constructor(h){this.key=h}}class WQ{constructor(h,Z){this.query=h,this.Ya=Z,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=i(),this.mutatedKeys=i(),this.eu=n7(h),this.tu=new kh(this.eu)}get nu(){return this.Ya}ru(h,Z){let H=Z?Z.iu:new V9,Q=Z?Z.tu:this.tu,G=Z?Z.mutatedKeys:this.mutatedKeys,$=Q,M=!1,X=this.query.limitType==="F"&&Q.size===this.query.limit?Q.last():null,B=this.query.limitType==="L"&&Q.size===this.query.limit?Q.first():null;if(h.inorderTraversal((V,D)=>{let F=Q.get(V),y=l6(this.query,D)?D:null,S=!!F&&this.mutatedKeys.has(F.key),j=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),_=!1;if(F&&y)F.data.isEqual(y.data)?S!==j&&(H.track({type:3,doc:y}),_=!0):this.su(F,y)||(H.track({type:2,doc:y}),_=!0,(X&&this.eu(y,X)>0||B&&this.eu(y,B)<0)&&(M=!0));else!F&&y?(H.track({type:0,doc:y}),_=!0):F&&!y&&(H.track({type:1,doc:F}),_=!0,(X||B)&&(M=!0));_&&(y?($=$.add(y),G=j?G.add(V):G.delete(V)):($=$.delete(V),G=G.delete(V)))}),this.query.limit!==null)for(;$.size>this.query.limit;){let V=this.query.limitType==="F"?$.last():$.first();$=$.delete(V.key),G=G.delete(V.key),H.track({type:1,doc:V})}return{tu:$,iu:H,Cs:M,mutatedKeys:G}}su(h,Z){return h.hasLocalMutations&&Z.hasCommittedMutations&&!Z.hasLocalMutations}applyChanges(h,Z,H,Q){let G=this.tu;this.tu=h.tu,this.mutatedKeys=h.mutatedKeys;let $=h.iu.ya();$.sort((V,D)=>function(y,S){let j=(_)=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return k(20277,{Rt:_})}};return j(y)-j(S)}(V.type,D.type)||this.eu(V.doc,D.doc)),this.ou(H),Q=Q??!1;let M=Z&&!Q?this._u():[],X=this.Xa.size===0&&this.current&&!Q?1:0,B=X!==this.Za;if(this.Za=X,$.length!==0||B)return{snapshot:new rh(this.query,h.tu,G,$,h.mutatedKeys,X===0,B,!1,!!H&&H.resumeToken.approximateByteSize()>0),au:M};return{au:M}}va(h){return this.current&&h==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new V9,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(h){return!this.Ya.has(h)&&(!!this.tu.has(h)&&!this.tu.get(h).hasLocalMutations)}ou(h){h&&(h.addedDocuments.forEach((Z)=>this.Ya=this.Ya.add(Z)),h.modifiedDocuments.forEach((Z)=>{}),h.removedDocuments.forEach((Z)=>this.Ya=this.Ya.delete(Z)),this.current=h.current)}_u(){if(!this.current)return[];let h=this.Xa;this.Xa=i(),this.tu.forEach((H)=>{this.uu(H.key)&&(this.Xa=this.Xa.add(H.key))});let Z=[];return h.forEach((H)=>{this.Xa.has(H)||Z.push(new b9(H))}),this.Xa.forEach((H)=>{h.has(H)||Z.push(new c9(H))}),Z}cu(h){this.Ya=h.Qs,this.Xa=i();let Z=this.ru(h.documents);return this.applyChanges(Z,!0)}lu(){return rh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}var e9="SyncEngine";class XQ{constructor(h,Z,H){this.query=h,this.targetId=Z,this.view=H}}class BQ{constructor(h){this.key=h,this.hu=!1}}class UQ{constructor(h,Z,H,Q,G,$){this.localStore=h,this.remoteStore=Z,this.eventManager=H,this.sharedClientState=Q,this.currentUser=G,this.maxConcurrentLimboResolutions=$,this.Pu={},this.Tu=new Vh((M)=>o7(M),u6),this.Iu=new Map,this.Eu=new Set,this.du=new a(m.comparator),this.Au=new Map,this.Ru=new i6,this.Vu={},this.mu=new Map,this.fu=nh.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function I$(h,Z,H=!0){let Q=PQ(h),G,$=Q.Tu.get(Z);return $?(Q.sharedClientState.addLocalQueryTarget($.targetId),G=$.view.lu()):G=await VQ(Q,Z,H,!0),G}async function D$(h,Z){let H=PQ(h);await VQ(H,Z,!0,!1)}async function VQ(h,Z,H,Q){let G=await e3(h.localStore,j0(Z)),$=G.targetId,M=h.sharedClientState.addLocalQueryTarget($,H),X;return Q&&(X=await P$(h,Z,$,M==="current",G.resumeToken)),h.isPrimaryClient&&H&&hQ(h.remoteStore,G),X}async function P$(h,Z,H,Q,G){h.pu=(F,y,S)=>async function(_,x,p,t){let o=x.view.ru(p);o.Cs&&(o=await k5(_.localStore,x.query,!1).then(({documents:w})=>x.view.ru(w,o)));let D0=t&&t.targetChanges.get(x.targetId),T0=t&&t.targetMismatches.get(x.targetId)!=null,V0=x.view.applyChanges(o,_.isPrimaryClient,D0,T0);return g5(_,x.targetId,V0.au),V0.snapshot}(h,F,y,S);let $=await k5(h.localStore,Z,!0),M=new WQ(Z,$.Qs),X=M.ru($.documents),B=p1.createSynthesizedTargetChangeForCurrentChange(H,Q&&h.onlineState!=="Offline",G),V=M.applyChanges(X,h.isPrimaryClient,B);g5(h,H,V.au);let D=new XQ(Z,H,M);return h.Tu.set(Z,D),h.Iu.has(H)?h.Iu.get(H).push(Z):h.Iu.set(H,[Z]),V.snapshot}async function w$(h,Z,H){let Q=u(h),G=Q.Tu.get(Z),$=Q.Iu.get(G.targetId);if($.length>1)return Q.Iu.set(G.targetId,$.filter((M)=>!u6(M,Z))),void Q.Tu.delete(Z);if(Q.isPrimaryClient)Q.sharedClientState.removeLocalQueryTarget(G.targetId),Q.sharedClientState.isActiveQueryTarget(G.targetId)||await W9(Q.localStore,G.targetId,!1).then(()=>{Q.sharedClientState.clearQueryState(G.targetId),H&&g9(Q.remoteStore,G.targetId),z9(Q,G.targetId)}).catch(bh);else z9(Q,G.targetId),await W9(Q.localStore,G.targetId,!0)}async function E$(h,Z){let H=u(h),Q=H.Tu.get(Z),G=H.Iu.get(Q.targetId);H.isPrimaryClient&&G.length===1&&(H.sharedClientState.removeLocalQueryTarget(Q.targetId),g9(H.remoteStore,Q.targetId))}async function q$(h,Z,H){let Q=S$(h);try{let G=await function(M,X){let B=u(M),V=b.now(),D=X.reduce((S,j)=>S.add(j.key),i()),F,y;return B.persistence.runTransaction("Locally write mutations","readwrite",(S)=>{let j=n0(),_=i();return B.Ns.getEntries(S,D).next((x)=>{j=x,j.forEach((p,t)=>{t.isValidDocument()||(_=_.add(p))})}).next(()=>B.localDocuments.getOverlayedDocuments(S,j)).next((x)=>{F=x;let p=[];for(let t of X){let o=y3(t,F.get(t.key).overlayedDocument);o!=null&&p.push(new r0(t.key,o,_7(o.value.mapValue),x0.exists(!0)))}return B.mutationQueue.addMutationBatch(S,V,p,X)}).next((x)=>{y=x;let p=x.applyToLocalDocumentSet(F,_);return B.documentOverlayCache.saveOverlays(S,x.batchId,p)})}).then(()=>({batchId:y.batchId,changes:c7(F)}))}(Q.localStore,Z);Q.sharedClientState.addPendingMutation(G.batchId),function(M,X,B){let V=M.Vu[M.currentUser.toKey()];V||(V=new a(s)),V=V.insert(X,B),M.Vu[M.currentUser.toKey()]=V}(Q,G.batchId,H),await o1(Q,G.changes),await t6(Q.remoteStore)}catch(G){let $=n9(G,"Failed to persist write");H.reject($)}}async function YQ(h,Z){let H=u(h);try{let Q=await r3(H.localStore,Z);Z.targetChanges.forEach((G,$)=>{let M=H.Au.get($);M&&(d(G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size<=1,22616),G.addedDocuments.size>0?M.hu=!0:G.modifiedDocuments.size>0?d(M.hu,14607):G.removedDocuments.size>0&&(d(M.hu,42227),M.hu=!1))}),await o1(H,Q,Z)}catch(Q){await bh(Q)}}function f5(h,Z,H){let Q=u(h);if(Q.isPrimaryClient&&H===0||!Q.isPrimaryClient&&H===1){let G=[];Q.Tu.forEach(($,M)=>{let X=M.view.va(Z);X.snapshot&&G.push(X.snapshot)}),function(M,X){let B=u(M);B.onlineState=X;let V=!1;B.queries.forEach((D,F)=>{for(let y of F.Sa)y.va(X)&&(V=!0)}),V&&r9(B)}(Q.eventManager,Z),G.length&&Q.Pu.H_(G),Q.onlineState=Z,Q.isPrimaryClient&&Q.sharedClientState.setOnlineState(Z)}}async function y$(h,Z,H){let Q=u(h);Q.sharedClientState.updateQueryState(Z,"rejected",H);let G=Q.Au.get(Z),$=G&&G.key;if($){let M=new a(m.comparator);M=M.insert($,I0.newNoDocument($,v.min()));let X=i().add($),B=new s6(v.min(),new Map,new a(s),M,X);await YQ(Q,B),Q.du=Q.du.remove($),Q.Au.delete(Z),a9(Q)}else await W9(Q.localStore,Z,!1).then(()=>z9(Q,Z,H)).catch(bh)}async function T$(h,Z){let H=u(h),Q=Z.batch.batchId;try{let G=await n3(H.localStore,Z);IQ(H,Q,null),zQ(H,Q),H.sharedClientState.updateMutationState(Q,"acknowledged"),await o1(H,G)}catch(G){await bh(G)}}async function F$(h,Z,H){let Q=u(h);try{let G=await function(M,X){let B=u(M);return B.persistence.runTransaction("Reject batch","readwrite-primary",(V)=>{let D;return B.mutationQueue.lookupMutationBatch(V,X).next((F)=>(d(F!==null,37113),D=F.keys(),B.mutationQueue.removeMutationBatch(V,F))).next(()=>B.mutationQueue.performConsistencyCheck(V)).next(()=>B.documentOverlayCache.removeOverlaysForBatchId(V,D,X)).next(()=>B.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(V,D)).next(()=>B.localDocuments.getDocuments(V,D))})}(Q.localStore,Z);IQ(Q,Z,H),zQ(Q,Z),Q.sharedClientState.updateMutationState(Z,"rejected",H),await o1(Q,G)}catch(G){await bh(G)}}function zQ(h,Z){(h.mu.get(Z)||[]).forEach((H)=>{H.resolve()}),h.mu.delete(Z)}function IQ(h,Z,H){let Q=u(h),G=Q.Vu[Q.currentUser.toKey()];if(G){let $=G.get(Z);$&&(H?$.reject(H):$.resolve(),G=G.remove(Z)),Q.Vu[Q.currentUser.toKey()]=G}}function z9(h,Z,H=null){h.sharedClientState.removeLocalQueryTarget(Z);for(let Q of h.Iu.get(Z))h.Tu.delete(Q),H&&h.Pu.yu(Q,H);if(h.Iu.delete(Z),h.isPrimaryClient)h.Ru.jr(Z).forEach((Q)=>{h.Ru.containsKey(Q)||DQ(h,Q)})}function DQ(h,Z){h.Eu.delete(Z.path.canonicalString());let H=h.du.get(Z);H!==null&&(g9(h.remoteStore,H),h.du=h.du.remove(Z),h.Au.delete(H),a9(h))}function g5(h,Z,H){for(let Q of H)if(Q instanceof c9)h.Ru.addReference(Q.key,Z),R$(h,Q);else if(Q instanceof b9)A(e9,"Document no longer in limbo: "+Q.key),h.Ru.removeReference(Q.key,Z),h.Ru.containsKey(Q.key)||DQ(h,Q.key);else k(19791,{wu:Q})}function R$(h,Z){let H=Z.key,Q=H.path.canonicalString();h.du.get(H)||h.Eu.has(Q)||(A(e9,"New document in limbo: "+H),h.Eu.add(Q),a9(h))}function a9(h){for(;h.Eu.size>0&&h.du.size<h.maxConcurrentLimboResolutions;){let Z=h.Eu.values().next().value;h.Eu.delete(Z);let H=new m(r.fromString(Z)),Q=h.fu.next();h.Au.set(Q,new BQ(H)),h.du=h.du.insert(H,Q),hQ(h.remoteStore,new $h(j0(p7(H.path)),Q,"TargetPurposeLimboResolution",f1.ce))}}async function o1(h,Z,H){let Q=u(h),G=[],$=[],M=[];Q.Tu.isEmpty()||(Q.Tu.forEach((X,B)=>{M.push(Q.pu(B,Z,H).then((V)=>{if((V||H)&&Q.isPrimaryClient){let D=V?!V.fromCache:H?.targetChanges.get(B.targetId)?.current;Q.sharedClientState.updateQueryState(B.targetId,D?"current":"not-current")}if(V){G.push(V);let D=l9.As(B.targetId,V);$.push(D)}}))}),await Promise.all(M),Q.Pu.H_(G),await async function(B,V){let D=u(B);try{await D.persistence.runTransaction("notifyLocalViewChanges","readwrite",(F)=>N.forEach(V,(y)=>N.forEach(y.Es,(S)=>D.persistence.referenceDelegate.addReference(F,y.targetId,S)).next(()=>N.forEach(y.ds,(S)=>D.persistence.referenceDelegate.removeReference(F,y.targetId,S)))))}catch(F){if(!eh(F))throw F;A(s9,"Failed to update sequence numbers: "+F)}for(let F of V){let y=F.targetId;if(!F.fromCache){let S=D.Ms.get(y),j=S.snapshotVersion,_=S.withLastLimboFreeSnapshotVersion(j);D.Ms=D.Ms.insert(y,_)}}}(Q.localStore,$))}async function L$(h,Z){let H=u(h);if(!H.currentUser.isEqual(Z)){A(e9,"User change. New user:",Z.toKey());let Q=await iH(H.localStore,Z);H.currentUser=Z,function($,M){$.mu.forEach((X)=>{X.forEach((B)=>{B.reject(new O(L.CANCELLED,M))})}),$.mu.clear()}(H,"'waitForPendingWrites' promise is rejected due to a user change."),H.sharedClientState.handleUserChange(Z,Q.removedBatchIds,Q.addedBatchIds),await o1(H,Q.Ls)}}function N$(h,Z){let H=u(h),Q=H.Au.get(Z);if(Q&&Q.hu)return i().add(Q.key);{let G=i(),$=H.Iu.get(Z);if(!$)return G;for(let M of $){let X=H.Tu.get(M);G=G.unionWith(X.view.nu)}return G}}function PQ(h){let Z=u(h);return Z.remoteStore.remoteSyncer.applyRemoteEvent=YQ.bind(null,Z),Z.remoteStore.remoteSyncer.getRemoteKeysForTarget=N$.bind(null,Z),Z.remoteStore.remoteSyncer.rejectListen=y$.bind(null,Z),Z.Pu.H_=Y$.bind(null,Z.eventManager),Z.Pu.yu=z$.bind(null,Z.eventManager),Z}function S$(h){let Z=u(h);return Z.remoteStore.remoteSyncer.applySuccessfulWrite=T$.bind(null,Z),Z.remoteStore.remoteSyncer.rejectFailedWrite=F$.bind(null,Z),Z}class s1{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(h){this.serializer=f6(h.databaseInfo.databaseId),this.sharedClientState=this.Du(h),this.persistence=this.Cu(h),await this.persistence.start(),this.localStore=this.vu(h),this.gcScheduler=this.Fu(h,this.localStore),this.indexBackfillerScheduler=this.Mu(h,this.localStore)}Fu(h,Z){return null}Mu(h,Z){return null}vu(h){return o3(this.persistence,new lH,h.initialUser,this.serializer)}Cu(h){return new v9(u9.mi,this.serializer)}Du(h){return new gH}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}s1.provider={build:()=>new s1};class wQ extends s1{constructor(h){super(),this.cacheSizeBytes=h}Fu(h,Z){d(this.persistence.referenceDelegate instanceof O6,46915);let H=this.persistence.referenceDelegate.garbageCollector;return new RH(H,h.asyncQueue,Z)}Cu(h){let Z=this.cacheSizeBytes!==void 0?q0.withCacheSize(this.cacheSizeBytes):q0.DEFAULT;return new v9((H)=>O6.mi(H,Z),this.serializer)}}class A6{async initialize(h,Z){this.localStore||(this.localStore=h.localStore,this.sharedClientState=h.sharedClientState,this.datastore=this.createDatastore(Z),this.remoteStore=this.createRemoteStore(Z),this.eventManager=this.createEventManager(Z),this.syncEngine=this.createSyncEngine(Z,!h.synchronizeTabs),this.sharedClientState.onlineStateHandler=(H)=>f5(this.syncEngine,H,1),this.remoteStore.remoteSyncer.handleCredentialChange=L$.bind(null,this.syncEngine),await B$(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(h){return function(){return new JQ}()}createDatastore(h){let Z=f6(h.databaseInfo.databaseId),H=function(G){return new oH(G)}(h.databaseInfo);return function(G,$,M,X){return new bH(G,$,M,X)}(h.authCredentials,h.appCheckCredentials,H,Z)}createRemoteStore(h){return function(H,Q,G,$,M){return new aH(H,Q,G,$,M)}(this.localStore,this.datastore,h.asyncQueue,(Z)=>f5(this.syncEngine,Z,0),function(){return B9.v()?new B9:new tH}())}createSyncEngine(h,Z){return function(Q,G,$,M,X,B,V){let D=new UQ(Q,G,$,M,X,B);return V&&(D.gu=!0),D}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,h.initialUser,h.maxConcurrentLimboResolutions,Z)}async terminate(){await async function(Z){let H=u(Z);A(Th,"RemoteStore shutting down."),H.Ea.add(5),await d1(H),H.Aa.shutdown(),H.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}A6.provider={build:()=>new A6};class EQ{constructor(h){this.observer=h,this.muted=!1}next(h){this.muted||this.observer.next&&this.Ou(this.observer.next,h)}error(h){this.muted||(this.observer.error?this.Ou(this.observer.error,h):p0("Uncaught Error in snapshot listener:",h.toString()))}Nu(){this.muted=!0}Ou(h,Z){setTimeout(()=>{this.muted||h(Z)},0)}}var Bh="FirestoreClient";class qQ{constructor(h,Z,H,Q,G){this.authCredentials=h,this.appCheckCredentials=Z,this.asyncQueue=H,this.databaseInfo=Q,this.user=W0.UNAUTHENTICATED,this.clientId=x6.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=G,this.authCredentials.start(H,async($)=>{A(Bh,"Received user=",$.uid),await this.authCredentialListener($),this.user=$}),this.appCheckCredentials.start(H,($)=>(A(Bh,"Received new app check token=",$),this.appCheckCredentialListener($,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(h){this.authCredentialListener=h}setAppCheckTokenChangeListener(h){this.appCheckCredentialListener=h}terminate(){this.asyncQueue.enterRestrictedMode();let h=new t0;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),h.resolve()}catch(Z){let H=n9(Z,"Failed to shutdown persistence");h.reject(H)}}),h.promise}}async function n8(h,Z){h.asyncQueue.verifyOperationInProgress(),A(Bh,"Initializing OfflineComponentProvider");let H=h.configuration;await Z.initialize(H);let Q=H.initialUser;h.setCredentialChangeListener(async(G)=>{Q.isEqual(G)||(await iH(Z.localStore,G),Q=G)}),Z.persistence.setDatabaseDeletedListener(()=>h.terminate()),h._offlineComponents=Z}async function t5(h,Z){h.asyncQueue.verifyOperationInProgress();let H=await C$(h);A(Bh,"Initializing OnlineComponentProvider"),await Z.initialize(H,h.configuration),h.setCredentialChangeListener((Q)=>l5(Z.remoteStore,Q)),h.setAppCheckTokenChangeListener((Q,G)=>l5(Z.remoteStore,G)),h._onlineComponents=Z}async function C$(h){if(!h._offlineComponents)if(h._uninitializedComponentsProvider){A(Bh,"Using user provided OfflineComponentProvider");try{await n8(h,h._uninitializedComponentsProvider._offline)}catch(Z){let H=Z;if(!function(G){return G.name==="FirebaseError"?G.code===L.FAILED_PRECONDITION||G.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&G instanceof DOMException)||G.code===22||G.code===20||G.code===11}(H))throw H;lh("Error using user provided cache. Falling back to memory cache: "+H),await n8(h,new s1)}}else A(Bh,"Using default OfflineComponentProvider"),await n8(h,new wQ(void 0));return h._offlineComponents}async function yQ(h){return h._onlineComponents||(h._uninitializedComponentsProvider?(A(Bh,"Using user provided OnlineComponentProvider"),await t5(h,h._uninitializedComponentsProvider._online)):(A(Bh,"Using default OnlineComponentProvider"),await t5(h,new A6))),h._onlineComponents}function O$(h){return yQ(h).then((Z)=>Z.syncEngine)}async function _$(h){let Z=await yQ(h),H=Z.eventManager;return H.onListen=I$.bind(null,Z.syncEngine),H.onUnlisten=w$.bind(null,Z.syncEngine),H.onFirstRemoteStoreListen=D$.bind(null,Z.syncEngine),H.onLastRemoteStoreUnlisten=E$.bind(null,Z.syncEngine),H}function A$(h,Z,H={}){let Q=new t0;return h.asyncQueue.enqueueAndForget(async()=>function($,M,X,B,V){let D=new EQ({next:(y)=>{D.Nu(),M.enqueueAndForget(()=>V$($,F)),y.fromCache&&B.source==="server"?V.reject(new O(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):V.resolve(y)},error:(y)=>V.reject(y)}),F=new MQ(X,D,{includeMetadataChanges:!0,qa:!0});return U$($,F)}(await _$(h),h.asyncQueue,Z,H,Q)),Q.promise}function TQ(h){let Z={};return h.timeoutSeconds!==void 0&&(Z.timeoutSeconds=h.timeoutSeconds),Z}var p5=new Map,FQ="firestore.googleapis.com",d5=!0;class I9{constructor(h){if(h.host===void 0){if(h.ssl!==void 0)throw new O(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=FQ,this.ssl=d5}else this.host=h.host,this.ssl=h.ssl??d5;if(this.isUsingEmulator=h.emulatorOptions!==void 0,this.credentials=h.credentials,this.ignoreUndefinedProperties=!!h.ignoreUndefinedProperties,this.localCache=h.localCache,h.cacheSizeBytes===void 0)this.cacheSizeBytes=TH;else{if(h.cacheSizeBytes!==-1&&h.cacheSizeBytes<t3)throw new O(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=h.cacheSizeBytes}lG("experimentalForceLongPolling",h.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",h.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!h.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:h.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!h.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=TQ(h.experimentalLongPollingOptions??{}),function(H){if(H.timeoutSeconds!==void 0){if(isNaN(H.timeoutSeconds))throw new O(L.INVALID_ARGUMENT,`invalid long polling timeout: ${H.timeoutSeconds} (must not be NaN)`);if(H.timeoutSeconds<5)throw new O(L.INVALID_ARGUMENT,`invalid long polling timeout: ${H.timeoutSeconds} (minimum allowed value is 5)`);if(H.timeoutSeconds>30)throw new O(L.INVALID_ARGUMENT,`invalid long polling timeout: ${H.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!h.useFetchStreams}isEqual(h){return this.host===h.host&&this.ssl===h.ssl&&this.credentials===h.credentials&&this.cacheSizeBytes===h.cacheSizeBytes&&this.experimentalForceLongPolling===h.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===h.experimentalAutoDetectLongPolling&&function(H,Q){return H.timeoutSeconds===Q.timeoutSeconds}(this.experimentalLongPollingOptions,h.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===h.ignoreUndefinedProperties&&this.useFetchStreams===h.useFetchStreams}}class n1{constructor(h,Z,H,Q){this._authCredentials=h,this._appCheckCredentials=Z,this._databaseId=H,this._app=Q,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new I9({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new O(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(h){if(this._settingsFrozen)throw new O(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new I9(h),this._emulatorOptions=h.emulatorOptions||{},h.credentials!==void 0&&(this._authCredentials=function(H){if(!H)return new e5;switch(H.type){case"firstParty":return new H7(H.sessionIndex||"0",H.iamToken||null,H.authTokenFactory||null);case"provider":return H.client;default:throw new O(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(h.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(Z){let H=p5.get(Z);H&&(A("ComponentProvider","Removing Datastore"),p5.delete(Z),H.terminate())}(this),Promise.resolve()}}function j$(h,Z,H,Q={}){h=ih(h,n1);let G=z6(Z),$=h._getSettings(),M={...$,emulatorOptions:h._getEmulatorOptions()},X=`${Z}:${H}`;G&&(O4(`https://${X}`),A4("Firestore",!0)),$.host!==FQ&&$.host!==X&&lh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let B={...$,host:X,ssl:G,emulatorOptions:Q};if(!Ch(B,M)&&(h._setSettings(B),Q.mockUserToken)){let V,D;if(typeof Q.mockUserToken=="string")V=Q.mockUserToken,D=W0.MOCK_USER;else{V=_4(Q.mockUserToken,h._app?.options.projectId);let F=Q.mockUserToken.sub||Q.mockUserToken.user_id;if(!F)throw new O(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");D=new W0(F)}h._authCredentials=new a5(new E9(V,D))}}class Yh{constructor(h,Z,H){this.converter=Z,this._query=H,this.type="query",this.firestore=h}withConverter(h){return new Yh(this.firestore,h,this._query)}}class $0{constructor(h,Z,H){this.converter=Z,this._key=H,this.type="document",this.firestore=h}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jh(this.firestore,this.converter,this._key.path.popLast())}withConverter(h){return new $0(this.firestore,h,this._key)}toJSON(){return{type:$0._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(h,Z,H){if(i1(Z,$0._jsonSchema))return new $0(h,H||null,new m(r.fromString(Z.referencePath)))}}$0._jsonSchemaVersion="firestore/documentReference/1.0",$0._jsonSchema={type:Q0("string",$0._jsonSchemaVersion),referencePath:Q0("string")};class Jh extends Yh{constructor(h,Z,H){super(h,Z,p7(H)),this._path=H,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let h=this._path.popLast();return h.isEmpty()?null:new $0(this.firestore,null,new m(h))}withConverter(h){return new Jh(this.firestore,h,this._path)}}function p6(h,Z,...H){if(h=O0(h),K7("collection","path",Z),h instanceof n1){let Q=r.fromString(Z,...H);return B5(Q),new Jh(h,null,Q)}{if(!(h instanceof $0||h instanceof Jh))throw new O(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let Q=h._path.child(r.fromString(Z,...H));return B5(Q),new Jh(h.firestore,null,Q)}}function d6(h,Z,...H){if(h=O0(h),arguments.length===1&&(Z=x6.newId()),K7("doc","path",Z),h instanceof n1){let Q=r.fromString(Z,...H);return X5(Q),new $0(h,null,new m(Q))}{if(!(h instanceof $0||h instanceof Jh))throw new O(L.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let Q=h._path.child(r.fromString(Z,...H));return X5(Q),new $0(h.firestore,h instanceof Jh?h.converter:null,new m(Q))}}var o5="AsyncQueue";class D9{constructor(h=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new i9(this,"async_queue_retry"),this._c=()=>{let H=o8();H&&A(o5,"Visibility state changed to "+H.visibilityState),this.M_.w_()},this.ac=h;let Z=o8();Z&&typeof Z.addEventListener=="function"&&Z.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(h){this.enqueue(h)}enqueueAndForgetEvenWhileRestricted(h){this.uc(),this.cc(h)}enterRestrictedMode(h){if(!this.ec){this.ec=!0,this.sc=h||!1;let Z=o8();Z&&typeof Z.removeEventListener=="function"&&Z.removeEventListener("visibilitychange",this._c)}}enqueue(h){if(this.uc(),this.ec)return new Promise(()=>{});let Z=new t0;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(h().then(Z.resolve,Z.reject),Z.promise)).then(()=>Z.promise)}enqueueRetryable(h){this.enqueueAndForget(()=>(this.Xu.push(h),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(h){if(!eh(h))throw h;A(o5,"Operation failed with retryable error: "+h)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(h){let Z=this.ac.then(()=>(this.rc=!0,h().catch((H)=>{throw this.nc=H,this.rc=!1,p0("INTERNAL UNHANDLED ERROR: ",n5(H)),H}).then((H)=>(this.rc=!1,H))));return this.ac=Z,Z}enqueueAfterDelay(h,Z,H){this.uc(),this.oc.indexOf(h)>-1&&(Z=0);let Q=o9.createAndSchedule(this,h,Z,H,(G)=>this.hc(G));return this.tc.push(Q),Q}uc(){this.nc&&k(47125,{Pc:n5(this.nc)})}verifyOperationInProgress(){}async Tc(){let h;do h=this.ac,await h;while(h!==this.ac)}Ic(h){for(let Z of this.tc)if(Z.timerId===h)return!0;return!1}Ec(h){return this.Tc().then(()=>{this.tc.sort((Z,H)=>Z.targetTimeMs-H.targetTimeMs);for(let Z of this.tc)if(Z.skipDelay(),h!=="all"&&Z.timerId===h)break;return this.Tc()})}dc(h){this.oc.push(h)}hc(h){let Z=this.tc.indexOf(h);this.tc.splice(Z,1)}}function n5(h){let Z=h.message||"";return h.stack&&(Z=h.stack.includes(h.message)?h.stack:h.message+`
`+h.stack),Z}class r1 extends n1{constructor(h,Z,H,Q){super(h,Z,H,Q),this.type="firestore",this._queue=new D9,this._persistenceKey=Q?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let h=this._firestoreClient.terminate();this._queue=new D9(h),this._firestoreClient=void 0,await h}}}function RQ(h,Z){let H=typeof h=="object"?h:h5(),Q=typeof h=="string"?h:Z||N6,G=c4(H,"firestore").getImmediate({identifier:Q});if(!G._initialized){let $=C4("firestore");$&&j$(G,...$)}return G}function LQ(h){if(h._terminated)throw new O(L.FAILED_PRECONDITION,"The client has already been terminated.");return h._firestoreClient||x$(h),h._firestoreClient}function x$(h){let Z=h._freezeSettings(),H=function(G,$,M,X){return new N7(G,$,M,X.host,X.ssl,X.experimentalForceLongPolling,X.experimentalAutoDetectLongPolling,TQ(X.experimentalLongPollingOptions),X.useFetchStreams,X.isUsingEmulator)}(h._databaseId,h._app?.options.appId||"",h._persistenceKey,Z);h._componentsProvider||Z.localCache?._offlineComponentProvider&&Z.localCache?._onlineComponentProvider&&(h._componentsProvider={_offline:Z.localCache._offlineComponentProvider,_online:Z.localCache._onlineComponentProvider}),h._firestoreClient=new qQ(h._authCredentials,h._appCheckCredentials,h._queue,H,h._componentsProvider&&function(G){let $=G?._online.build();return{_offline:G?._offline.build($),_online:$}}(h._componentsProvider))}class L0{constructor(h){this._byteString=h}static fromBase64String(h){try{return new L0(U0.fromBase64String(h))}catch(Z){throw new O(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+Z)}}static fromUint8Array(h){return new L0(U0.fromUint8Array(h))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(h){return this._byteString.isEqual(h._byteString)}toJSON(){return{type:L0._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(h){if(i1(h,L0._jsonSchema))return L0.fromBase64String(h.bytes)}}L0._jsonSchemaVersion="firestore/bytes/1.0",L0._jsonSchema={type:Q0("string",L0._jsonSchemaVersion),bytes:Q0("string")};class c1{constructor(...h){for(let Z=0;Z<h.length;++Z)if(h[Z].length===0)throw new O(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new B0(h)}isEqual(h){return this._internalPath.isEqual(h._internalPath)}}class o6{constructor(h){this._methodName=h}}class k0{constructor(h,Z){if(!isFinite(h)||h<-90||h>90)throw new O(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+h);if(!isFinite(Z)||Z<-180||Z>180)throw new O(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+Z);this._lat=h,this._long=Z}get latitude(){return this._lat}get longitude(){return this._long}isEqual(h){return this._lat===h._lat&&this._long===h._long}_compareTo(h){return s(this._lat,h._lat)||s(this._long,h._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:k0._jsonSchemaVersion}}static fromJSON(h){if(i1(h,k0._jsonSchema))return new k0(h.latitude,h.longitude)}}k0._jsonSchemaVersion="firestore/geoPoint/1.0",k0._jsonSchema={type:Q0("string",k0._jsonSchemaVersion),latitude:Q0("number"),longitude:Q0("number")};class v0{constructor(h){this._values=(h||[]).map((Z)=>Z)}toArray(){return this._values.map((h)=>h)}isEqual(h){return function(H,Q){if(H.length!==Q.length)return!1;for(let G=0;G<H.length;++G)if(H[G]!==Q[G])return!1;return!0}(this._values,h._values)}toJSON(){return{type:v0._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(h){if(i1(h,v0._jsonSchema)){if(Array.isArray(h.vectorValues)&&h.vectorValues.every((Z)=>typeof Z=="number"))return new v0(h.vectorValues);throw new O(L.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}v0._jsonSchemaVersion="firestore/vectorValue/1.0",v0._jsonSchema={type:Q0("string",v0._jsonSchemaVersion),vectorValues:Q0("object")};var m$=/^__.*__$/;class NQ{constructor(h,Z,H){this.data=h,this.fieldMask=Z,this.fieldTransforms=H}toMutation(h,Z){return this.fieldMask!==null?new r0(h,this.data,this.fieldMask,Z,this.fieldTransforms):new ah(h,this.data,Z,this.fieldTransforms)}}class hZ{constructor(h,Z,H){this.data=h,this.fieldMask=Z,this.fieldTransforms=H}toMutation(h,Z){return new r0(h,this.data,this.fieldMask,Z,this.fieldTransforms)}}function SQ(h){switch(h){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw k(40011,{Ac:h})}}class ZZ{constructor(h,Z,H,Q,G,$){this.settings=h,this.databaseId=Z,this.serializer=H,this.ignoreUndefinedProperties=Q,G===void 0&&this.Rc(),this.fieldTransforms=G||[],this.fieldMask=$||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(h){return new ZZ({...this.settings,...h},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(h){let Z=this.path?.child(h),H=this.Vc({path:Z,fc:!1});return H.gc(h),H}yc(h){let Z=this.path?.child(h),H=this.Vc({path:Z,fc:!1});return H.Rc(),H}wc(h){return this.Vc({path:void 0,fc:!0})}Sc(h){return j6(h,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(h){return this.fieldMask.find((Z)=>h.isPrefixOf(Z))!==void 0||this.fieldTransforms.find((Z)=>h.isPrefixOf(Z.field))!==void 0}Rc(){if(this.path)for(let h=0;h<this.path.length;h++)this.gc(this.path.get(h))}gc(h){if(h.length===0)throw this.Sc("Document fields must not be empty");if(SQ(this.Ac)&&m$.test(h))throw this.Sc('Document fields cannot begin and end with "__"')}}class CQ{constructor(h,Z,H){this.databaseId=h,this.ignoreUndefinedProperties=Z,this.serializer=H||f6(h)}Cc(h,Z,H,Q=!1){return new ZZ({Ac:h,methodName:Z,Dc:H,path:B0.emptyPath(),fc:!1,bc:Q},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function HZ(h){let Z=h._freezeSettings(),H=f6(h._databaseId);return new CQ(h._databaseId,!!Z.ignoreUndefinedProperties,H)}function k$(h,Z,H,Q,G,$={}){let M=h.Cc($.merge||$.mergeFields?2:0,Z,H,G);QZ("Data must be an object, but it was:",M,Q);let X=OQ(Q,M),B,V;if($.merge)B=new R0(M.fieldMask),V=M.fieldTransforms;else if($.mergeFields){let D=[];for(let F of $.mergeFields){let y=P9(Z,F,H);if(!M.contains(y))throw new O(L.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);AQ(D,y)||D.push(y)}B=new R0(D),V=M.fieldTransforms.filter((F)=>B.covers(F.field))}else B=null,V=M.fieldTransforms;return new NQ(new y0(X),B,V)}class n6 extends o6{_toFieldTransform(h){if(h.Ac!==2)throw h.Ac===1?h.Sc(`${this._methodName}() can only appear at the top level of your update data`):h.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return h.fieldMask.push(h.path),null}isEqual(h){return h instanceof n6}}function v$(h,Z,H,Q){let G=h.Cc(1,Z,H);QZ("Data must be an object, but it was:",G,Q);let $=[],M=y0.empty();Uh(Q,(B,V)=>{let D=KZ(Z,B,H);V=O0(V);let F=G.yc(D);if(V instanceof n6)$.push(D);else{let y=b1(V,F);y!=null&&($.push(D),M.set(D,y))}});let X=new R0($);return new hZ(M,X,G.fieldTransforms)}function u$(h,Z,H,Q,G,$){let M=h.Cc(1,Z,H),X=[P9(Z,Q,H)],B=[G];if($.length%2!=0)throw new O(L.INVALID_ARGUMENT,`Function ${Z}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<$.length;y+=2)X.push(P9(Z,$[y])),B.push($[y+1]);let V=[],D=y0.empty();for(let y=X.length-1;y>=0;--y)if(!AQ(V,X[y])){let S=X[y],j=B[y];j=O0(j);let _=M.yc(S);if(j instanceof n6)V.push(S);else{let x=b1(j,_);x!=null&&(V.push(S),D.set(S,x))}}let F=new R0(V);return new hZ(D,F,M.fieldTransforms)}function l$(h,Z,H,Q=!1){return b1(H,h.Cc(Q?4:3,Z))}function b1(h,Z){if(_Q(h=O0(h)))return QZ("Unsupported field value:",Z,h),OQ(h,Z);if(h instanceof o6)return function(Q,G){if(!SQ(G.Ac))throw G.Sc(`${Q._methodName}() can only be used with update() and set()`);if(!G.path)throw G.Sc(`${Q._methodName}() is not currently supported inside arrays`);let $=Q._toFieldTransform(G);$&&G.fieldTransforms.push($)}(h,Z),null;if(h===void 0&&Z.ignoreUndefinedProperties)return null;if(Z.path&&Z.fieldMask.push(Z.path),h instanceof Array){if(Z.settings.fc&&Z.Ac!==4)throw Z.Sc("Nested arrays are not supported");return function(Q,G){let $=[],M=0;for(let X of Q){let B=b1(X,G.wc(M));B==null&&(B={nullValue:"NULL_VALUE"}),$.push(B),M++}return{arrayValue:{values:$}}}(h,Z)}return function(Q,G){if((Q=O0(Q))===null)return{nullValue:"NULL_VALUE"};if(typeof Q=="number")return D3(G.serializer,Q);if(typeof Q=="boolean")return{booleanValue:Q};if(typeof Q=="string")return{stringValue:Q};if(Q instanceof Date){let $=b.fromDate(Q);return{timestampValue:C6(G.serializer,$)}}if(Q instanceof b){let $=new b(Q.seconds,1000*Math.floor(Q.nanoseconds/1000));return{timestampValue:C6(G.serializer,$)}}if(Q instanceof k0)return{geoPointValue:{latitude:Q.latitude,longitude:Q.longitude}};if(Q instanceof L0)return{bytesValue:VH(G.serializer,Q._byteString)};if(Q instanceof $0){let $=G.databaseId,M=Q.firestore._databaseId;if(!M.isEqual($))throw G.Sc(`Document reference is for database ${M.projectId}/${M.database} but should be for database ${$.projectId}/${$.database}`);return{referenceValue:k9(Q.firestore._databaseId||G.databaseId,Q._key.path)}}if(Q instanceof v0)return function(M,X){return{mapValue:{fields:{[F9]:{stringValue:R9},[fh]:{arrayValue:{values:M.toArray().map((V)=>{if(typeof V!="number")throw X.Sc("VectorValues must only contain numeric values.");return O9(X.serializer,V)})}}}}}}(Q,G);throw G.Sc(`Unsupported field value: ${m6(Q)}`)}(h,Z)}function OQ(h,Z){let H={};return y7(h)?Z.path&&Z.path.length>0&&Z.fieldMask.push(Z.path):Uh(h,(Q,G)=>{let $=b1(G,Z.mc(Q));$!=null&&(H[Q]=$)}),{mapValue:{fields:H}}}function _Q(h){return!(typeof h!="object"||h===null||h instanceof Array||h instanceof Date||h instanceof b||h instanceof k0||h instanceof L0||h instanceof $0||h instanceof o6||h instanceof v0)}function QZ(h,Z,H){if(!_Q(H)||!G7(H)){let Q=m6(H);throw Q==="an object"?Z.Sc(h+" a custom object"):Z.Sc(h+" "+Q)}}function P9(h,Z,H){if((Z=O0(Z))instanceof c1)return Z._internalPath;if(typeof Z=="string")return KZ(h,Z);throw j6("Field path arguments must be of type string or ",h,!1,void 0,H)}var s$=new RegExp("[~\\*/\\[\\]]");function KZ(h,Z,H){if(Z.search(s$)>=0)throw j6(`Invalid field path (${Z}). Paths must not contain '~', '*', '/', '[', or ']'`,h,!1,void 0,H);try{return new c1(...Z.split("."))._internalPath}catch(Q){throw j6(`Invalid field path (${Z}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,h,!1,void 0,H)}}function j6(h,Z,H,Q,G){let $=Q&&!Q.isEmpty(),M=G!==void 0,X=`Function ${Z}() called with invalid data`;H&&(X+=" (via `toFirestore()`)"),X+=". ";let B="";return($||M)&&(B+=" (found",$&&(B+=` in field ${Q}`),M&&(B+=` in document ${G}`),B+=")"),new O(L.INVALID_ARGUMENT,X+h+B)}function AQ(h,Z){return h.some((H)=>H.isEqual(Z))}class GZ{constructor(h,Z,H,Q,G){this._firestore=h,this._userDataWriter=Z,this._key=H,this._document=Q,this._converter=G}get id(){return this._key.path.lastSegment()}get ref(){return new $0(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let h=new jQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(h)}return this._userDataWriter.convertValue(this._document.data.value)}}get(h){if(this._document){let Z=this._document.data.field($Z("DocumentSnapshot.get",h));if(Z!==null)return this._userDataWriter.convertValue(Z)}}}class jQ extends GZ{data(){return super.data()}}function $Z(h,Z){return typeof Z=="string"?KZ(h,Z):Z instanceof c1?Z._internalPath:Z._delegate._internalPath}function i$(h){if(h.limitType==="L"&&h.explicitOrderBy.length===0)throw new O(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class r6{}class c6 extends r6{}function JZ(h,Z,...H){let Q=[];Z instanceof r6&&Q.push(Z),Q=Q.concat(H),function($){let M=$.filter((B)=>B instanceof WZ).length,X=$.filter((B)=>B instanceof MZ).length;if(M>1||M>0&&X>0)throw new O(L.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(Q);for(let G of Q)h=G._apply(h);return h}class MZ extends c6{constructor(h,Z,H){super(),this._field=h,this._op=Z,this._value=H,this.type="where"}static _create(h,Z,H){return new MZ(h,Z,H)}_apply(h){let Z=this._parse(h);return mQ(h._query,Z),new Yh(h.firestore,h.converter,H9(h._query,Z))}_parse(h){let Z=HZ(h.firestore);return function(G,$,M,X,B,V,D){let F;if(B.isKeyField()){if(V==="array-contains"||V==="array-contains-any")throw new O(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${V}' queries on documentId().`);if(V==="in"||V==="not-in"){c5(D,V);let S=[];for(let j of D)S.push(r5(X,G,j));F={arrayValue:{values:S}}}else F=r5(X,G,D)}else V!=="in"&&V!=="not-in"&&V!=="array-contains-any"||c5(D,V),F=l$(M,$,D,V==="in"||V==="not-in");return H0.create(B,V,F)}(h._query,"where",Z,h.firestore._databaseId,this._field,this._op,this._value)}}class WZ extends r6{constructor(h,Z){super(),this.type=h,this._queryConstraints=Z}static _create(h,Z){return new WZ(h,Z)}_parse(h){let Z=this._queryConstraints.map((H)=>H._parse(h)).filter((H)=>H.getFilters().length>0);return Z.length===1?Z[0]:N0.create(Z,this._getOperator())}_apply(h){let Z=this._parse(h);return Z.getFilters().length===0?h:(function(Q,G){let $=Q,M=G.getFlattenedFilters();for(let X of M)mQ($,X),$=H9($,X)}(h._query,Z),new Yh(h.firestore,h.converter,H9(h._query,Z)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class XZ extends c6{constructor(h,Z){super(),this._field=h,this._direction=Z,this.type="orderBy"}static _create(h,Z){return new XZ(h,Z)}_apply(h){let Z=function(Q,G,$){if(Q.startAt!==null)throw new O(L.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(Q.endAt!==null)throw new O(L.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ph(G,$)}(h._query,this._field,this._direction);return new Yh(h.firestore,h.converter,function(Q,G){let $=Q.explicitOrderBy.concat([G]);return new Fh(Q.path,Q.collectionGroup,$,Q.filters.slice(),Q.limit,Q.limitType,Q.startAt,Q.endAt)}(h._query,Z))}}function BZ(h,Z="asc"){let H=Z,Q=$Z("orderBy",h);return XZ._create(Q,H)}class UZ extends c6{constructor(h,Z,H){super(),this.type=h,this._limit=Z,this._limitType=H}static _create(h,Z,H){return new UZ(h,Z,H)}_apply(h){return new Yh(h.firestore,h.converter,S6(h._query,this._limit,this._limitType))}}function xQ(h){return sG("limit",h),UZ._create("limit",h,"F")}function r5(h,Z,H){if(typeof(H=O0(H))=="string"){if(H==="")throw new O(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!d7(Z)&&H.indexOf("/")!==-1)throw new O(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${H}' contains a '/' character.`);let Q=Z.path.child(r.fromString(H));if(!m.isDocumentKey(Q))throw new O(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${Q}' is not because it has an odd number of segments (${Q.length}).`);return P5(h,new m(Q))}if(H instanceof $0)return P5(h,H._key);throw new O(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${m6(H)}.`)}function c5(h,Z){if(!Array.isArray(h)||h.length===0)throw new O(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${Z.toString()}' filters.`)}function mQ(h,Z){let H=function(G,$){for(let M of G)for(let X of M.getFlattenedFilters())if($.indexOf(X.op)>=0)return X.op;return null}(h.filters,function(G){switch(G){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(Z.op));if(H!==null)throw H===Z.op?new O(L.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${Z.op.toString()}' filter.`):new O(L.INVALID_ARGUMENT,`Invalid query. You cannot use '${Z.op.toString()}' filters with '${H.toString()}' filters.`)}class kQ{convertValue(h,Z="none"){switch(Wh(h)){case 0:return null;case 1:return h.booleanValue;case 2:return e(h.integerValue||h.doubleValue);case 3:return this.convertTimestamp(h.timestampValue);case 4:return this.convertServerTimestamp(h,Z);case 5:return h.stringValue;case 6:return this.convertBytes(o0(h.bytesValue));case 7:return this.convertReference(h.referenceValue);case 8:return this.convertGeoPoint(h.geoPointValue);case 9:return this.convertArray(h.arrayValue,Z);case 11:return this.convertObject(h.mapValue,Z);case 10:return this.convertVectorValue(h.mapValue);default:throw k(62114,{value:h})}}convertObject(h,Z){return this.convertObjectMap(h.fields,Z)}convertObjectMap(h,Z="none"){let H={};return Uh(h,(Q,G)=>{H[Q]=this.convertValue(G,Z)}),H}convertVectorValue(h){let Z=h.fields?.[fh].arrayValue?.values?.map((H)=>e(H.doubleValue));return new v0(Z)}convertGeoPoint(h){return new k0(e(h.latitude),e(h.longitude))}convertArray(h,Z){return(h.values||[]).map((H)=>this.convertValue(H,Z))}convertServerTimestamp(h,Z){switch(Z){case"previous":let H=v6(h);return H==null?null:this.convertValue(H,Z);case"estimate":return this.convertTimestamp(x1(h));default:return null}}convertTimestamp(h){let Z=d0(h);return new b(Z.seconds,Z.nanos)}convertDocumentKey(h,Z){let H=r.fromString(h);d(wH(H),9688,{name:h});let Q=new m1(H.get(1),H.get(3)),G=new m(H.popFirst(5));return Q.isEqual(Z)||p0(`Document ${G} contains a document reference within a different database (${Q.projectId}/${Q.database}) which is not supported. It will be treated as a reference in the current database (${Z.projectId}/${Z.database}) instead.`),G}}function f$(h,Z,H){let Q;return Q=h?H&&(H.merge||H.mergeFields)?h.toFirestore(Z,H):h.toFirestore(Z):Z,Q}class R1{constructor(h,Z){this.hasPendingWrites=h,this.fromCache=Z}isEqual(h){return this.hasPendingWrites===h.hasPendingWrites&&this.fromCache===h.fromCache}}class vh extends GZ{constructor(h,Z,H,Q,G,$){super(h,Z,H,Q,$),this._firestore=h,this._firestoreImpl=h,this.metadata=G}exists(){return super.exists()}data(h={}){if(this._document){if(this._converter){let Z=new _1(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(Z,h)}return this._userDataWriter.convertValue(this._document.data.value,h.serverTimestamps)}}get(h,Z={}){if(this._document){let H=this._document.data.field($Z("DocumentSnapshot.get",h));if(H!==null)return this._userDataWriter.convertValue(H,Z.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new O(L.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let h=this._document,Z={};if(Z.type=vh._jsonSchemaVersion,Z.bundle="",Z.bundleSource="DocumentSnapshot",Z.bundleName=this._key.toString(),!h||!h.isValidDocument()||!h.isFoundDocument())return Z;return this._userDataWriter.convertObjectMap(h.data.value.mapValue.fields,"previous"),Z.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),Z}}vh._jsonSchemaVersion="firestore/documentSnapshot/1.0",vh._jsonSchema={type:Q0("string",vh._jsonSchemaVersion),bundleSource:Q0("string","DocumentSnapshot"),bundleName:Q0("string"),bundle:Q0("string")};class _1 extends vh{data(h={}){return super.data(h)}}class uh{constructor(h,Z,H,Q){this._firestore=h,this._userDataWriter=Z,this._snapshot=Q,this.metadata=new R1(Q.hasPendingWrites,Q.fromCache),this.query=H}get docs(){let h=[];return this.forEach((Z)=>h.push(Z)),h}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(h,Z){this._snapshot.docs.forEach((H)=>{h.call(Z,new _1(this._firestore,this._userDataWriter,H.key,H,new R1(this._snapshot.mutatedKeys.has(H.key),this._snapshot.fromCache),this.query.converter))})}docChanges(h={}){let Z=!!h.includeMetadataChanges;if(Z&&this._snapshot.excludesMetadataChanges)throw new O(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===Z||(this._cachedChanges=function(Q,G){if(Q._snapshot.oldDocs.isEmpty()){let $=0;return Q._snapshot.docChanges.map((M)=>{let X=new _1(Q._firestore,Q._userDataWriter,M.doc.key,M.doc,new R1(Q._snapshot.mutatedKeys.has(M.doc.key),Q._snapshot.fromCache),Q.query.converter);return M.doc,{type:"added",doc:X,oldIndex:-1,newIndex:$++}})}{let $=Q._snapshot.oldDocs;return Q._snapshot.docChanges.filter((M)=>G||M.type!==3).map((M)=>{let X=new _1(Q._firestore,Q._userDataWriter,M.doc.key,M.doc,new R1(Q._snapshot.mutatedKeys.has(M.doc.key),Q._snapshot.fromCache),Q.query.converter),B=-1,V=-1;return M.type!==0&&(B=$.indexOf(M.doc.key),$=$.delete(M.doc.key)),M.type!==1&&($=$.add(M.doc),V=$.indexOf(M.doc.key)),{type:g$(M.type),doc:X,oldIndex:B,newIndex:V}})}}(this,Z),this._cachedChangesIncludeMetadataChanges=Z),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new O(L.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let h={};h.type=uh._jsonSchemaVersion,h.bundleSource="QuerySnapshot",h.bundleName=x6.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let Z=[],H=[],Q=[];return this.docs.forEach((G)=>{G._document!==null&&(Z.push(G._document),H.push(this._userDataWriter.convertObjectMap(G._document.data.value.mapValue.fields,"previous")),Q.push(G.ref.path))}),h.bundle=(this._firestore,this.query._query,h.bundleName,"NOT SUPPORTED"),h}}function g$(h){switch(h){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return k(61501,{type:h})}}uh._jsonSchemaVersion="firestore/querySnapshot/1.0",uh._jsonSchema={type:Q0("string",uh._jsonSchemaVersion),bundleSource:Q0("string","QuerySnapshot"),bundleName:Q0("string"),bundle:Q0("string")};class vQ extends kQ{constructor(h){super(),this.firestore=h}convertBytes(h){return new L0(h)}convertReference(h){let Z=this.convertDocumentKey(h,this.firestore._databaseId);return new $0(this.firestore,null,Z)}}function VZ(h){h=ih(h,Yh);let Z=ih(h.firestore,r1),H=LQ(Z),Q=new vQ(Z);return i$(h._query),A$(H,h._query).then((G)=>new uh(Z,Q,h,G))}function YZ(h,Z,H,...Q){h=ih(h,$0);let G=ih(h.firestore,r1),$=HZ(G),M;return M=typeof(Z=O0(Z))=="string"||Z instanceof c1?u$($,"updateDoc",h._key,Z,H,Q):v$($,"updateDoc",h._key,Z),lQ(G,[M.toMutation(h._key,x0.exists(!0))])}function uQ(h,Z){let H=ih(h.firestore,r1),Q=d6(h),G=f$(h.converter,Z);return lQ(H,[k$(HZ(h.firestore),"addDoc",Q._key,G,h.converter!==null,{}).toMutation(Q._key,x0.exists(!1))]).then(()=>Q)}function lQ(h,Z){return function(Q,G){let $=new t0;return Q.asyncQueue.enqueueAndForget(async()=>q$(await O$(Q),G,$)),$.promise}(LQ(h),Z)}(function(Z,H=!0){(function(G){ch=G})(a4),E1(new Qh("firestore",(Q,{instanceIdentifier:G,options:$})=>{let M=Q.getProvider("app").getImmediate(),X=new r1(new h7(Q.getProvider("auth-internal")),new Q7(M,Q.getProvider("app-check-internal")),function(V,D){if(!Object.prototype.hasOwnProperty.apply(V.options,["projectId"]))throw new O(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new m1(V.options.projectId,D)}(M,G),M);return $={useFetchStreams:H,...$},X._setSettings($),X},"PUBLIC").setMultipleInstances(!0)),Gh(J5,M5,Z),Gh(J5,M5,"esm2020")})();var sQ={apiKey:"__FIREBASE_API_KEY__",authDomain:"__FIREBASE_AUTH_DOMAIN__",projectId:"__FIREBASE_PROJECT_ID__",storageBucket:"__FIREBASE_STORAGE_BUCKET__",messagingSenderId:"__FIREBASE_MESSAGING_SENDER_ID__",appId:"__FIREBASE_APP_ID__",measurementId:"__FIREBASE_MEASUREMENT_ID__"};var t$=v8(sQ),e1=RQ(t$);function p$(){let h=localStorage.getItem("deviceId");if(!h)h="device_"+crypto.randomUUID(),localStorage.setItem("deviceId",h);return h}var iQ=p$();async function zZ(h){let Z=document.getElementById("leaderboardList");if(!Z)return;Z.innerHTML="<p>Loading...</p>";try{let H=p6(e1,`leaderboard_${h}`),Q=JZ(H,BZ("time","asc"),xQ(10)),G=await VZ(Q);if(G.empty){Z.innerHTML="<p>No scores yet. Be the first!</p>";return}Z.innerHTML="";let $=1;G.forEach((M)=>{let X=M.data(),B=document.createElement("div");B.className="leaderboard-item",B.innerHTML=`
        <span class="rank">#${$}</span>
        <span class="name">${X.name}</span>
        <span class="time">${X.time}s</span>
      `,Z.appendChild(B),$++})}catch(H){console.error("Error fetching leaderboard:",H),Z.innerHTML="<p>Error loading scores.</p>"}}async function fQ(h,Z,H){let Q=`leaderboard_${h.difficulty}`;try{let G=p6(e1,Q),$=JZ(G,BZ("time","asc")),M=await VZ($),X=null,B=1/0;for(let V of M.docs)if(V.data().deviceId===iQ){X=V.id,B=V.data().time;break}if(X)if(h.time<B){let V=d6(e1,Q,X);await YZ(V,{name:Z,time:h.time,timestamp:Date.now()})}else{let V=d6(e1,Q,X);await YZ(V,{name:Z})}else await uQ(p6(e1,Q),{deviceId:iQ,name:Z,time:h.time,timestamp:Date.now()});H()}catch(G){console.error("Error submitting score:",G),alert("Failed to submit score. Please try again.")}}class IZ{levels=E4;gridEl;mineEl;hintEl;timerEl;diffSelect;customModal;customInputs;overlay;modal;modalTitle;modalText;bestEl;grid=[];R=9;C=9;M=10;flags=0;hints=y8;started=!1;gameOver=!1;time=0;timerInterval;startTime=0;currentDiff="easy";customConfig=null;isLeftDown=!1;isRightDown=!1;constructor(){this.gridEl=document.getElementById("grid"),this.gridEl.addEventListener("contextmenu",(h)=>h.preventDefault()),this.mineEl=document.getElementById("mineCount"),this.hintEl=document.getElementById("hintBtn"),this.timerEl=document.getElementById("timer"),this.diffSelect=document.getElementById("difficulty"),this.customModal=document.getElementById("customModalOverlay"),this.customInputs={r:document.getElementById("customR"),c:document.getElementById("customC"),m:document.getElementById("customM")},this.overlay=document.getElementById("overlay"),this.modal=this.overlay.querySelector(".modal"),this.modalTitle=document.getElementById("modalTitle"),this.modalText=document.getElementById("modalText"),this.bestEl=document.getElementById("best"),this.loadTheme(),this.updateBest(),this.restart(),this.setupGlobalEvents()}setupGlobalEvents(){document.addEventListener("mousedown",(h)=>{if(h.button===0)this.isLeftDown=!0;if(h.button===2)this.isRightDown=!0}),document.addEventListener("mouseup",()=>{this.isLeftDown=!1,this.isRightDown=!1}),document.addEventListener("keydown",(h)=>{if(h.target.tagName==="INPUT")return;switch(h.key.toLowerCase()){case"r":this.restart();break;case"h":this.useHint();break;case"t":this.handleTheme();break}})}loadTheme(){if(localStorage.getItem("theme")==="dark")document.body.classList.add("dark")}handleTheme(){document.body.classList.toggle("dark");let h=document.body.classList.contains("dark");localStorage.setItem("theme",h?"dark":"light")}restart(){this.stopTimer(),this.overlay.style.display="none",this.overlay.classList.remove("visible"),this.modal.classList.remove("win","lose"),this.started=!1,this.gameOver=!1,this.time=0,this.timerEl.innerText="00:00";let h=this.diffSelect.value;if(h==="custom"){if(!this.customConfig){this.customModal.classList.add("visible"),this.customModal.style.display="flex";return}this.R=this.customConfig.r,this.C=this.customConfig.c,this.M=this.customConfig.m}else{this.customConfig=null,this.currentDiff=h;let Z=this.levels[h];this.R=Z.r,this.C=Z.c,this.M=Z.m}this.flags=0,this.hints=y8,this.updateMineCount(),this.updateHintCount(),this.grid=[],this.gridEl.innerHTML="",this.gridEl.style.gridTemplateColumns=`repeat(${this.C}, auto)`;for(let Z=0;Z<this.R;Z++){this.grid[Z]=[];for(let H=0;H<this.C;H++){let Q=document.createElement("div");Q.className="cell";let G=new q8(Z,H,Q);Q.addEventListener("mousedown",(M)=>{if(M.button===0)this.handleClick(G);else if(M.button===2)M.preventDefault(),this.toggleFlag(G)}),Q.addEventListener("mouseenter",()=>{if(this.isLeftDown)this.handleClick(G);else if(this.isRightDown){if(!G.revealed&&!G.flagged)this.toggleFlag(G)}});let $;Q.addEventListener("touchstart",()=>{$=setTimeout(()=>this.toggleFlag(G),500)}),Q.addEventListener("touchend",()=>clearTimeout($)),Q.addEventListener("dblclick",()=>this.tryChord(G)),this.gridEl.appendChild(Q),this.grid[Z][H]=G}}this.updateBest()}updateMineCount(){this.mineEl.innerHTML=`\uD83D\uDCA3 ${this.M-this.flags}`}updateHintCount(){this.hintEl.innerText=`\uD83D\uDCA1 ${this.hints}`,this.hintEl.disabled=this.hints===0||this.gameOver}useHint(){if(this.gameOver||this.hints<=0||!this.started)return;let h=[];for(let Z=0;Z<this.R;Z++)for(let H=0;H<this.C;H++){let Q=this.grid[Z][H];if(!Q.mine&&!Q.revealed&&!Q.flagged)h.push(Q)}if(h.length>0){let Z=h[Math.floor(Math.random()*h.length)];this.reveal(Z),Z.el.style.transition="background-color 0.5s",Z.el.style.backgroundColor="#fbbf24",setTimeout(()=>{Z.el.style.backgroundColor=""},500),this.hints--,this.updateHintCount()}}applyCustom(){let h=parseInt(this.customInputs.r.value),Z=parseInt(this.customInputs.c.value),H=parseInt(this.customInputs.m.value);if(h<5||Z<5||H<1)return;if(H>=h*Z){alert("Too many mines!");return}this.customConfig={r:h,c:Z,m:H},this.customModal.style.display="none",this.customModal.classList.remove("visible"),this.restart()}cancelCustom(){this.customModal.style.display="none",this.customModal.classList.remove("visible"),this.diffSelect.value=this.currentDiff,this.restart()}startTimer(){this.startTime=Date.now(),this.timerInterval=setInterval(()=>{let h=Math.floor((Date.now()-this.startTime)/1000);this.time=h;let Z=Math.floor(h/60).toString().padStart(2,"0"),H=(h%60).toString().padStart(2,"0");this.timerEl.innerText=`${Z}:${H}`},1000)}stopTimer(){if(this.timerInterval)clearInterval(this.timerInterval)}placeMines(h){let Z=0;while(Z<this.M){let H=Math.floor(Math.random()*this.R),Q=Math.floor(Math.random()*this.C),G=this.grid[H][Q],$=Math.abs(H-h.r),M=Math.abs(Q-h.c),X=$<=1&&M<=1;if(!G.mine&&!X)G.mine=!0,Z++}}handleClick(h){if(this.gameOver||h.flagged)return;if(h.revealed){this.tryChord(h);return}if(!this.started)this.started=!0,this.placeMines(h),this.startTimer();this.reveal(h)}toggleFlag(h){if(this.gameOver||h.revealed||!this.started)return;h.flagged=!h.flagged,h.el.classList.toggle("flagged"),h.el.textContent=h.flagged?"\uD83D\uDEA9":"",this.flags+=h.flagged?1:-1,this.updateMineCount()}reveal(h){if(h.revealed||h.flagged)return;if(h.revealed=!0,h.el.classList.add("revealed"),h.mine){this.endGame(!1,h);return}let Z=this.countMines(h);if(Z>0)h.el.textContent=Z.toString(),h.el.classList.add(`n${Z}`);else this.getNeighbors(h).forEach((H)=>this.reveal(H));this.checkWin()}tryChord(h){if(!h.revealed)return;let Z=this.countMines(h),H=this.getNeighbors(h),Q=H.filter((G)=>G.flagged).length;if(Z===Q)H.forEach((G)=>{if(!G.flagged&&!G.revealed)this.reveal(G)})}countMines(h){return this.getNeighbors(h).filter((Z)=>Z.mine).length}getNeighbors(h){let Z=[];for(let H=-1;H<=1;H++)for(let Q=-1;Q<=1;Q++){if(H===0&&Q===0)continue;let G=h.r+H,$=h.c+Q;if(G>=0&&G<this.R&&$>=0&&$<this.C)Z.push(this.grid[G][$])}return Z}checkWin(){if(this.gameOver)return;let h=this.R*this.C;if(this.grid.flat().filter((H)=>H.revealed).length===h-this.M)this.endGame(!0)}endGame(h,Z){if(this.gameOver=!0,this.stopTimer(),this.grid.flat().forEach((H)=>{if(H.mine)if(h)H.el.textContent="\uD83D\uDEA9",H.el.classList.add("flagged");else{if(!H.revealed)H.el.textContent="\uD83D\uDCA3",H.el.classList.add("mine");if(H===Z)H.el.classList.add("mine-trigger")}else if(H.flagged)H.el.classList.add("wrong-flag")}),h){let H=this.diffSelect.value,Q=localStorage.getItem("best-"+H);if(!Q||this.time<parseInt(Q))localStorage.setItem("best-"+H,this.time.toString());if(["easy","medium","hard"].includes(H))this.showNameModal();else this.showModal(!0)}else this.showModal(!1);this.updateBest()}showModal(h){this.modalTitle.textContent=h?"You Won! \uD83C\uDF89":"Game Over \uD83D\uDCA5",this.modalText.textContent=h?`Completed in ${this.timerEl.innerText}`:"Better luck next time!",this.modal.className=`modal ${h?"win":"lose"}`,this.overlay.style.display="flex",this.overlay.offsetHeight,this.overlay.classList.add("visible")}showNameModal(){let h=document.getElementById("nameModalOverlay");h.style.display="flex",h.classList.add("visible");let Z=document.getElementById("playerName");Z.value=localStorage.getItem("playerName")||"",Z.focus()}submitScoreHandler(){let Z=document.getElementById("playerName").value.trim()||"Anonymous";localStorage.setItem("playerName",Z);let H={time:this.time,difficulty:this.diffSelect.value};fQ(H,Z,()=>{this.closeNameModal(),this.restart(),this.showLeaderboardHandler()})}closeNameModal(){let h=document.getElementById("nameModalOverlay");h.style.display="none",h.classList.remove("visible")}showLeaderboardHandler(){let h=document.getElementById("leaderboardOverlay");h.style.display="flex",h.classList.add("visible"),zZ("easy"),document.querySelectorAll(".tab-btn").forEach((Z)=>{Z.onclick=()=>{document.querySelectorAll(".tab-btn").forEach((H)=>H.classList.remove("active")),Z.classList.add("active"),zZ(Z.dataset.diff||"easy")}})}closeLeaderboard(){let h=document.getElementById("leaderboardOverlay");h.style.display="none",h.classList.remove("visible")}updateBest(){let h=this.diffSelect.value,Z=localStorage.getItem("best-"+h);this.bestEl.textContent=Z?`\uD83C\uDFC6 Best: ${Z}s`:""}}var l0=new IZ;window.restartGame=()=>l0.restart();window.toggleTheme=()=>l0.handleTheme();window.useHint=()=>l0.useHint();window.applyCustom=()=>l0.applyCustom();window.cancelCustom=()=>l0.cancelCustom();window.showLeaderboard=()=>l0.showLeaderboardHandler();window.closeLeaderboard=()=>l0.closeLeaderboard();window.submitScore=()=>l0.submitScoreHandler();window.closeNameModal=()=>l0.closeNameModal();document.getElementById("difficulty")?.addEventListener("change",()=>l0.restart());
